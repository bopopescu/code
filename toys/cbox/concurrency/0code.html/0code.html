<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;
      charset=windows-1252">
    <title>An Introduction to Parallel Programming by Robert P. Cook</title>
    <meta content="Robert P. Cook" name="author">
    <meta name="cover"
      content="/Users/robertcook/desktop/BOOKS/cover.jpg">
  </head>
  <body style="color: rgb(0, 0, 0);" vlink="#551a8b" link="#0000ee"
    alink="#ee0000">
    <mbp:section> </mbp:section>
    <center>
      <h1>An Introduction to Parallel Programming<br>
        with OpenMP, PThreads and MPI </h1>
    </center>
    <h1 style="text-align: center;">v 2.0 © Robert P. Cook January 01,
      2017<br>
    </h1>
    <br>
    <div align="left"><b>Disclaimer of Liability</b>: The author makes
      no warranty, express or implied, including the warranties of
      merchantability and fitness for a particular purpose, or assumes
      any legal liability or responsibility for the accuracy,
      completeness, or usefulness of any information, apparatus,
      product, or process disclosed, or represents that its use would
      not infringe privately owned rights.<br>
    </div>
    <hr width="100%" size="2">
    <div id="toc"><mbp:section></mbp:section>
      <h1 align="center">QUICK LINKS</h1>
      <h2 style="text-align: left;"><a href="#c1">1. INTRODUCTION</a></h2>
      <div style="text-align: left;"></div>
      <h2 style="text-align: left;"><a href="#c2">2. PIPELINE AND VECTOR
          PROGRAMMING</a> </h2>
      <div style="text-align: left;"></div>
      <h2 style="text-align: left;"></h2>
      <div style="text-align: left;"></div>
      <h2 style="text-align: left;"><b><a href="#c3">3. PROGRAMMING WITH
            PROCESSES</a> </b></h2>
      <div style="text-align: left;"></div>
      <h2 style="text-align: left;"><a href="#c4"><b><b><b><b>4.
                  OPENMP&nbsp; PROGRAMMING<br>
                </b></b></b></b></a></h2>
      <div style="text-align: left;"></div>
      <h2 style="text-align: left;"><a href="#c5"><b><b><b><b>5.
                  CONCURRENT PROGRAMMING<br>
                </b></b></b></b></a></h2>
      <div style="text-align: left;"></div>
      <h2 style="text-align: left;"><a href="#c6">6. PARALLEL ALGORITHMS<br>
        </a></h2>
      <div style="text-align: left;"></div>
      <h2 style="text-align: left;"><a href="#c7"><b><b><b><b><b><b>7.
                      MULTI-COMPUTER MPI PROGRAMMING</b></b></b></b></b></b></a></h2>
      <h2><a href="#c8">8. DISTRIBUTED PROGRAMMING</a></h2>
      <h2><a href="#c9">9. CLOUD COMPUTING</a><br>
      </h2>
      <div style="text-align: left;"></div>
      <hr width="100%" size="2"><mbp:section></mbp:section>
      <div align="center">
        <h1><b>TABLE OF CONTENTS</b></h1>
      </div>
      <h1 style="text-align: left;"><a name="c1"></a><a href="#r1">CHAPTER



























          ONE</a></h1>
      <div style="text-align: left;"></div>
      <h1 style="text-align: left;">INTRODUCTION</h1>
      <div style="text-align: left;"></div>
      <div style="text-align: left;"></div>
      <h1 style="text-align: left;"><a name="c2"></a><a href="#r21">CHAPTER



























          TWO</a></h1>
      <div style="text-align: left;"></div>
      <h1 style="text-align: left;">PIPELINE AND VECTOR PROGRAMMING</h1>
      <p>
        <meta charset="utf-8">
      </p>
      <div style="text-align: left;"></div>
      <h1 style="text-align: left;"><a name="c3"></a><a href="#r31">CHAPTER



























          THREE</a></h1>
      <div style="text-align: left;"></div>
      <h1 style="text-align: left;">PROGRAMMING WITH PROCESSES</h1>
      <h1 style="text-align: left;"><a name="c4"></a><a href="#r41">CHAPTER



















          FOUR</a></h1>
      <h1 style="text-align: left;">OPENMP PROGRAMMING</h1>
      <div style="text-align: left;"></div>
      <div style="text-align: left;"></div>
      <div style="text-align: left;"></div>
      <div style="text-align: left;"></div>
      <h1 style="text-align: left;"><a name="c5"></a><a href="#r51">CHAPTER



























          FIVE</a></h1>
      <div style="text-align: left;"></div>
      <h1 style="text-align: left;">CONCURRENT PROGRAMMING </h1>
      <div style="text-align: left;"></div>
      <h1 style="text-align: left;"><a name="c6"></a><a href="#r61">CHAPTER



























          SIX</a></h1>
      <div style="text-align: left;"></div>
      <h1 style="text-align: left;">PARALLEL ALGORITHMS</h1>
      <p>
        <meta charset="utf-8">
      </p>
      <h1 style="text-align: left;"><a name="c7"></a><a href="#r71">CHAPTER
















          SEVEN</a></h1>
      <h1 style="text-align: left;">MULTI-COMPUTER MPI PROGRAMMING</h1>
      <div style="text-align: left;"></div>
      <h2 style="text-align: left;">
        <meta charset="utf-8">
      </h2>
      <h1 style="text-align: left;"><a name="c8"></a><a href="#r81">CHAPTER















          EIGHT</a></h1>
      <h1>DISTRIBUTED PROGRAMMING<br>
      </h1>
      <div style="text-align: left;"></div>
      <div style="text-align: left;"></div>
      <div style="text-align: left;"></div>
      <h1 style="text-align: left;"><a name="c9"></a><a href="#r91">CHAPTER















          NINE</a></h1>
      <div style="text-align: left;"></div>
      <h1 style="text-align: left;">CLOUD COMPUTING</h1>
      <div style="text-align: left;"></div>
      <div style="text-align: left;"></div>
      <hr> <mbp:section></mbp:section>
      <h1 align="center"><a name="r1"></a>CHAPTER ONE<br>
        INTRODUCTION </h1>
    </div>
    <p align="center"> </p>
    <div align="left">
      <hr width="100%" size="2">
      <center>
        <h1><a name="r21"></a>CHAPTER TWO<br>
          PIPELINE AND VECTOR PROGRAMMING </h1>
      </center>
      <h2 style="color: rgb(0, 0, 0); font-family: Times; font-style:
        normal; font-variant-ligatures: normal; font-variant-caps:
        normal; letter-spacing: normal; orphans: 2; text-align:
        -webkit-left; text-indent: 0px; text-transform: none;
        white-space: normal; widows: 2; word-spacing: 0px;
        -webkit-text-stroke-width: 0px;">Processor Code Improvement<br>
      </h2>
      <div style="color: rgb(0, 0, 0); font-family: Times; font-size:
        medium; font-style: normal; font-variant-ligatures: normal;
        font-variant-caps: normal; font-weight: normal; letter-spacing:
        normal; orphans: 2; text-indent: 0px; text-transform: none;
        white-space: normal; widows: 2; word-spacing: 0px;
        -webkit-text-stroke-width: 0px; text-align: left;"> #include
        &lt;stdio.h&gt;<br>
        #include &lt;stdlib.h&gt;<br>
        #include &lt;time.h&gt;<br>
        #define N 20000000<br>
        int array_int_max(int a[], int n) {<br>
        &nbsp;&nbsp;&nbsp; int i, max=0;<br>
        &nbsp;&nbsp;&nbsp; for (i=1; i&lt;n; i++)<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (a[max]&lt;a[i])<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; max=i;<br>
        &nbsp;&nbsp;&nbsp; return max;<br>
        }<br>
        <br>
        int test[N];<br>
        int main(int argc, char *argv[]) {<br>
        int i, j;<br>
        for (i=0; i&lt;N; i++)<br>
        &nbsp; test[i]=rand();<br>
        j=clock();<br>
        i=array_int_max(test,N);<br>
        printf("clock=%ld index=%d max=%d\n",<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

























        clock()-j, i, test[i]);<br>
        return 0;<br>
        }<br>
        <b>OUTPUT</b><br>
        clock=96782 index=1310 max=2147483531<br>
        <hr style="width: 546px; height: 2px;">
        <h3>Loop Blocking<br>
        </h3>
        <div align="center">
          <div align="left">//#include "stdafx.h"&nbsp; //only for
            Microsoft<br>
            #include &lt;stdio.h&gt;<br>
            #include &lt;time.h&gt;<br>
            <br>
            #define N 1024<br>
            int x[N][N];<br>
            int y[N][N];<br>
            int z[N][N];<br>
            <br>
            void init() {<br>
            &nbsp;&nbsp;&nbsp; int i, j, k = 1;<br>
            &nbsp;&nbsp;&nbsp; for (i = 0; i&lt;N; i++)<br>
            &nbsp;&nbsp;&nbsp; for (j = 0; j&lt;N; j++) {<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; x[i][j] = k++;<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; y[i][j] = k++;<br>
            &nbsp;&nbsp;&nbsp; }<br>
            }<br>
            <br>
            void mul1() {<br>
            &nbsp;&nbsp;&nbsp; int i, j, k;<br>
            &nbsp;&nbsp;&nbsp; for (i = 0; i&lt;N; i++) {<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (j = 0; j&lt;N;
            j++) {<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; int
            sum = 0;<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for
            (k = 0; k&lt;N; k++)<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp; sum += x[i][k] * y[k][j];<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
            z[i][j] = sum;<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>
            &nbsp;&nbsp;&nbsp; }<br>
            }<br>
            <br>
            void mul3() {<br>
            #define M N<br>
            #define K N<br>
            #define MBlock 8<br>
            #define NBlock 8<br>
            #define KBlock 8<br>
            &nbsp;&nbsp;&nbsp; int i, j, l, r, s, t;<br>
            &nbsp;&nbsp;&nbsp; for (i = 0;i&lt;M; i += MBlock)<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (j = 0; j&lt;N; j
            += NBlock)<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (l = 0; l&lt;K; l
            += KBlock)<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (r = i; r&lt;i +
            MBlock; r++)<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (s = j; s&lt;j +
            NBlock; s++) {<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

























            int sum = 0;<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; for (t = l;
            t&lt;l + KBlock; t++)<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sum
            += x[r][t] * y[t][s];<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            z[r][s] = sum;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
            }<br>
            <br>
            void print(int z[N][N]) {<br>
            &nbsp;&nbsp;&nbsp; int i, j;<br>
            &nbsp;&nbsp;&nbsp; for (i = 0; i&lt;N; i++) {<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (j = 0; j&lt;N;
            j++) {<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
            printf("%d\t", z[i][j]);<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; printf("\n");<br>
            &nbsp;&nbsp;&nbsp; }<br>
            }<br>
            <br>
            int main() {<br>
            &nbsp;&nbsp;&nbsp; init();<br>
            &nbsp;&nbsp;&nbsp; clock_t tic = clock();<br>
            &nbsp;&nbsp;&nbsp; mul3();<br>
            &nbsp;&nbsp;&nbsp; clock_t toc = clock();<br>
            &nbsp;&nbsp;&nbsp; printf("Elapsed: %f seconds\n",
            (double)(toc - tic) / CLOCKS_PER_SEC);<br>
            &nbsp;&nbsp;&nbsp; //print(x);<br>
            &nbsp;&nbsp;&nbsp; //print(y);<br>
            &nbsp;&nbsp;&nbsp; //print(z);<br>
            &nbsp;&nbsp;&nbsp; return 0;<br>
            }<br>
          </div>
        </div>
        <table width="60%" cellspacing="2" cellpadding="2" border="2">
          <tbody>
            <tr>
              <td valign="top" align="center">Unblocked (mul1) N=1024<br>
              </td>
              <td valign="top" align="center">Blocked (mul3)<br>
              </td>
            </tr>
            <tr>
              <td valign="top">77s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

























                No optimization<br>
              </td>
              <td valign="top">12s<br>
              </td>
            </tr>
            <tr>
              <td valign="top">45s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

























                Maximum optimization<br>
              </td>
              <td valign="top">4s<br>
              </td>
            </tr>
          </tbody>
        </table>
        &nbsp; <br>
        <hr width="100%" size="2">
        <div align="center"><span style="font-weight: bold;"></span><span
            style="font-weight: bold;">LOOP UNROLLING</span><br>
        </div>
        #include &lt;stdio.h&gt;<br>
        #include &lt;stdlib.h&gt;<br>
        #include &lt;time.h&gt;<br>
        #define N 1008<br>
        <br>
        int A[N][N], B[N][N], C[N][N];<br>
        int main(int argc, char *argv[]) {<br>
        int i,j,k,z;<br>
        for (i=0; i&lt;N; i++)<br>
        for (j=0; j&lt;N; j++) {<br>
        &nbsp;&nbsp;&nbsp; A[i][j]=rand();<br>
        &nbsp;&nbsp;&nbsp; B[i][j]=A[i][j]+1;<br>
        &nbsp;&nbsp;&nbsp; C[i][j]=A[i][j]-1;<br>
        }<br>
        z=clock();<br>
        for (i=0; i&lt;N; i+=4)<br>
        for (j=0; j&lt;N; j++)<br>
        for (k=0; k&lt;N; k++) {<br>
        &nbsp;&nbsp;&nbsp; //8301 clocks, no unrolling<br>
        &nbsp;&nbsp;&nbsp; A[i][j] = A[i][j] + B[i][k] * C[k][j];<br>
        &nbsp; &nbsp; //4281 clocks, 2 statements
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
          class="Apple-converted-space">&nbsp;</span><br>
        &nbsp;&nbsp;&nbsp; A[i+1][j] = A[i+1][j] + B[i+1][k] * C[k][j];<br>
        &nbsp;&nbsp;&nbsp; //3251 clocks, 3 statements<br>
        &nbsp;&nbsp;&nbsp; A[i+2][j] = A[i+2][j] + B[i+2][k] * C[k][j];<br>
        &nbsp;&nbsp;&nbsp; //3063 clocks, 4 statements<br>
        &nbsp;&nbsp;&nbsp; A[i+3][j] = A[i+3][j] + B[i+3][k] * C[k][j];<br>
        }<br>
        printf("clock=%d\n", clock()-z);<br>
        return 0;<br>
        }<br>
        <hr style="width: 546px; height: 2px;">
        <h2>Vector Instructions</h2>
        <div style="text-align: center;"><span style="font-weight:
            bold;">vVector.h #defines</span><br>
        </div>
        // For each vector architecture...<br>
        // __SPU__ IBM/Sony Cell Broadband Engine SPE<br>
        // __VEC__ Altivec, Old Macs,&nbsp; IBM/Sony PPE, PowerPC<br>
        // __SSE__ __SSE2__ __SSE3__ Intel Processors<br>
        // __SCALAR__<br>
        <div style="text-align: center;"><span style="font-weight:
            bold;">vVector.h Data Types</span><br>
        </div>
        vInt32&nbsp;&nbsp;&nbsp; 4 ints<br>
        vInt16&nbsp;&nbsp;&nbsp; 8 shorts<br>
        vFloat&nbsp;&nbsp;&nbsp; 4 floats<br>
        vDouble 2 doubles<br>
        <div style="text-align: center;"><span style="font-weight:
            bold;">vVector.h Intrinsics Sample Program</span><br>
        </div>
        #include &lt;stdlib.h&gt;<br>
        #include &lt;stdio.h&gt;<br>
        #define __SSE__<br>
        #include "vVector.h"<br>
        #define vp vTostring<br>
        <br>
        int main( void ) {<br>
        vFloat r, x,y,z;<br>
        float a[6]={1,2,3,4,5,6};<br>
        printf("running in %s mode\n", tVECTOR);<br>
        vConstant(x,9.f);<br>
        printf("vConstant=%s\n", vp(x));<br>
        vZero(x);<br>
        printf("vZero=%s\n", vp(x));<br>
        vVector(x,1.f,-2.f,3.f,-4.f);<br>
        printf("vVector=%s\n", vp(x));<br>
        vAbs(y,x);<br>
        printf("vAbs(%s)=%s\n", vp(x), vp(y));<br>
        vCopy(x,y);<br>
        printf("vCopy(x,%s)=%s\n", vp(y), vp(x));<br>
        vVector(y,4.f,3.f,2.f,1.f);<br>
        vAdd(z,x,y);<br>
        printf("vAdd(%s :: %s)=%s\n", vp(x), vp(y), vp(z));<br>
        vAddib(z,x,36.f);<br>
        printf("vAddib(%s :: %g)=%s\n", vp(x), 36.f, vp(z));<br>
        vConstant(y,1);<br>
        vSubtract(z,x,y);<br>
        printf("vSubtract(%s :: %s)=%s\n", vp(x), vp(x), vp(z));<br>
        vConstant(y,3);<br>
        vMultiply(z,x,y);<br>
        printf("vMultiply(%s :: %s)=%s\n", vp(x), vp(x), vp(z));<br>
        vConstant(y,5);<br>
        vDivide(z,x,y);<br>
        printf("vDivide(%s :: %s)=%s\n", vp(x), vp(x), vp(z));<br>
        vReciprocal(z,x);<br>
        printf("vReciprocal(%s)=%s\n", vp(x), vp(z));<br>
        vReciprocalSquareRoot(z,x);<br>
        printf("vReciprocalSquareRoot(%s)=%s\n", vp(x), vp(z));<br>
        vSquareRoot(z,x);<br>
        printf("vSquareRoot(%s)=%s\n", vp(x), vp(z));<br>
        vConstant(y,5.f);<br>
        vVector(z,1.f,2.f,3.f,14.f);<br>
        vMADD(r,x,y,z);<br>
        printf("vMultiplyAdd(%s :: %s :: %s)=%s\n",<span
          class="Apple-converted-space">&nbsp;</span><br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

























        vp(x),vp(y),vp(z),vp(r));<br>
        vMax(y,x,z);<br>
        printf("vMax=(%s :: %s)%s\n", vp(x),vp(z),vp(y));<br>
        vMin(y,x,z);<br>
        printf("vMin=(%s :: %s)%s\n", vp(x),vp(z),vp(y));<br>
        vShuffle1(z,x,2,3,0,1);<br>
        printf("vShuffle1(%s :: 2 3 0 1)=%s\n", vp(x),vp(z));<br>
        vSplat(z,x,2);<br>
        printf("vSplat(%s :: 2)=%s\n", vp(x),vp(z));<br>
        vVector(y,8.f,9.f,10.f,11.f);<br>
        vShuffle(x,y,z,3,0,2,1);<br>
        printf("vShuffle(%s :: %s :: 3 0 2 1)=%s\n", vp(y),vp(z),vp(x));<br>
        printf("vGreaterEqual(%s :: %s)=%d\n",<span
          class="Apple-converted-space">&nbsp;</span><br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

























        vp(y),vp(z),vGreaterEqual(y,z));<br>
        vSelectGreater(r,x,y,y,z);<br>
        printf("vSelectGreater(true=%s :: false=%s :: %s ::%s)=<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

























        %s\n", vp(x),vp(y),vp(y),vp(z),vp(r));<br>
        vPromote(r,x,2);<br>
        printf("vPromote(%s :: %d)=%s\n", vp(x), 2, vp(r));<br>
        printf("vExtract(%s :: 1)=%g\n", vp(x), vExtract(x,1));<br>
        vCopy(r,x);<br>
        vInsert(x,2,33.f);<br>
        printf("vInsert(%s :: %d :: %g)=%s\n", vp(r), 2, 33.f, vp(x));<br>
        vVector(y,5.f,3.f,2.f,0.f);<br>
        vGather(r,a,y);<br>
        printf("vGather(1 2 3 4 5 6 ::%s)=%s\n", vp(y), vp(r));<br>
        vConstant(z,9.f);<br>
        vScatter(a,y,z);<br>
        printf("vScatter(%s ::%s)=%g %g %g %g %g %g&nbsp;&nbsp;&nbsp;
        \n",<span class="Apple-converted-space">&nbsp;</span><br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

























        vp(y), vp(z),a[0],a[1],a[2],a[3],a[4],a[5]);<br>
        return 0;<br>
        }<br>
        <span style="font-weight: bold;">OUTPUT</span><br>
        running in sse mode<br>
        vConstant=9 9 9 9<br>
        vZero= 0 0 0 0<br>
        vVector= 1 -2 3 -4<br>
        vAbs(1 -2 3 -4)= 1 2 3 4<br>
        vCopy(x,1 2 3 4)=1 2 3 4<br>
        vAdd(1 2 3 4 :: 4 3 2 1)=5 5 5 5<br>
        vAddib(1 2 3 4 :: 36)=&nbsp; 37 38 39 40<br>
        vSubtract(1 2 3 4 :: 1 2 3 4)= 0 1 2 3<br>
        vMultiply(1 2 3 4 :: 1 2 3 4)= 3 6 9 12<br>
        vDivide(1 2 3 4 :: 1 2 3 4)=0.2 0.4 0.6 0.8<br>
        vReciprocal(1 2 3 4)=&nbsp; 0.999 0.499 0.333 0.249<br>
        vReciprocalSquareRoot(1 2 3 4)=0.999 0.706 0.577 0.499<br>
        vSquareRoot(1 2 3 4)=&nbsp; 1&nbsp; 1.414 1.732 2<br>
        vMultiplyAdd(1 2 3 4 :: 5 5 5 5 :: 1 2 3 14)=6 12 18 34<br>
        vMax=(1 2 3 4 :: 1 2 3 14)=1 2 3 14<br>
        vMin=(1 2 3 4 :: 1 2 3 14)= 1 2 3 4<br>
        vShuffle1(1 2 3 4 :: 2 3 0 1)= 2 1 4 3<br>
        vSplat(1 2 3 4 :: 2)=&nbsp;&nbsp; 3 3 3 3<br>
        vShuffle(8 9 10 11 :: 3 3 3 3 :: 3 0 2 1)=9 10 3 3<br>
        vGreaterEqual(8 9 10 11 :: 3 3 3 3)=15<br>
        vSelectGreater(true=9 10 3 3 :: false=8 9 10 11 ::<br>
        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8 9 10 11 ::3 3 3 3)=9 10 3 3<br>
        vPromote(9 10 3 3 :: 2)= 3 10 3 3<br>
        vExtract(9 10 3 3 :: 1)= 10<br>
        vInsert(9 10 3 3 :: 2 :: 33)= 9 10 33 3<br>
        vGather(1 2 3 4 5 6 ::5 3 2 0)= 6 4 3 1<br>
        vScatter(5 3 2 0 ::9 9 9 9)=9 2 9 9 5 9<br>
        <hr style="width: 546px; height: 2px;">
        <div style="text-align: center;"><span style="font-weight:
            bold;">Vector Max Function</span><br>
        </div>
        #include &lt;stdio.h&gt;<br>
        #include &lt;stdlib.h&gt;<br>
        #include &lt;time.h&gt;<br>
        #define __SSE__<br>
        #include "vVector.h"<br>
        #define N 20000000<br>
        <br>
        int array_int_max(vInt32 a[], int n) {<br>
        int i;<br>
        vInt32 max,temp,temp1;<br>
        vCopy(max,a[0]);<br>
        for (i=1; i&lt;n; i+=4) {<br>
        &nbsp;&nbsp;&nbsp; vMax_int(temp,a[i],a[i+1]);<br>
        &nbsp;&nbsp;&nbsp; vMax_int(temp1,a[i+2],a[i+3]);<br>
        &nbsp;&nbsp;&nbsp; vMax_int(max,temp,max);<br>
        &nbsp;&nbsp;&nbsp; vMax_int(max,temp1,max);<br>
        }<br>
        vSplat_int(temp,max,0);&nbsp; vMax_int(max,temp,max);<br>
        vSplat_int(temp,max,1);&nbsp; vMax_int(max,temp,max);<br>
        vSplat_int(temp,max,2);&nbsp; vMax_int(max,temp,max);<br>
        return vExtract_int(max,3);<br>
        }<br>
        <br>
        int test[N];<br>
        int main(int argc, char *argv[]) {<br>
        int i,j;<br>
        for (i=0; i&lt;N; i++)<br>
        &nbsp; test[i]=rand();<br>
        j=clock();<br>
        i=array_int_max((vInt32 *)test,N/4);<br>
        printf("clock=%d max=%d\n", clock()-j, i);<br>
        return 0;<br>
        }<br>
        <span style="font-weight: bold;">OUTPUT</span><br>
        clock=22 max=32767<br>
        <hr style="width: 546px; height: 2px;">
        <div style="text-align: center;"><span style="font-weight:
            bold;">Vector Sort of an 8-Element Array</span><br>
        </div>
        #include &lt;stdio.h&gt;<br>
        #include &lt;stdlib.h&gt;<br>
        #define __SSE__<br>
        #include "vVector.h"<br>
        static void vSort8 (vFloat *a, vFloat *b) {<br>
        &nbsp;&nbsp;&nbsp; register vFloat temp1,temp2,temp3,<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

























        temp4,temp5; printf("%x\n",a);<br>
        &nbsp;&nbsp;&nbsp; vMin(temp2,a[0],b[0]);<br>
        //0 4 7 1 :: 8 8 4 9 -&gt; 0 4 4 1<br>
        &nbsp;&nbsp;&nbsp; vMax(temp3,a[0],b[0]);<br>
        //0 4 7 1 :: 8 8 4 9 -&gt; 8 8 7 9<br>
        &nbsp;&nbsp;&nbsp; vShuffle(temp4,temp2,temp3,0,2,0,2);
        //indices, right to left<br>
        //0 4 4 1 :: 8 8 7 9 -&gt; 9 8 1 4<br>
        &nbsp;&nbsp;&nbsp; vShuffle(temp5,temp2,temp3,1,3,1,3);<br>
        //0 4 4 1 :: 8 8 7 9 -&gt; 7 8 4 0<br>
        &nbsp;&nbsp;&nbsp; vMax(temp3,temp4,temp5);<br>
        //9 8 1 4 :: 7 8 4 0 -&gt; 9 8 4 4<br>
        &nbsp;&nbsp;&nbsp; vMin(temp2,temp4,temp5);<br>
        //9 8 1 4 :: 7 8 4 0 -&gt; 7 8 1 0<br>
        &nbsp;&nbsp;&nbsp; vShuffle1(temp5,temp3,1,0,3,2);<br>
        //9 8 4 4 -&gt; 4 4 9 8<br>
        &nbsp;&nbsp;&nbsp; vMin(temp1,temp5,temp2);<span
          class="Apple-converted-space">&nbsp;</span><br>
        //4 4 9 8 :: 7 8 1 0 -&gt; 4 4 1 0<br>
        &nbsp;&nbsp;&nbsp; vMax(temp2,temp5,temp2);<br>
        //4 4 9 8 :: 7 8 1 0 -&gt; 7 8 9 8<br>
        &nbsp;&nbsp;&nbsp; vShuffle1(temp4,temp2,2,3,0,1);<br>
        // 7 8 9 8 -&gt; 8 7 8 9<br>
        &nbsp;&nbsp;&nbsp; vMax(temp2,temp1,temp4);<br>
        //4 4 1 0 :: 8 7 8 9 -&gt; 8 7 8 9<br>
        &nbsp;&nbsp;&nbsp; vMin(temp1,temp1,temp4);<br>
        // 4 4 1 0 :: 8 7 8 9 -&gt; 4 4 1 0<br>
        &nbsp;&nbsp;&nbsp; vShuffle(temp4,temp1,temp2,1,3,1,3);<br>
        //4 4 1 0 :: 8 7 8 9 -&gt; 8 8 1 4<br>
        &nbsp;&nbsp;&nbsp; vShuffle(temp5,temp1,temp2,2,0,2,0);<br>
        //4 4 1 0 :: 8 7 8 9 -&gt; 7 9 4 0<br>
        &nbsp;&nbsp;&nbsp; vMin(temp1,temp4,temp5);<br>
        //8 8 1 4 :: 7 9 4 0 -&gt; 7 8 1 0<br>
        &nbsp;&nbsp;&nbsp; vMax(temp2,temp4,temp5);<br>
        //8 8 1 4 :: 7 9 4 0 -&gt; 8 9 4 4<br>
        &nbsp;&nbsp;&nbsp; vShuffle(temp4,temp2,temp1,3,1,3,1);<br>
        //8 9 4 4 :: 7 8 1 0 -&gt; 7 1 8 4<br>
        &nbsp;&nbsp;&nbsp; vShuffle(temp5,temp2,temp1,2,0,2,0);<br>
        //8 9 4 4 :: 7 8 1 0 -&gt; 8 0 9 4<br>
        &nbsp;&nbsp;&nbsp; vMin(temp1,temp4,temp5);<br>
        //7 1 8 4 :: 8 0 9 4 -&gt; 7 0 8 4<br>
        &nbsp;&nbsp;&nbsp; vMax(temp2,temp4,temp5);<br>
        //7 1 8 4 :: 8 0 9 4 -&gt; 8 1 9 4<br>
        &nbsp;&nbsp;&nbsp; vShuffle(temp4,temp1,temp2,1,3,1,3);<br>
        //7 0 8 4 :: 8 1 9 4 -&gt; 9 8 8 7<br>
        &nbsp;&nbsp;&nbsp; vShuffle(temp5,temp1,temp2,0,2,0,2);<br>
        //7 0 8 4 :: 8 1 9 4 -&gt; 4 1 4 0<br>
        &nbsp;&nbsp;&nbsp; vShuffle1(b[0],temp4,3,1,2,0);<br>
        //9 8 8 7 -&gt; 9 8 8 7<br>
        &nbsp;&nbsp;&nbsp; vShuffle1(a[0],temp5,3,1,2,0); //a and b in
        sorted order<br>
        //4 1 4 0 -&gt; 4 4 1 0<br>
        }<br>
        <br>
        int main(int argc, char *argv[]) {<br>
        int i;<br>
        float *test=(float *)_aligned_malloc (sizeof(float)*8, 16);<br>
        for (i=0; i&lt;8; i++)<span class="Apple-converted-space">&nbsp;</span><br>
        &nbsp; test[i]=(float)(rand()%10);<br>
        for (i=0; i&lt;8; i++)<br>
        &nbsp; printf("%g ",test[i]);<br>
        printf("\n");<br>
        vSort8((vFloat *)&amp;test[0], (vFloat *)&amp;test[4]);<br>
        for (i=0; i&lt;8; i++)<br>
        &nbsp;&nbsp; printf("%g ",test[i]);<br>
        printf("\n");<br>
        return 0;<br>
        }<br>
        <br>
        <span style="font-weight: bold;">OUTPUT</span><br>
        1 7 4 0 9 4 8 8<br>
        0 1 4 4 7 8 8 9<br>
        <hr style="width: 546px; height: 2px;">
        <h3>Compiler Vectorization</h3>
        <p>for (i=1; i&lt;n; i++) {<br>
          &nbsp;S1: a[i] = a[i-1] + 1;&nbsp;&nbsp; //loop-carried
          dependence<br>
          &nbsp;S2: b[i] =
          a[i];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          //loop-independent dependence<br>
          }<br>
        </p>
        <p>for (i=1; i&lt;=N; i++) {<br>
          &nbsp;S: a[i] = a[i-1] + b[i] * c[i];&nbsp; //loop-carried
          dependence on a[i], but not b or c<br>
          }<span class="Apple-converted-space">&nbsp;</span><br>
        </p>
        <p>//parallel alternative<br>
          temp[0] = a[0];<br>
          for (i=1; i&lt;=N; i++) { //can be vectorized<br>
          &nbsp; temp[i] = b[i] * c[i] + a[i-1];<br>
          }<span class="Apple-converted-space">&nbsp;</span><br>
          //copy temp[] to a[]<br>
        </p>
        <h4 class="subsection" style="color: rgb(0, 0, 0); font-family:
          Times; font-size: medium; font-style: normal;
          font-variant-ligatures: normal; font-variant-caps: normal;
          letter-spacing: normal; orphans: 2; text-align: start;
          text-indent: 0px; text-transform: none; white-space: normal;
          widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Loop-Specific

























          Pragmas</h4>
        <p>#pragma GCC ivdep<br>
        </p>
        <pre class="smallexample" style="color: rgb(0, 0, 0); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">     void foo (int n, int *a, int *b, int *c) {
       int i, j;
     #pragma GCC ivdep
       for (i = 0; i &lt; n; ++i)
         a[i] = b[i] + c[i];
     }
</pre>
        <p class="noindent" style="color: rgb(0, 0, 0); font-family:
          Times; font-size: medium; font-style: normal;
          font-variant-ligatures: normal; font-variant-caps: normal;
          font-weight: normal; letter-spacing: normal; orphans: 2;
          text-align: start; text-indent: 0px; text-transform: none;
          white-space: normal; widows: 2; word-spacing: 0px;
          -webkit-text-stroke-width: 0px;">Assume k &lt; -m or k &gt;=
          m. Only with the pragma can the compiler know that it can
          unconditionally vectorize the following loop:</p>
        <pre class="smallexample" style="color: rgb(0, 0, 0); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">     void ignore_vec_dep (int *a, int k, int c, int m) {
     #pragma GCC ivdep
       for (int i = 0; i &lt; m; i++) {
         a[i] = a[i + k] * c;<br>       }<br>    &nbsp;}</pre><h2>GPUs/OpenCL<br></h2><h3>OpenCL Example</h3><hr style="width: 546px; height: 2px;"><div style="text-align: center;"><span style="font-weight: bold;">OpenCL Vector Addition</span><br></div>#include &lt;stdio.h&gt;<br>#include &lt;stdlib.h&gt;<br>#include &lt;math.h&gt;<br>#include &lt;string.h&gt;<br>#include &lt;opencl.h&gt;<br><br>const char * sProgramSource =<br>"__kernel void vectorAdd(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n" \<br>"__global const float * a,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n" \<br>"__global const float * b,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n" \<br>"__global&nbsp;&nbsp; float * c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n" \<br>"{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n" \<br>"&nbsp;&nbsp; // Vector element index&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n" \<br>"&nbsp;&nbsp; int nIndex = get_global_id(0); \n" \<br>"&nbsp;&nbsp; c[nIndex] = a[nIndex] + b[nIndex]; \n" \<br>"}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n";<br><br>int main (int argc, const char * argv[]) {<br>const unsigned int cnBlockSize= 512;<br>const unsigned int cnBlocks =3;<br>size_t cnDimension = cnBlocks * cnBlockSize;<br>int err;<br>cl_device_id device_id;<br>size_t local;<br>size_t len;<br>char buffer[2048];<br><br>int gpu = 0;<br>err = clGetDeviceIDs(NULL, gpu<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ? CL_DEVICE_TYPE_GPU<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : CL_DEVICE_TYPE_CPU,<br>&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1, &amp;device_id, NULL);<br>if (err != CL_SUCCESS) {<br>&nbsp;&nbsp; printf("Error: Failed to get device ID\n");<br>&nbsp;&nbsp; exit(-1);<br>}<br>err = clGetDeviceInfo(device_id,<br>&nbsp; CL_DEVICE_NAME,<br>&nbsp;&nbsp; sizeof(buffer), buffer, &amp;len);<br>printf("CL_DEVICE_NAME: %s\n", buffer);<br>err = clGetDeviceInfo(device_id,<br>&nbsp; CL_DEVICE_VENDOR,<br>&nbsp; sizeof(buffer), buffer, &amp;len);<br>printf("CL_DEVICE_VENDOR: %s\n", buffer);<br><br>// create OpenCL context for the selected device<br>cl_context hContext;<br>hContext = clCreateContext(0, 1, &amp;device_id,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NULL, NULL, &amp;err);<br>if (err != CL_SUCCESS) {<br>&nbsp;&nbsp; printf("Error: Failed to create context\n");<br>&nbsp;&nbsp; exit(-1);<br>}<br><br>// create a command queue for our device<br>cl_command_queue hCmdQueue;<br>hCmdQueue =<br>&nbsp;&nbsp; clCreateCommandQueue(hContext, device_id, 0, 0);<br><br>// create &amp; compile program<br>cl_program hProgram;<br>hProgram = clCreateProgramWithSource(hContext, 1,<br>&nbsp;&nbsp;&nbsp; (const char **) &amp;sProgramSource, NULL, &amp;err);<br>if (!hProgram || err != CL_SUCCESS) {<br>&nbsp;&nbsp; printf("Error: Failed to create program with source\n");<br>&nbsp;&nbsp; exit(-1);<br>}<br><br>err = clBuildProgram(hProgram, 0, NULL,<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NULL, NULL, NULL);<br>if (err != CL_SUCCESS) {<br>&nbsp;&nbsp; printf("Error: Failed to build program executable\n");<br>&nbsp;&nbsp; clGetProgramBuildInfo(hProgram,<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; device_id, CL_PROGRAM_BUILD_LOG,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sizeof(buffer), buffer, &amp;len);<br>&nbsp;&nbsp; printf("%s\n", buffer);<br>&nbsp;&nbsp; exit(-1);<br>}<br><br>// create kernel<br>cl_kernel hKernel;<br>hKernel = clCreateKernel(hProgram, "vectorAdd", &amp;err);<br>if (!hKernel || err != CL_SUCCESS) {<br>&nbsp;&nbsp; printf("Error: Failed to create kernel\n");<br>&nbsp;&nbsp; exit(-1);<br>}<br><br>// allocate host vectors<br>float * pA = new float[cnDimension];<br>float * pB = new float[cnDimension];<br>float * pC = new float[cnDimension];<br>float * pC1 = new float[cnDimension];<br><br>memset(pC, 0, cnDimension * sizeof(float));<br>memset(pC1, 0, cnDimension * sizeof(float));<br>memset(pA, 0, cnDimension * sizeof(float));<br><br>// initialize host memory<br>int i;<br>for(i=0; i &lt; cnDimension; i++) pB[i] = i;<br><br>// allocate device memory<br>cl_mem hDeviceMemA, hDeviceMemB, hDeviceMemC;<br>hDeviceMemA = clCreateBuffer(hContext,<br>&nbsp;&nbsp; CL_MEM_READ_ONLY | CL_MEM_COPY_HOST_PTR,<br>&nbsp;&nbsp; cnDimension * sizeof(cl_float), pA, 0);<br>hDeviceMemB = clCreateBuffer(hContext,<br>&nbsp;&nbsp; CL_MEM_READ_ONLY | CL_MEM_COPY_HOST_PTR,<br>&nbsp;&nbsp; cnDimension * sizeof(cl_float), pB, 0);<br>hDeviceMemC = clCreateBuffer(hContext,<br>&nbsp;&nbsp; CL_MEM_WRITE_ONLY, cnDimension * sizeof(cl_float), 0, 0);<br><br>// setup parameter values<br>err = 0;<br>err&nbsp; = clSetKernelArg(hKernel, 0, sizeof(cl_mem),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (void *)&amp;hDeviceMemA);<br>err |= clSetKernelArg(hKernel, 1, sizeof(cl_mem),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (void *)&amp;hDeviceMemB);<br>err |= clSetKernelArg(hKernel, 2, sizeof(cl_mem),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (void *)&amp;hDeviceMemC);<br>if (err != CL_SUCCESS) {<br>&nbsp; printf("Error: Failed to set kernel args\n");<br>&nbsp; exit(-1);<br>}<br><br>// Get the maximum work-group size for executing the kernel on the device<br>err = clGetKernelWorkGroupInfo(hKernel, device_id,<br>&nbsp;&nbsp; CL_KERNEL_WORK_GROUP_SIZE, sizeof(local), &amp;local, NULL);<br>if (err != CL_SUCCESS) {<br>&nbsp;&nbsp; printf("Error: clGetKernelWorkGroupInfo Failed\n");<br>&nbsp;&nbsp; exit(-1);<br>}<br>printf("work group size=%ld\n", local);<br>// execute kernel<br>err = clEnqueueNDRangeKernel(hCmdQueue, hKernel, 1,<br>&nbsp;&nbsp;&nbsp; NULL, (size_t*)(&amp;cnDimension), &amp;local, 0, NULL, NULL);<br>if (err != CL_SUCCESS) {<br>&nbsp;&nbsp; printf("Error: clEnqueueNDRangeKernel Failed\n");<br>&nbsp;&nbsp; exit(-1);<br>}<br>// copy results from device back to host<br>clEnqueueReadBuffer(hCmdQueue, hDeviceMemC, CL_TRUE,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0, cnDimension * sizeof(cl_float),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pC, 0, NULL, NULL);<br><br>// wait for command queue<br>clFinish(hCmdQueue);<br>// compute sum the hard way and compare<br>int valid = 1;<br>for(i=0; i &lt; cnDimension; i++) {<br>&nbsp;&nbsp; pC1[i] = pA[i] + pB[i];<br>&nbsp;&nbsp; if (pC[i] != pC1[i]) {<br>&nbsp;&nbsp;&nbsp;&nbsp; printf("Error: %0.2f != %0.2f\n", pC[i], pC1[i]);<br>&nbsp;&nbsp;&nbsp;&nbsp; valid = 0;<br>&nbsp;&nbsp; }<br>}<br><br>printf("Number of elements : %ld\n", cnDimension);<br>printf("First Element: %0.2f\n", pC[0]);<br>printf("Last Element : %0.2f\n\n", pC[cnDimension-1]);<br>if (valid) printf("Test passed\n");<br>else printf("Test failed\n");<br><br>delete[] pA;<br>delete[] pB;<br>delete[] pC;<br>delete[] pC1;<br><br>clReleaseMemObject(hDeviceMemA);<br>clReleaseMemObject(hDeviceMemB);<br>clReleaseMemObject(hDeviceMemC);<br>clReleaseProgram(hProgram);<br>clReleaseKernel(hKernel);<br>clReleaseCommandQueue(hCmdQueue);<br>clReleaseContext(hContext);<br>exit(0);<br>}<br><div style="text-align: center;"><span style="font-weight: bold;">Vector Add with Two-Dimensional Mapping</span><br></div>const char * sProgramSource =<br>"__kernel void vectorAdd(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n" \<br>"__global const float * a,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n" \<br>"__global const float * b,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n" \<br>"__global&nbsp;&nbsp; float * c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n" \<br>"{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n" \<br>"&nbsp;&nbsp; // Vector element index&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n" \<br>"&nbsp;&nbsp; int nIndex = get_global_id(0)*get_global_size(1)+get_global_id(1);&nbsp;&nbsp;&nbsp;&nbsp; \n" \<br>"&nbsp;&nbsp; c[nIndex] = a[nIndex] + b[nIndex]; \n" \<br>"}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \n";<br><br>// execute kernel<br>size_t x[2]; x[0]=2; x[1]=cnDimension/2; //Global Size<br>size_t y[2]={1,1};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Local Size<br>err = clEnqueueNDRangeKernel(hCmdQueue, hKernel,<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2, NULL, &amp;x[0], &amp;y[0], 0, NULL, NULL);</div>
      <hr width="100%" size="2">
      <center>
        <h1><a name="r31"></a>CHAPTER THREE<br>PROGRAMMING WITH PROCESSES<br>
        
      </h1></center>
      <h2>Introduction</h2><hr width="100%" size="2">
      <p align="left"></p>
      <center> <u>USING THE OPERATING SYSTEM'S "time" FUNCTION </u></center>
      <br>
      <u>from C Include File "time.h"<br>
      </u><br>
      extern long time(time_t *tloc);<br>
      <br>
      <u> C Program "test.c"</u> <br>
      <br>
      #include &lt;time.h&gt;<br>
      #include &lt;stdio.h&gt;<br>
      <br>
      int main(int argc, char *argv[], char *envp[]) {<br>
      &nbsp;&nbsp;&nbsp; long x;<br>
      &nbsp;&nbsp;&nbsp; x=time(NULL);<br>
      &nbsp;&nbsp;&nbsp; printf("%ld\n",x);<br>
      &nbsp;&nbsp;&nbsp; return 0;<br>
      }<br>
      <br>
      <u>Sample Output</u><br>
      1215116784<br><hr width="100%" size="2"><h3>Thread Example
      </h3><hr>
      <div align="center"><b>POSIX Threads Matrix Multiplication<br>
        </b></div>
      <pre>#include &lt;stdio.h&gt;<br>#include &lt;pthread.h&gt;<br>#include &lt;assert.h&gt;<br><br>typedef struct {<br>  int *row;<br>  int *column;<br>  int *result;<br>  int n, columnStride;<br>} Work;<br><br>void *p(void *arg) {<br>Work *w=(Work *)arg;<br>int i;<br>*w-&gt;result = 0;<br>for (i=0; i&lt;w-&gt;n; i++) {<br>  *w-&gt;result += w-&gt;row[i]*<br>   w-&gt;column[i*w-&gt;columnStride];<br>}<br>printf("%d\n", *w-&gt;result);<br><span style="font-weight: bold;">pthread_exit</span>((void *)0);<br>}<br><br>//result = 3x2 * 2x3<br>int left[3][2]={{1,2},{3,4},{5,6}};<br>int right[2][3]={{1,2,3},{4,5,6}};<br>int result[3][3];<br><br>int main() {<br>pthread_t x[9];<br>Work args[9];<br>void *r;<br>int i,j;<br>for (i=0; i&lt;3; i++)<br>  for (j=0; j&lt;3; j++) {<br>    args[i*3+j].row=&amp;left[i][0];<br>    args[i*3+j].column=&amp;right[0][j];<br>    args[i*3+j].result=&amp;result[i][j];<br>    args[i*3+j].n=2;<br>    args[i*3+j].columnStride=3;<br>    assert(<br>    <span style="font-weight: bold;">pthread_create</span>(&amp;x[i*3+j], NULL, p,<br>        (void *)&amp;args[i*3+j]) == 0);<br>  } //for j<br>for (i=0; i&lt;9; i++) {<br>  assert(<span style="font-weight: bold;">pthread_join</span>(x[i], &amp;r) == 0);<br>}<br>for (i=0; i&lt;3; i++)<br>  for (j=0; j&lt;3; j++)<br>    printf("%d ", result[i][j]);<br>return 0;<br>}<br><u>OUTPUT</u><br>9<br>12<br>19<br>33<br>26<br>29<br>51<br>15<br>40<br>9 12 15 19 26 33 29 40 51<br></pre><hr width="100%" size="2">
      <div align="center"><b>Sequential Identifier Count</b><br>
        <br>
      </div>
      #include &lt;unistd.h&gt;<br>
      #include &lt;stdio.h&gt;<br>
      #include &lt;ctype.h&gt;<br>
      <br>
      int main(int argc, char *argv[]) {<br>
      &nbsp; FILE *f; int cnt, i; int count=0;<br>
      &nbsp; for (i=1; i&lt;argc; i++) {<br>
      &nbsp;&nbsp;&nbsp; int inID=0;&nbsp;&nbsp; cnt=0;<br>
      &nbsp;&nbsp;&nbsp; printf("%s ", argv[i]);<br>
      &nbsp;&nbsp;&nbsp; f=fopen(argv[i], "r");<br>
      &nbsp;&nbsp;&nbsp; if (f == NULL) {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("\n");<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;<br>
      &nbsp;&nbsp;&nbsp; }<br>
      &nbsp;&nbsp;&nbsp; while (!feof(f)) {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; char ch=fgetc(f);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ch == EOF) break;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (inID) {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if
      (isalpha(ch)||isdigit(ch)||ch=='_')<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      continue;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inID=0;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else if (isalpha(ch)) {<br>
      &nbsp;&nbsp; &nbsp; &nbsp;&nbsp; inID=1;&nbsp;&nbsp; cnt++;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
      &nbsp;&nbsp;&nbsp; } //while<br>
      &nbsp;&nbsp;&nbsp; fclose(f);<br>
      &nbsp;&nbsp;&nbsp; printf("%d\n", cnt); count+=cnt;<br>
      &nbsp; } //for<br>
      &nbsp; printf("%d\n", count);<br>
      &nbsp; return count;<br>
      }<br><hr width="100%" size="2">
      <div align="center"><b>Sequential Identifier Count with fork/exec</b><br>
        <br>
      </div>
      #include &lt;unistd.h&gt;<br>
      #include &lt;stdio.h&gt;<br>
      #include &lt;sys/wait.h&gt;<br>
      <br>
      int main(int argc, char *argv[]) {<br>
      int count=0, i;<br>
      for (i=1; i&lt;argc; i++) {<br>
      &nbsp;&nbsp;&nbsp; if (<span style="font-weight: bold;">fork</span>())
continue;&nbsp;

      //parent<br>
      &nbsp;&nbsp;&nbsp; <span style="font-weight: bold;">execl</span>("./cnt","./cnt",argv[i],0);<br>
      } //for<br>
      for (i=1; i&lt;argc; i++) {<br>
      &nbsp;&nbsp;&nbsp; int cnt;<br>
      &nbsp;&nbsp;&nbsp; <span style="font-weight: bold;">wait</span>(&amp;cnt);<br>
      &nbsp;&nbsp;&nbsp; count+=WEXITSTATUS(cnt);<br>
      }<br>
      printf("count = %d\n", count);<br>
      return 0;<br>
      }<br><hr width="100%" size="2">
      <div align="center"><b>Identifier Count with a Shell Procedure</b><br>
        <br>
      </div>
      declare -i x=0<br>
      for i in $* ; do<br>
      &nbsp;&nbsp; x=x+`./cnt $i` ;<br>
      &nbsp;&nbsp; echo $x ;<br>
      done<br>
      <b>Command Line</b><br>
      ./foo.sh /Users/bobcook/Desktop/*.txt<br>
      <b>Output</b><br>
      318<br>
      2605<br>
      3141<br>
      <hr width="100%" size="2">
      <p></p><p> </p>
      <hr width="100%" size="2">
      <div align="center"><b>Pipe Command Example</b><br>
      </div>
      #include &lt;unistd.h&gt;<br>
      #include &lt;stdlib.h&gt;<br>
      #include &lt;stdio.h&gt;<br>
      #include &lt;string.h&gt;<br>
      <br>
      int main() {<br>
      &nbsp; FILE *write;<br>
      &nbsp; char *str[]={"hi", "by", "so", "mo"};<br>
      &nbsp; int i;<br>
      &nbsp; write = <span style="font-weight: bold;">popen</span>("sort",

      "w");<br>
      &nbsp; if (write !=NULL) {<br>
      &nbsp;&nbsp;&nbsp; for (i=0; i&lt;4; i++)<br>
      &nbsp;&nbsp; &nbsp;&nbsp; fprintf(write, "%s\n", str[i]);<br>
      &nbsp;&nbsp;&nbsp; <span style="font-weight: bold;">pclose</span>(write);<br>
      &nbsp;&nbsp;&nbsp; exit(EXIT_SUCCESS);<br>
      &nbsp; }<br>
      &nbsp; exit(EXIT_FAILURE);<br>
      }<br>
      <b>OUTPUT</b><br>
      by<br>
      hi<br>
      mo<br>
      so<br><hr width="100%" size="2">
      <div align="center"><b>Pipe IPC for Matrix Multiplication</b><br>
        <br>
      </div>
      #include &lt;unistd.h&gt;<br>
      #include &lt;stdio.h&gt;<br>
      #include &lt;stdlib.h&gt;<br>
      #include &lt;sys/wait.h&gt;<br>
      <br>
      #define WORKERS 1<br>
      #define M 30<br>
      #define N 1000<br>
      typedef struct {<br>
      &nbsp;&nbsp;&nbsp; int a, n, i, j;<br>
      } Cell;<br>
      int left[M][N];<br>
      int right[N][M];<br>
      int result[M][M];<br>
      <br>
      int p_read(int handle, void *pp, int nn) {<br>
      &nbsp;&nbsp;&nbsp; char c, *p=(char *)pp;<br>
      &nbsp;&nbsp;&nbsp; int n=nn;<br>
      &nbsp;&nbsp;&nbsp; while (n--&gt;0) {<br>
      &nbsp;&nbsp;&nbsp; int i=<span style="font-weight: bold;">read</span>(handle,

      &amp;c, 1);<br>
      &nbsp;&nbsp;&nbsp; if (i&lt;=0) return i;<br>
      &nbsp;&nbsp;&nbsp; *p++ = c;<br>
      &nbsp;&nbsp;&nbsp; }<br>
      &nbsp;&nbsp;&nbsp; return nn;<br>
      }<br>
      int p_write(int handle, void *pp, int nn) {<br>
      &nbsp;&nbsp;&nbsp; char c, *p=(char *)pp;<br>
      &nbsp;&nbsp;&nbsp; int n=nn;<br>
      &nbsp;&nbsp;&nbsp; while (n--&gt;0) {<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; c = *p++;<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; int i=<span style="font-weight: bold;">write</span>(handle, &amp;c, 1);<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (i&lt;=0) return i;<br>
      &nbsp;&nbsp;&nbsp; }<br>
      &nbsp;&nbsp;&nbsp; return nn;<br>
      }<br>
      <br>
      int main(int argc, char *argv[]) {<br>
      int toProcess[2], fromProcess[2], i, j, k, n;<br>
      Cell c;<br>
      for (i=0; i&lt;M*N; i++) {<br>
      &nbsp;&nbsp;&nbsp; left[i/N][i%N]=1; right[i/M][i%M]=1;<br>
      }<br>
      <span style="font-weight: bold;">pipe</span>(&amp;fromProcess[0]);<br>
      <span style="font-weight: bold;">pipe</span>(&amp;toProcess[0]);<br>
      for (i=0; i&lt;WORKERS+1; i++) { //create workers<br>
      &nbsp;&nbsp;&nbsp; int *p, *q, *m, sum, me;<br>
      &nbsp;&nbsp;&nbsp; if (<span style="font-weight: bold;">fork</span>())
{

      //parent<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; continue;<br>
      &nbsp;&nbsp;&nbsp; }<br>
      &nbsp;&nbsp;&nbsp; if (i==0) { //send work to siblings<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (i=0; i&lt;M; i++) {<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (j=0;
      j&lt;M; j++) {<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; c.a=1; c.n=N; c.i=i; c.j=j;<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; k=p_write(toProcess[1], <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      &amp;c, sizeof(c));<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; k=p_write(toProcess[1], <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      &amp;left[i][0], sizeof(int)*N);<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; for (k=0; k&lt;N; k++) //column<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; n=p_write(toProcess[1],<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      &amp;right[k][j], sizeof(int));<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } //for j<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } //for i<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; c.a=0;&nbsp; //signal
      end-of-work<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (i=0; i&lt;WORKERS; i++)<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      k=p_write(toProcess[1],<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      &amp;c, sizeof(c));<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return 0;<br>
      &nbsp;&nbsp;&nbsp; } //end child 0<br>
      &nbsp;&nbsp;&nbsp; me=<span style="font-weight: bold;">getpid</span>();<br>
      &nbsp;&nbsp;&nbsp; while (1) {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j=p_read(toProcess[0],<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      &amp;c, sizeof(c));<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (j&lt;=0) return 0;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (c.a==0) return 0;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p = malloc(c.n*sizeof(int)*2);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m=p;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p_read(toProcess[0], p,<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      c.n*sizeof(int)*2);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; q=p+c.n;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (sum=0; c.n&gt;0; c.n--)<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sum += *p++ * *q++;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.n = sum;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j=p_write(fromProcess[1], <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      &amp;c, sizeof(c));<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("pid=%d %d %d %d %d\n",<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      me, c.a, c.n, c.i, c.j);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; free(m);<br>
      &nbsp;&nbsp;&nbsp; } //while<br>
      } //for<br>
      close(toProcess[0]);<br>
      close(toProcess[1]);<br>
      close(fromProcess[1]);<br>
      &nbsp;i=1;<br>
      while (1) {<br>
      &nbsp;&nbsp;&nbsp; int r=p_read(fromProcess[0], &amp;c,
      sizeof(c));<br>
      &nbsp;&nbsp;&nbsp; if (r&lt;=0) break;<br>
      &nbsp;&nbsp;&nbsp; printf("%d %d %d %d\n", c.a, c.n, c.i, c.j);<br>
      }<br>
      return 0;<br>
      }<br>
      <div align="center"><b>Modifications for Named Pipe Multiplication</b><br>
      </div>
      int main(int argc, char *argv[]) {<br>
      int toProcess, fromProcess, i, j, k, n;<br>
      Cell c;<br>
      for (i=0; i&lt;M*N; i++) {<br>
      &nbsp;&nbsp;&nbsp; left[i/N][i%N]=1; right[i/M][i%M]=1;<br>
      }<br>
      <span style="font-weight: bold;">unlink</span>("myfifo_to");<br>
      <span style="font-weight: bold;">unlink</span>("myfifo_from");<br>
      i=<span style="font-weight: bold;">mkfifo</span>("myfifo_to",
      0700);<br>
      if (i != 0) {perror("main"); exit(-1);}<br>
      i=<span style="font-weight: bold;">mkfifo</span>("myfifo_from",
      0700);<br>
      if (i != 0) {perror("main"); exit(-1);}<br>
      for (i=0; i&lt;WORKERS+1; i++) { //create workers<br>
      &nbsp;&nbsp;&nbsp; int *p, *q, *m, sum, me;<br>
      &nbsp;&nbsp;&nbsp; if (<span style="font-weight: bold;">fork</span>())
{

      //parent<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; continue;<br>
      &nbsp;&nbsp;&nbsp; }<br>
      &nbsp;&nbsp;&nbsp; if (i==0) {<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; toProcess=<span style="font-weight: bold;">open</span>("myfifo_to", O_WRONLY);<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (toProcess&lt;0) {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      perror("zero"); exit(-1);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (i=0; i&lt;M; i++) {<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (j=0;
      j&lt;M; j++) {<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; c.a=1; c.n=N; c.i=i; c.j=j;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      printf("00:%d %d %d %d\n",<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      c.a, c.n, c.i, c.j);<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; k=p_write(toProcess,<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      &amp;c, sizeof(c));<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; k=p_write(toProcess,<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      &amp;left[i][0], sizeof(int)*N);<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; for (k=0; k&lt;N; k++) //column<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; n=p_write(toProcess,<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      &amp;right[k][j], sizeof(int));<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } //for j<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } //for i<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; c.a=0;<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (i=0; i&lt;WORKERS; i++)<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      k=p_write(toProcess, &amp;c, sizeof(c));<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="font-weight:
        bold;">close</span>(toProcess);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("zero done\n");<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return 0;<br>
      &nbsp;&nbsp;&nbsp; }<br>
      &nbsp;&nbsp;&nbsp; me=<span style="font-weight: bold;">getpid</span>();<br>
      &nbsp;&nbsp;&nbsp; toProcess=<span style="font-weight: bold;">open</span>("myfifo_to",

      O_RDONLY);<br>
      &nbsp;&nbsp;&nbsp; if (toProcess&lt;0) {perror("child");
      exit(-1);}<br>
      &nbsp;&nbsp;&nbsp; fromProcess=<span style="font-weight: bold;">open</span>("myfifo_from",

      O_WRONLY);<br>
      &nbsp;&nbsp;&nbsp; if (fromProcess&lt;0) {perror("child");
      exit(-1);}<br>
      &nbsp;&nbsp;&nbsp; printf("%d in\n",me);<br>
      &nbsp;&nbsp;&nbsp; while (1) {<br>
      &nbsp;&nbsp;&nbsp; j=p_read(toProcess, &amp;c, sizeof(c));<br>
      &nbsp;&nbsp;&nbsp; if (j&lt;=0) break;<br>
      &nbsp;&nbsp;&nbsp; if (c.a==0) break;<br>
      &nbsp;&nbsp;&nbsp; p = malloc(c.n*sizeof(int)*2);&nbsp; m=p;<br>
      &nbsp;&nbsp;&nbsp; p_read(toProcess, p, c.n*sizeof(int)*2);<br>
      &nbsp;&nbsp;&nbsp; q=p+c.n;<br>
      &nbsp;&nbsp;&nbsp; for (sum=0; c.n&gt;0; c.n--)<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sum += *p++ * *q++;<br>
      &nbsp;&nbsp;&nbsp; c.n = sum;<br>
      &nbsp;&nbsp;&nbsp; j=p_write(fromProcess,<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      &amp;c, sizeof(c));<br>
      &nbsp;&nbsp;&nbsp; printf("pid=%d %d %d %d %d\n",<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      me, c.a, c.n, c.i, c.j);<br>
      &nbsp;&nbsp;&nbsp; free(m);<br>
      &nbsp;&nbsp;&nbsp; }<br>
      &nbsp;&nbsp;&nbsp; printf("%d out\n",me);<br>
      &nbsp;&nbsp;&nbsp; <span style="font-weight: bold;">close</span>(toProcess);&nbsp;

      <span style="font-weight: bold;">close</span>(fromProcess);<br>
      &nbsp;&nbsp;&nbsp; return 0;<br>
      } //for<br>
      fromProcess=<span style="font-weight: bold;">open</span>("myfifo_from",

      O_RDONLY);<br>
      if (fromProcess&lt;0) <span style="font-weight: bold;">exit</span>(EXIT_FAILURE);<br>
      i=1; j=M*M;<br>
      while (j--&gt;0) {<br>
      &nbsp;&nbsp;&nbsp; int r=p_read(fromProcess, &amp;c, sizeof(c));<br>
      &nbsp;&nbsp;&nbsp; if (r&lt;=0) break;<br>
      &nbsp;&nbsp;&nbsp; printf("%d %d %d %d\n", c.a, c.n, c.i, c.j);<br>
      }<br>
      return 0;<br>
      }<br>
      <b>OUTPUT</b> (for 3x3)<br>
      1727 in<br>
      00:1 3 0 0<br>
      00:1 3 0 1<br>
      00:1 3 0 2<br>
      00:1 3 1 0<br>
      00:1 3 1 1<br>
      00:1 3 1 2<br>
      00:1 3 2 0<br>
      00:1 3 2 1<br>
      00:1 3 2 2<br>
      pid=1727 1 3 0 0<br>
      pid=1727 1 3 0 1<br>
      pid=1727 1 3 0 2<br>
      pid=1727 1 3 1 0<br>
      pid=1727 1 3 1 1<br>
      pid=1727 1 3 1 2<br>
      pid=1727 1 3 2 0<br>
      pid=1727 1 3 2 1<br>
      pid=1727 1 3 2 2<br>
      1727 out<br>
      1 3 0 0<br>
      1 3 0 1<br>
      1 3 0 2<br>
      1 3 1 0<br>
      1 3 1 1<br>
      1 3 1 2<br>
      1 3 2 0<br>
      1 3 2 1<br>
      1 3 2 2<br><p> </p>
      <hr width="100%" size="2">
      <div align="center"><b>Message Queue Consumer Agent</b><br>
      </div>
      //execute the following commands as root to enable mqs<br>
      // mkdir /dev/mqueue<br>
      // mount -t mqueue none /dev/mqueue<br>
      // ls /dev/mqueue will display active mqs<br>
      // compile with -lrt to link with real-time library<br>
      #include &lt;stdio.h&gt;<br>
      #include &lt;stdlib.h&gt;<br>
      #include &lt;sys/wait.h&gt;<br>
      #include &lt;sys/stat.h&gt;<br>
      #include &lt;mqueue.h&gt;<br>
      #include &lt;assert.h&gt;<br>
      <br>
      int main(int argc, char *argv[]) {<br>
      mqd_t m;<br>
      int i;<br>
      struct mq_attr mqa;<br>
      char s[24];<br>
      mqa.mq_flags=0;<br>
      mqa.mq_maxmsg=8;&nbsp; //default is 10<br>
      mqa.mq_msgsize=16;//default is 8192<br>
      mqa.mq_curmsgs=0;<br>
      m=<span style="font-weight: bold;">mq_open</span>("/m_mq",
      O_RDONLY | O_CREAT,S_IRWXU, &amp;mqa);<br>
      assert(m&gt;=0);<br>
      i=<span style="font-weight: bold;">mq_receive</span>(m, s, 16,
      NULL);<br>
      assert(i==16);<br>
      printf("%s\n", s);<br>
      <span style="font-weight: bold;">mq_close</span>(m);<br>
      <span style="font-weight: bold;">mq_unlink</span>("/m_mq");<br>
      return 0;<br>
      }<br>
      <div align="center"><br>
      </div>
      <div align="center"><b>Message Queue Producer</b><br>
      </div>
      #include &lt;stdio.h&gt;<br>
      #include &lt;stdlib.h&gt;<br>
      #include &lt;sys/wait.h&gt;<br>
      #include &lt;sys/stat.h&gt;<br>
      #include &lt;mqueue.h&gt;<br>
      #include &lt;assert.h&gt;<br>
      <br>
      int main(int argc, char *argv[]) {<br>
      mqd_t m;<br>
      int i;<br>
      char s[24]="abcdefghijklmno";<br>
      m=<span style="font-weight: bold;">mq_open</span>("/m_mq",
      O_WRONLY);<br>
      assert(m&gt;=0);<br>
      i=<span style="font-weight: bold;">mq_send</span>(m, s, 16, 1);<br>
      perror("W");<br>
      <span style="font-weight: bold;">mq_close</span>(m);<br>
      return 0;<br>
      }<br><hr width="100%" size="2">
      <div align="center"><b>Shared Memory Consumer Process</b><br>
      </div>
      #include &lt;unistd.h&gt;<br>
      #include &lt;stdio.h&gt;<br>
      #include &lt;stdlib.h&gt;<br>
      #include &lt;sys/types.h&gt;<br>
      #include &lt;string.h&gt;<br>
      #include &lt;sys/ipc.h&gt;<br>
      #include &lt;sys/shm.h&gt;<br>
      <br>
      #define SIZE 8192<br>
      int main(int argc, char *argv[]) {<br>
      int shmid;<br>
      char * adr;<br>
      shmid = <span style="font-weight: bold;">shmget</span>((key_t)1234,
SIZE,

      0600|IPC_CREAT);<br>
      if (shmid == -1) {<br>
      &nbsp; perror("consumer"); <span style="font-weight: bold;">exit</span>(EXIT_FAILURE);<br>
      }<br>
      adr = <span style="font-weight: bold;">shmat</span>(shmid, NULL,
      0);<br>
      if (adr == (char *)-1) {<br>
      &nbsp; perror("consumer"); <span style="font-weight: bold;">exit</span>(EXIT_FAILURE);<br>
      }<br>
      printf("shared memory at %x\n", (int)adr);<br>
      while (*adr == 0) <span style="font-weight: bold;">sleep</span>(0);<br>
      //printf("%s", adr);<br>
      if (<span style="font-weight: bold;">shmdt</span>(adr) == -1) {<br>
      &nbsp; perror("consumer"); <span style="font-weight: bold;">exit</span>(EXIT_FAILURE);<br>
      }<br>
      if (<span style="font-weight: bold;">shmctl</span>(shmid,
      IPC_RMID, 0) == -1) {<br>
      &nbsp; perror("consumer"); <span style="font-weight: bold;">exit</span>(EXIT_FAILURE);<br>
      }<br>
      <span style="font-weight: bold;">exit</span>(EXIT_SUCCESS);<br>
      }<br>
      <div align="center"><b>Shared Memory Producer Process</b><br>
      </div>
      #include &lt;unistd.h&gt;<br>
      #include &lt;stdio.h&gt;<br>
      #include &lt;stdlib.h&gt;<br>
      #include &lt;sys/types.h&gt;<br>
      #include &lt;string.h&gt;<br>
      #include &lt;sys/ipc.h&gt;<br>
      #include &lt;sys/shm.h&gt;<br>
      <br>
      #define SIZE 8192<br>
      int main(int argc, char *argv[]) {<br>
      int shmid;<br>
      char * adr;<br>
      shmid = <span style="font-weight: bold;">shmget</span>((key_t)1234,
SIZE,

      0600|IPC_CREAT);<br>
      if (shmid == -1) {<br>
      &nbsp; perror("producer"); <span style="font-weight: bold;">exit</span>(EXIT_FAILURE);<br>
      }<br>
      adr = <span style="font-weight: bold;">shmat</span>(shmid, NULL,
      0);<br>
      if (adr == (char *)-1) {<br>
      &nbsp; perror("producer"); <span style="font-weight: bold;">exit</span>(EXIT_FAILURE);<br>
      }<br>
      printf("shared memory at %x\n", (int)adr);<br>
      strcpy(adr, "hello from another process\n");<br>
      if (<span style="font-weight: bold;">shmdt</span>(adr) == -1) {<br>
      &nbsp; perror("producer"); <span style="font-weight: bold;">exit</span>(EXIT_FAILURE);<br>
      }<br>
      <span style="font-weight: bold;">exit</span>(EXIT_SUCCESS);<br>
      }<br><hr width="100%" size="2">
      <div align="center"><b>Counting Identifiers in Shared Files<br>
          <br>
        </b></div>
      #include &lt;unistd.h&gt;<br>
      #include &lt;stdio.h&gt;<br>
      #include &lt;ctype.h&gt;<br>
      #include &lt;pthread.h&gt;<br>
      #include &lt;assert.h&gt;<br>
      #include &lt;sys/stat.h&gt;<br>
      #define CHUNK 4096*4<br>
      typedef struct {<br>
      &nbsp;&nbsp;&nbsp; FILE *f;<br>
      &nbsp;&nbsp;&nbsp; int n;<br>
      } Work;<br>
      <br>
      void *p(void *arg) {<br>
      Work *p=arg;<br>
      int inID=0, cnt=0;<br>
      while (!feof(p-&gt;f)) {<br>
      &nbsp;&nbsp;&nbsp; char ch=fgetc(p-&gt;f);<br>
      &nbsp;&nbsp;&nbsp; if (ch == EOF) break;<br>
      &nbsp;&nbsp;&nbsp; p-&gt;n--;<br>
      &nbsp;&nbsp;&nbsp; if (inID) {<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (p-&gt;n &lt;= 0) break;<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if
      (isalpha(ch)||isdigit(ch)||ch=='_')<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; continue;<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; inID=0;<br>
      &nbsp;&nbsp;&nbsp; } else if (isalpha(ch)) {<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; inID=1;&nbsp;&nbsp; cnt++;<br>
      &nbsp;&nbsp;&nbsp; }<br>
      &nbsp;&nbsp;&nbsp; if (p-&gt;n &lt;= 0) break;<br>
      } //while<br>
      fclose(p-&gt;f);<br>
      p-&gt;n=cnt;<br>
      <span style="font-weight: bold;">pthread_exit</span>((void *)0);<br>
      }<br>
      int main(int argc, char *argv[]) {<br>
      FILE *f;&nbsp; int count=0, j, k;<br>
      pthread_t x[50];<br>
      Work work[50];<br>
      struct stat st;<br>
      for (int i=1; i&lt;argc; i++) {<br>
      &nbsp;&nbsp;&nbsp; printf("%s ", argv[i]);<br>
      &nbsp;&nbsp;&nbsp; f=fopen(argv[i], "r");<br>
      &nbsp;&nbsp;&nbsp; if (f == NULL) {<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; printf("\n");<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; continue;<br>
      &nbsp;&nbsp;&nbsp; }<br>
      &nbsp;&nbsp;&nbsp; j=fstat(fileno(f), &amp;st);<br>
      &nbsp;&nbsp;&nbsp; assert(j==0);<br>
      &nbsp;&nbsp;&nbsp; printf("%d ",st.st_size);<br>
      &nbsp;&nbsp;&nbsp; fclose(f);<br>
      &nbsp;&nbsp;&nbsp; j=0;&nbsp; k=0;<br>
      &nbsp;&nbsp;&nbsp; while (k&lt;st.st_size) {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; f=fopen(argv[i], "r");<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; fseek(f, k, SEEK_SET);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; work[j].f = f;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; work[j].n = CHUNK;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; k += CHUNK;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (k &gt;= st.st_size)<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      work[j].n=st.st_size-(k-CHUNK);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("k,n=%d %d\n",
      k, work[j].n);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; assert(<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      <span style="font-weight: bold;">pthread_create</span>(&amp;x[j],
      NULL, p,<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      (void *)&amp;work[j]) == 0);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j++;<br>
      &nbsp;&nbsp;&nbsp; } //while<br>
      &nbsp;&nbsp;&nbsp; while (--j&gt;=0) {<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; assert(<span style="font-weight: bold;">pthread_join</span>(x[j], NULL) ==
      0);<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; printf("%d\n", work[j].n);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; count+=work[j].n;<br>
      &nbsp;&nbsp;&nbsp; }<br>
      } //for<br>
      printf("%d\n", count);<br>
      return count;<br>
      }<br>
      <b>OUTPUT</b><br>
      /Users/bobcook/Desktop/javacode.html 113373<br>
      k,n=16384 16384<br>
      k,n=32768 16384<br>
      k,n=49152 16384<br>
      k,n=65536 16384<br>
      k,n=81920 16384<br>
      k,n=98304 16384<br>
      k,n=114688 15069<br>
      2452<br>
      2554<br>
      2340<br>
      2536<br>
      2631<br>
      2615<br>
      2628<br>
      17756<br><hr width="100%" size="2">
      <div align="center"><b>Counting Identifiers in a Memory-Mapped
          File</b><br>
      </div>
      #include &lt;unistd.h&gt;<br>
      #include &lt;stdio.h&gt;<br>
      #include &lt;ctype.h&gt;<br>
      #include &lt;pthread.h&gt;<br>
      #include &lt;assert.h&gt;<br>
      #include &lt;sys/mman.h&gt;<br>
      #include &lt;sys/stat.h&gt;<br>
      #define CHUNK 4096*4<br>
      typedef struct {<br>
      &nbsp;&nbsp;&nbsp; char *f;<br>
      &nbsp;&nbsp;&nbsp; int n;<br>
      } Work;<br>
      <br>
      void *p(void *arg) {<br>
      Work *p=arg;<br>
      int inID=0, cnt=0;<br>
      while (1) {<br>
      &nbsp;&nbsp;&nbsp; char ch=*(p-&gt;f)++;<br>
      &nbsp;&nbsp;&nbsp; p-&gt;n--;<br>
      &nbsp;&nbsp;&nbsp; if (inID) {<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (p-&gt;n &lt;= 0) break;<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if
      (isalpha(ch)||isdigit(ch)||ch=='_')<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; continue;<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; inID=0;<br>
      &nbsp;&nbsp;&nbsp; } else if (isalpha(ch)) {<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; inID=1;&nbsp;&nbsp; cnt++;<br>
      &nbsp;&nbsp;&nbsp; }<br>
      &nbsp;&nbsp;&nbsp; if (p-&gt;n &lt;= 0) break;<br>
      } //while<br>
      p-&gt;n=cnt;<br>
      <span style="font-weight: bold;">pthread_exit</span>((void *)0);<br>
      }<br>
      int main(int argc, char *argv[]) {<br>
      FILE *f;&nbsp; int count=0, j, k;<br>
      pthread_t x[50];<br>
      Work work[50];<br>
      struct stat st;<br>
      char *adr;<br>
      for (int i=1; i&lt;argc; i++) {<br>
      &nbsp;&nbsp;&nbsp; printf("%s: ", argv[i]);<br>
      &nbsp;&nbsp;&nbsp; f=fopen(argv[i], "r");<br>
      &nbsp;&nbsp;&nbsp; if (f == NULL) {<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; printf("\n");<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; continue;<br>
      &nbsp;&nbsp;&nbsp; }<br>
      &nbsp;&nbsp;&nbsp; j=fstat(fileno(f), &amp;st);<br>
      &nbsp;&nbsp;&nbsp; assert(j==0);<br>
      &nbsp;&nbsp;&nbsp; printf("%d ",st.st_size);<br>
      &nbsp;&nbsp;&nbsp; adr=<span style="font-weight: bold;">mmap</span>(NULL,

      st.st_size, PROT_READ, MAP_FILE|MAP_SHARED, fileno(f), 0);<br>
      &nbsp;&nbsp;&nbsp; printf("using adr %x\n");<br>
      &nbsp;&nbsp;&nbsp; j=0;&nbsp; k=0;<br>
      &nbsp;&nbsp;&nbsp; while (k&lt;st.st_size) {<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; work[j].f = adr+k;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; work[j].n = CHUNK;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; k += CHUNK;<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (k &gt;= st.st_size)<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      work[j].n=st.st_size-(k-CHUNK);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("k,n=%d %d\n",
      k, work[j].n);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; assert(<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      <span style="font-weight: bold;">pthread_create</span>(&amp;x[j],
      NULL, p,<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      (void *)&amp;work[j]) == 0);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j++;<br>
      &nbsp;&nbsp;&nbsp; } //while<br>
      &nbsp;&nbsp;&nbsp; while (--j&gt;=0) {<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; assert(<span style="font-weight: bold;">pthread_join</span>(x[j], NULL) ==
      0);<br>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; printf("%d\n", work[j].n);<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; count+=work[j].n;<br>
      &nbsp;&nbsp;&nbsp; }<br>
      &nbsp;&nbsp;&nbsp; assert(<span style="font-weight: bold;">munmap</span>(adr,

      st.st_size)==0);<br>
      &nbsp;&nbsp;&nbsp; fclose(f);<br>
      } //for<br>
      printf("%d\n", count);<br>
      return count;<br>
      }<br>
      <b>OUTPUT</b><br>
      /Users/bobcook/Desktop/javacode.html: 113373 using adr 1badd<br>
      k,n=16384 16384<br>
      k,n=32768 16384<br>
      k,n=49152 16384<br>
      k,n=65536 16384<br>
      k,n=81920 16384<br>
      k,n=98304 16384<br>
      k,n=114688 15069<br>
      2452<br>
      2554<br>
      2340<br>
      2536<br>
      2631<br>
      2615<br>
      2628<br>
      17756<br>
      <p> </p>
      <p> </p>
      <hr width="100%" size="2">
      <center>
        <h1><a name="r41"></a>CHAPTER FOUR<br>OPENMP PROGRAMMING<br>
      </h1></center>
      <h2>Introduction</h2><hr width="100%" size="2">
      <div align="center"><b>Linux or OS/X Command Line</b><br>
      </div>
      gcc -fopenmp test.c<br><hr width="100%" size="2">
      <div style="text-align: center;"><span style="font-weight: bold;">Test
if

          OpenMP is Installed Correctly</span><br>
      </div>
      //Test which checks for OpenMP support.<br>
      #include &lt;stdio.h&gt;<br>
      #include "omp.h"<br>
      #ifdef WIN32<br>
      #include "stdafx.h"<br>
      int _tmain(int argc, _TCHAR* argv[]) {<br>
      #else<br>
      int main (int argc, char *argv[]) {<br>
      #endif<br>
      &nbsp;&nbsp;&nbsp; int rvalue = 0;<br>
      #ifdef _OPENMP<br>
      &nbsp;&nbsp;&nbsp; rvalue = 1;<br>
      #endif<br>
      &nbsp;&nbsp;&nbsp; printf("_OPENMP %s\n", rvalue ?"passed"
      :"failed");<br>
      &nbsp;&nbsp;&nbsp; return 0;<br>
      }<br>
      <hr width="100%" size="2">
      <table style="text-align: left; width: 100%;" cellspacing="2" cellpadding="2" border="1">
        <tbody>
          <tr>
            <td style="vertical-align: top;">int a[100];&nbsp;
              &lt;--global variables<br>
            </td>
            <td style="vertical-align: top;">Copy globals into closure
              or create references.<br>
              "a" is a free variable.<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">int sum=0;&nbsp; &lt;--
              local variables<br>
            </td>
            <td style="vertical-align: top;">Copy locals into closure or
              create references.<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">for (int i=0; i&lt;100;
              i++) sum += a[i];<br>
            </td>
            <td style="vertical-align: top;">Create glue code to
              enter/exit closure.<br>
            </td>
          </tr>
          <tr>
            <td colspan="2" rowspan="1" style="vertical-align: top;"><meta charset="utf-8"><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>Created Closure</b><br></div><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">typedef struct Work {</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; int* refA;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; int* refSum;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">};</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">void* closure(void* work ) {</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">Work* w = (Work *)work;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">int&nbsp; i;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">*(w-&gt;refSum) = 0;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">for (i=0; i&lt;100; i++)</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *(w-&gt;refSum) += w-&gt;refA[i];</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;"><b>pthread_exit</b>(0);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">}</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>OpenMP Closure with Loop Parameterization</b><br><div align="left">typedef struct Work {<br>&nbsp; int* refA;<br>&nbsp; int* refSum;<br>&nbsp; int loopStart, loopEnd;<br>};<br>void* closure(void* work ) {<br>Work* w = (Work *)work;<br>int&nbsp; i;<br>*(w-&gt;refSum) = 0;<br>for (i=w-&gt;loopStart; i&lt;=w-&gt;loopEnd; i++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *(w-&gt;refSum) += w-&gt;refA[i];<br><b>pthread_exit</b>(0);<br>}</div></div></td>
          </tr>
        </tbody>
      </table><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;"><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"></span><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" width="100%" size="2"><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>Missing private clause causes interference on x</b><br></div><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#include "omp.h"</span><span class="Apple-converted-space">&nbsp;</span><br>static long num_steps = 100000;<span class="Apple-converted-space">&nbsp;</span><br>double step;<span class="Apple-converted-space">&nbsp;</span><br>void main () {<br>&nbsp;int i;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;double x, sum = 0.0;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;step = 1.0 / (double) num_steps;<span class="Apple-converted-space">&nbsp;</span><br><b>#pragma omp parallel for reduction(+:sum)</b><br>&nbsp; for (i=1; i&lt;= num_steps; i++) {<br>&nbsp; &nbsp; x = (i - 0.5) * step;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp; sum = sum + 4.0 / (1.0 + x * x);<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; }<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; pi = step * sum;<span class="Apple-converted-space">&nbsp;</span><br>}<br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="text-decoration: underline;"></span></b><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; margin-left: 40px;"><hr style="width: 1019px; height: 2px;"><div style="text-align: center;"><span style="font-weight: bold;">Parallel Region Closure Initialization</span><br></div>#include "omp.h"<br>#include &lt;stdio.h&gt;<br><br>int main (int argc, char *argv[]) {<br>int j=52; int k=6, i;<br><b>#pragma omp parallel for \</b><b><br></b><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lastprivate(k) firstprivate(j)</b><br>for (i=0; i&lt;8; i++) {<br>&nbsp; printf("thread %d i=%d j=%d\n",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; omp_get_thread_num(), i, j);<br>&nbsp; j++;&nbsp; k=99;<br>} //for<br>printf("j=%d k=%d\n", j, k);<br>return 0;<br>}<br><br><span style="font-weight: bold;">OUTPUT</span><br>thread 0 i=0 j=52<br>thread 0 i=1 j=53<br>thread 0 i=2 j=54<br>thread 0 i=3 j=55<br>thread 1 i=4 j=52<br>thread 1 i=5 j=53<br>thread 1 i=6 j=54<br>thread 1 i=7 j=55<br>j=52 k=99<br><hr style="width: 1019px; height: 2px;"><div style="text-align: center;"><span style="font-weight: bold;">Parallel Prime Number Counter</span><br></div>#include "omp.h"<br>#include &lt;stdio.h&gt;<br>#include &lt;math.h&gt;<br><br>int main (int argc, char *argv[]) {<br>int numPrimes=0, numP41=0, numP43=0;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>int i, j, limit;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br><b>#pragma omp parallel for private(j,limit) \</b><b><br></b><b>&nbsp;&nbsp; schedule(static, 100) \</b><b><br></b><b>&nbsp;&nbsp; reduction(+ : numPrimes, numP41, numP43)&nbsp;</b>&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>for(i = 3; i &lt;= 1000000; i += 2) {&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; limit = (int) sqrt((float)i) + 1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; j = 3;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; while (j &lt;= limit &amp;&amp; (i%j != 0))<br>&nbsp;&nbsp;&nbsp; j+=2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; if (j&gt;limit) {&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; &nbsp; numPrimes++;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp; if (i%4 == 1) numP41++;&nbsp; // 4k+1 primes&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp; if (i%4 == 3) numP43++;&nbsp; // 4k+3 primes&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; }&nbsp;&nbsp; //if j<br>}&nbsp;&nbsp; //for i<br>printf("primes=%d p41=%d p43=%d\n",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; numPrimes, numP41, numP43);<br>return 0;<br>}<br><br><span style="font-weight: bold;">OUTPUT</span><br>primes=78497 p41=39175 p43=39322<br><hr style="width: 1019px; height: 2px;"><hr style="width: 1019px; height: 2px;"><div style="text-align: center;"><span style="font-weight: bold;">Parallel Array Sum</span><br></div>#include "omp.h"<br>#include &lt;stdio.h&gt;<br>#include &lt;math.h&gt;<br>#define M 3<br>#define N 3<br>int main (int argc, char *argv[]) {<br>int a[M][N];<br>int i,j,sum=0,k=1;<br>for (i=0; i&lt;M; i++)<br>&nbsp;&nbsp; for (j=0; j&lt;N; j++)<br>&nbsp;&nbsp;&nbsp;&nbsp; a[i][j]=k++;<br><b>#pragma omp parallel for \</b><b><br></b><b>&nbsp;&nbsp; reduction(+ : sum) private(j)</b><br>for (i=0; i&lt;M; i++)<br>&nbsp; for (j=0; j&lt;N; j++) {<br>&nbsp;&nbsp;&nbsp; sum+=a[i][j];<br>&nbsp;&nbsp;&nbsp; printf("thread=%d i=%d j=%d\n",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>omp_get_thread_num</b>(),i,j);<br>&nbsp; } //for j<br>printf("sum= %d should be=%d\n",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sum, M*N*(M*N+1)/2);<br>return 0;<br>}<br><br><span style="font-weight: bold;">OUTPUT</span><br>thread=0 i=0 j=0<br>thread=1 i=2 j=0<br>thread=0 i=0 j=1<br>thread=1 i=2 j=1<br>thread=0 i=0 j=2<br>thread=1 i=2 j=2<br>thread=0 i=1 j=0<br>thread=0 i=1 j=1<br>thread=0 i=1 j=2<br>sum= 45 should be=45<br><hr style="width: 1019px; height: 2px;"><div style="text-align: center;"><span style="font-weight: bold;">Parallel Numerical Integration</span><br><br><br></div># include &lt;stdlib.h&gt;<br># include &lt;stdio.h&gt;<br># include &lt;math.h&gt;<br># include &lt;time.h&gt;<br># include &lt;omp.h&gt;<br>//computes integral from a to b using quadrature method<br>//adapted from an example at http://people.sc.fsu.edu/~jburkardt/<br>double f ( double x );<br><br>int main ( int argc, char *argv[] ) {<br>double a = 0.0, b = 10.0;<br>double error;<br>double exact = 0.49936338107645674464;<br>int i, n = 1000000;<br>double total=0, wtime, x;<br>printf ( "\n&nbsp; Estimate the integral of f(x) from A to B.\n" );<br>printf ( "&nbsp; f(x) = 50 / ( pi * ( 2500 * x * x + 1 ) ).\n" );<br>printf ( "\n&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = %f\n", a );<br>printf ( "&nbsp; B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = %f\n", b );<br>printf ( "&nbsp; N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = %d\n", n );<br>printf ( "&nbsp; Exact&nbsp;&nbsp;&nbsp; = %24.16f\n", exact );<br>wtime = <b>omp_get_wtime ( )</b>;<br><b>#pragma omp parallel for firstprivate(a, b, n) \</b><br><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private(x) reduction(+ : total)</b><br>for ( i = 0; i &lt; n; i++ ) {<br>&nbsp;&nbsp;&nbsp; x = ( ( n - i - 1 ) * a + i * b ) / ( n - 1 );<br>&nbsp;&nbsp;&nbsp; total += f ( x );<br>}<br>wtime = <b>omp_get_wtime ( )</b> - wtime;<br>total = ( b - a ) * total / ( double ) n;<br>error = fabs ( total - exact );<br>printf ( "\n&nbsp; Estimate = %24.16f\n", total );<br>printf ( "&nbsp; Error&nbsp;&nbsp;&nbsp; = %e\n", error );<br>printf ( "&nbsp; Time&nbsp;&nbsp;&nbsp;&nbsp; = %f\n", wtime );<br>return 0;<br>}<br><br>double f ( double x ) {<br>#define PI 3.141592653589793<br>&nbsp; return 50.0 / ( PI * ( 2500.0 * x * x + 1.0 ) );<br>}<br><br><span style="font-weight: bold;">OUTPUT</span><br>&nbsp; Estimate the integral of f(x) from A to B.<br>&nbsp; f(x) = 50 / ( pi * ( 2500 * x * x + 1 ) ).<br><br>&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 0.000000<br>&nbsp; B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 10.000000<br>&nbsp; N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 1000000<br>&nbsp; Exact&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 0.4993633810764567<br><br>&nbsp; Estimate = 0.4994424595029285<br>&nbsp; Error&nbsp;&nbsp;&nbsp; = 7.907843e-005<br>&nbsp; Time&nbsp;&nbsp;&nbsp;&nbsp; = 0.059332<br><hr style="width: 1019px; height: 2px;"><div style="text-align: center;"><span style="font-weight: bold;">OMP SINGLE and OMP MASTER</span><br></div><b>#pragma omp single</b> [clause [[,] clause] ...]<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp; structured-block<br><br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><span style="font-weight: bold;">CLAUSES</span><br>private(identifier-list)<br>firstprivate(identifier-list)<br><br><b>#pragma omp master</b><b><span class="Apple-converted-space">&nbsp;</span></b><br>&nbsp;&nbsp;&nbsp; structured-block<br><div style="text-align: center;"><span style="font-weight: bold;">Parallel Max Function</span><br></div>#include "omp.h"<br>#include &lt;stdio.h&gt;<br><br>int array_int_max(int a[], int n) {<br>int maxes[4], i, j;<br><b>#pragma omp parallel shared(maxes,a) \</b><b><br></b><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; firstprivate(n) private(j) num_threads(4)</b><br>{<br><b>#pragma omp single</b><br>{<br>&nbsp;&nbsp;&nbsp; for (j=0; j&lt;4; j++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maxes[j] = 0;<br>}<br><b>#pragma omp for</b><br>for (i=0; i&lt;n; i++) {<br>&nbsp;&nbsp;&nbsp; j = <b>omp_get_thread_num</b>();<br>&nbsp;&nbsp;&nbsp; printf("thread=%d index=%d\n", j, i);<br>&nbsp;&nbsp;&nbsp; if (a[maxes[j]] &lt; a[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maxes[j] = i;<br>}<br>}<br>i = maxes[0];<br>for (j=1; j&lt;4; j++)<br>&nbsp;&nbsp; if (a[i] &lt; a[maxes[j]])<br>&nbsp;&nbsp;&nbsp;&nbsp; i = maxes[j];<br>return i;<br>}<br><br>int main(int argc, char *argv[]) {<br>int i, test[20] =<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {5,15,82,33,4,87,65,5,8,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9,11,1,22,33,4,9,44,55,8,9};<br>printf("%d threads\n", <b>omp_get_max_threads</b>());<br>i = array_int_max(test,20);<br>printf("index=%d max=%d\n", i, test[i]);<br>return 0;<br>}<br><span style="font-weight: bold;">OUTPUT</span><br>2 threads<br>thread=0 index=0<br>thread=0 index=1<br>thread=0 index=2<br>thread=0 index=3<br>thread=0 index=4<br>thread=2 index=10<br>thread=2 index=11<br>thread=2 index=12<br>thread=2 index=13<br>thread=2 index=14<br>thread=1 index=5<br>thread=1 index=6<br>thread=1 index=7<br>thread=1 index=8<br>thread=1 index=9<br>thread=3 index=15<br>thread=3 index=16<br>thread=3 index=17<br>thread=3 index=18<br>thread=3 index=19<br>index=5 max=87<br><hr style="width: 1019px; height: 2px;"><br><div style="text-align: center;"><span style="font-weight: bold;">Parallel Max Function</span><br></div>#include "omp.h"<br>#include &lt;stdio.h&gt;<br><br>int array_int_max(int a[], int n) {<br>int maxes[2], i, j;<br>for (j = 0; j &lt; 2; j++) maxes[j] = 0;<br><b>#pragma omp parallel sections shared(maxes,a) \</b><b><br></b><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; firstprivate(n) private(i,j) num_threads(2)</b><br>{<br><b>#pragma omp section</b><br>&nbsp;&nbsp;&nbsp; for (i = 0; i &lt; n/2; i++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j = <b>omp_get_thread_num</b>();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("thread=%d index=%d\n", j, i);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (a[maxes[j]] &lt; a[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maxes[j] = i;<br>&nbsp;&nbsp;&nbsp; }<br><b>#pragma omp section</b><br>&nbsp;&nbsp;&nbsp; for (i = n/2+1; i &lt; n; i++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j = <b>omp_get_thread_num</b>();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("thread=%d index=%d\n", j, i);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (a[maxes[j]] &lt; a[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maxes[j] = i;<br>&nbsp;&nbsp;&nbsp; }<br>}<br>i = maxes[0];<br>for (j = 1; j &lt; 2; j++)<br>&nbsp;&nbsp; if (a[i] &lt; a[maxes[j]])<br>&nbsp;&nbsp;&nbsp;&nbsp; i = maxes[j];<br>return i;<br>}<br><br>int main(int argc, char *argv[]) {<br>int i, test[20] = {5,15,82,33,4,87,65,5,8,9,11,1,22,33,4,9,44,55,8,9};<br>printf("%d threads\n", <b>omp_get_max_threads</b>());<br>i = array_int_max(test,20);<br>printf("index=%d max=%d\n", i, test[i]);<br>return 0;<br>}<br><br><span style="font-weight: bold;">OUTPUT</span><br>2 threads<br>thread=0 index=0<br>thread=0 index=1<br>thread=0 index=2<br>thread=0 index=3<br>thread=0 index=4<br>thread=0 index=5<br>thread=0 index=6<br>thread=0 index=7<br>thread=0 index=8<br>thread=0 index=9<br>thread=1 index=11<br>thread=1 index=12<br>thread=1 index=13<br>thread=1 index=14<br>thread=1 index=15<br>thread=1 index=16<br>thread=1 index=17<br>thread=1 index=18<br>thread=1 index=19<br>index=5 max=87<br><hr style="width: 1019px; height: 2px;"><h3>OMP simd</h3><p><meta charset="utf-8"></p><pre style="color: rgb(0, 0, 0); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: start;">char foo(char *A, int n) {
  int i;
  char x = 0;
<b>#pragma omp simd reduction(+:x)</b> 
  for (i = 0; i &lt; n; i++) {
    x = x + A[i];
  }
  return x;
}<br></pre><pre style="color: rgb(0, 0, 0); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: start;"><b>#pragma omp declare simd simdlen(16) aligned(a:16, b:16, off:16)<br></b>float work(float *a, float *b, int i, int off)<br>{<br> return a[i + off] * b[i];<br>}</pre><hr width="100%" size="2"><h2>OMP Target</h2><p><b>#pragma omp target map(to:b[0:n])) map(to:c,d) map(from:a[0:n])</b><br>{<br><b>#pragma omp parallel for</b><br>&nbsp; for (i=0; i&lt;n; i++) {<br>&nbsp;&nbsp;&nbsp; a[i] = b[i] * c + d;<br>&nbsp; } //for i<br>}<br></p><div align="center"><b>Jacobi Iteration Stencil<br><br><br></b></div>error = 999.0;<br>while ( error &gt; tol &amp;&amp; iter &lt; iter_max ) {<br>&nbsp; error = 0.0;<br><b>#pragma omp parallel</b><br>{<br><b>#pragma omp for reduction(max:error)</b><br>&nbsp; for( int j = 1; j &lt; m-1; j++) {<br>&nbsp;&nbsp;&nbsp; for( int i = 1; i &lt; n-1; i++ ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Anew[j][i] = 0.25 * ( A[j][i+1] + A[j][i-1]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+ A[j-1][i] + A[j+1][i]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
error = fmax( error, fabs(Anew[j][i] - A[j][i]));<br>&nbsp;&nbsp;&nbsp; }&nbsp; //for i<br>&nbsp; } // for j<br><b>#pragma omp barrier</b><br><b>#pragma omp for</b><br>&nbsp; for( int j = 1; j &lt; m-1; j++) {<br>&nbsp;&nbsp;&nbsp; for( int i = 1; i &lt; nm-1; i++ ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A[j][i] = Anew[j][i];<br>&nbsp;&nbsp;&nbsp; } // for i<br>&nbsp; } // for j<br>} // omp parallel<br>&nbsp; if (iter++ % 100 == 0) printf("%5d, %0.6f\n", iter, error);<br>} // while<br><p>The following code illustrates how easy it is to offload the computation to a GPU, even though performance actually decreases.&nbsp; The advantage is that the GPU can be used as a co-processor and need not be idle during a computation.&nbsp; The performance decrease results from poor utilization of the GPU's capabilities (addressed shortly).&nbsp; The barrier synchronization directive is not needed due to the execution semantics of GPU kernels.<br></p>error = 999.0;<br>
while ( error &gt; tol &amp;&amp; iter &lt; iter_max ) {<br>
&nbsp; error = 0.0;<br>
<b>#pragma omp target map(alloc:Anew[:m+2][:n+2]) \<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map(tofrom:A[:m+2][:n+2])</b><br>
{<br>
<b>#pragma omp parallel for reduction(max:error)</b><br>
&nbsp; for( int j = 1; j &lt; m-1; j++) {<br>
&nbsp;&nbsp;&nbsp; for( int i = 1; i &lt; n-1; i++ ) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Anew[j][i] = 0.25 * ( A[j][i+1] + A[j][i-1]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+ A[j-1][i] + A[j+1][i]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
error = fmax( error, fabs(Anew[j][i] - A[j][i]));<br>
&nbsp;&nbsp;&nbsp; }&nbsp; //for i<br>
&nbsp; } // for j<br>
<b>#pragma omp parallel for</b><br>
&nbsp; for( int j = 1; j &lt; m-1; j++) {<br>
&nbsp;&nbsp;&nbsp; for( int i = 1; i &lt; nm-1; i++ ) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A[j][i] = Anew[j][i];<br>
&nbsp;&nbsp;&nbsp; } // for i<br>
&nbsp; } // for j<br>
} // omp target<br>
&nbsp; if (iter++ % 100 == 0) printf("%5d, %0.6f\n", iter, error);<br>
} // while<div align="center"><b>OpenMP Teams<br><br></b></div>error = 999.0;<br><b>#pragma omp target data map(alloc:Anew) map(A)</b><br>

while ( error &gt; tol &amp;&amp; iter &lt; iter_max ) {<br>

&nbsp; error = 0.0;<br>

<b>#pragma omp target teams distribute parallel for \ <br>&nbsp; reduction(max:error) collapse(2) schedule(static,1)</b><b></b><br>

&nbsp; for( int j = 1; j &lt; m-1; j++) {<br>

&nbsp;&nbsp;&nbsp; for( int i = 1; i &lt; n-1; i++ ) {<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Anew[j][i] = 0.25 * ( A[j][i+1] + A[j][i-1]<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+ A[j-1][i] + A[j+1][i]);<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
error = fmax( error, fabs(Anew[j][i] - A[j][i]));<br>

&nbsp;&nbsp;&nbsp; }&nbsp; //for i<br>

&nbsp; } // for j<br>

<b>#pragma omp target teams distribute parallel for \ <br>
&nbsp; reduction(max:error) collapse(2) schedule(static,1)</b><br>

&nbsp; for( int j = 1; j &lt; m-1; j++) {<br>

&nbsp;&nbsp;&nbsp; for( int i = 1; i &lt; nm-1; i++ ) {<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A[j][i] = Anew[j][i];<br>

&nbsp;&nbsp;&nbsp; } // for i<br>

&nbsp; } // for j<br>

&nbsp; if (iter++ % 100 == 0) printf("%5d, %0.6f\n", iter, error);<br>

} // while</div><p>
      </p><div style="margin-left: 40px;"><hr width="100%" size="2" align="center">
        <p align="center"></p>
          <div style="text-align: left;"><p align="center"></p>
          <h1 align="center"><a name="r51"></a>CHAPTER FIVE<br>CONCURRENT PROGRAMMING </h1><center>
          </center><hr style="width: 100%; height: 2px;">
          <p></p><p align="center"></p>
          
          <p align="center"></p>
          <div style="text-align: center;"><span style="font-weight:
              bold;">Two Threads with No Concurrency Control</span><br>
          </div>
          #include &lt;stdio.h&gt;<br>
          #include &lt;pthread.h&gt;<br>
          #include &lt;assert.h&gt;<br>
          #include &lt;unistd.h&gt;<br>
          <br>
          void *p(void *arg) {<br>
          int i;<br>
          for (i=0; i&lt;5; i++) {<br>
          &nbsp; printf("X\n");<br>
          &nbsp; sleep(1);<br>
          }<br>
          <b>pthread_exit</b>((void *)99);<br>
          }<br>
          <br>
          int main() {<br>
          pthread_t x;<br>
          void *r;<br>
          int i;<br>
          assert(<b>pthread_create</b>(&amp;x, NULL, p, (void *)34) == 0);<br>
          for (i=0; i&lt;5; i++) {<br>
          &nbsp; printf("Y\n");&nbsp; sleep(1);<br>
          }<br>
          assert(<b>pthread_join</b>(x, &amp;r) == 0);<br>
          return 0;<br>
          } <br>
          <span style="font-weight: bold;">OUTPUT</span><br>
          Y<br>
          X<br>
          Y<br>
          X<br>
          X<br>
          Y<br>
          X<br>
          Y<br>
          X<br>
          Y<br><hr width="100%" size="2"><hr width="100%" size="2">
          <div style="text-align: center;"><span style="font-weight:
              bold;">Two Threads with a Critical Section</span><br>
          </div>
          #include &lt;stdio.h&gt;<br>
          #include &lt;pthread.h&gt;<br>
          #include &lt;assert.h&gt;<br>
          #include &lt;unistd.h&gt;<br>
          <br>
          pthread_mutex_t mu;<br>
          void *p(void *arg) {<br>
          int i;<br>
          assert(<b>pthread_mutex_lock</b>(&amp;mu) == 0);<br>
          for (i=0; i&lt;5; i++) {<br>
          &nbsp; printf("X\n");&nbsp; sleep(1);<br>
          }<br>
          assert(<b>pthread_mutex_unlock</b>(&amp;mu) == 0);<br>
          <b>pthread_exit</b>((void *)99);<br>
          }<br>
          <br>
          int main() {<br>
          pthread_t x;<br>
          void *r;<br>
          int i;<br>
          assert(<b>pthread_mutex_init</b>(&amp;mu /*OUT*/ , NULL) == 0);<br>
          assert(<b>pthread_create</b>(&amp;x, NULL, p, (void *)34) == 0);<br>
          assert(<b>pthread_mutex_lock</b>(&amp;mu) == 0);<br>
          for (i=0; i&lt;5; i++) {<br>
          &nbsp; printf("Y\n");&nbsp; sleep(1);<br>
          }<br>
          assert(<b>pthread_mutex_unlock</b>(&amp;mu) == 0);<br>
          assert(<b>pthread_join</b>(x, &amp;r) == 0);<br>
          assert(<b>pthread_mutex_destroy</b>(&amp;mu) == 0);<br>
          return 0;<br>
          }<br>
          <span style="font-weight: bold;">OUTPUT</span><br>
          Y<br>
          Y<br>
          Y<br>
          Y<br>
          Y<br>
          X<br>
          X<br>
          X<br>
          X<br>
          X<br><hr style="width: 100%; height: 2px;">
          <p></p><hr width="100%" size="2">
          <div align="center"><b>Critical Section with Two Threads</b><br>
          </div>
          #include &lt;stdio.h&gt;<br>
          #include &lt;pthread.h&gt;<br>
          #include &lt;assert.h&gt;<br>
          #include &lt;unistd.h&gt;<br>
          #include &lt;semaphore.h&gt;<br>
          <br>
          sem_t *cs;<br>
          <br>
          void *p(void *arg) {<br>
          int i;<br>
          assert( <b>sem_wait</b>(cs)==0 );<br>
          for (i=0; i&lt;5; i++) {<br>
          &nbsp; printf("X\n"); sleep(1);<br>
          }<br>
          assert( <b>sem_post</b>(cs)==0 );<br>
          <b>pthread_exit</b>((void *)99);<br>
          }<br>
          <br>
          int main() {<br>
          pthread_t x;<br>
          void *r;<br>
          int i;<br>
          cs = <b>sem_open</b>("foobar", O_CREAT, 0700, 1);<br>
          assert(<b>pthread_create</b>(&amp;x, NULL, p, (void *)34) == 0);<br>
          assert( <b>sem_wait</b>(cs)==0 );<br>
          for (i=0; i&lt;5; i++) {<br>
          &nbsp; printf("Y\n"); sleep(1);<br>
          }<br>
          assert( <b>sem_post</b>(cs)==0 );<br>
          assert(<b>pthread_join</b>(x, &amp;r) == 0);<br>
          assert( <b>sem_close</b>(cs)==0 );<br>
          return 0;<br>
          }<br>
          <span style="font-weight: bold;">OUTPUT</span><br>
          Y<br>
          Y<br>
          Y<br>
          Y<br>
          Y<br>
          X<br>
          X<br>
          X<br>
          X<br>
          X<br>
          <hr width="100%" size="2">
          <p></p><hr style="width: 100%; height: 2px;">
          <p></p>
          <p align="center"><b>A Thread Synchronization Graph</b> </p>
          <center>&nbsp;G = ( V = {a,b,c,d,e} ,<br>
            E = { (a-&gt;b), (b-&gt;c), (b-&gt;d), (c-&gt;e), (d-&gt;e)} )
            <br>
            <img alt="" src="abc.gif" width="280" height="353"> </center>
          thread <u>a</u> must execute before thread <u> b</u>;<br>
          thread <u>b</u> must execute before thread <u> c</u>;<br>
          thread <u> b</u> must execute before thread <u> d</u>;<br>
          thread <u>c</u> must execute before thread <u> e</u>;<br>
          thread <u>d</u> must execute before thread <u> e</u>. <br>
          <br>
          sem_t ab, bc, bd, ce, de; <br>
          <br>
          THREAD pa()&nbsp;&nbsp;&nbsp;&nbsp; THREAD
          pb()&nbsp;&nbsp;&nbsp;&nbsp; THREAD pc()<br>
          {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          {<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          <b>sem_wait</b>(&amp;ab);&nbsp;&nbsp;&nbsp;<b>sem_wait</b>(&amp;bc); <br>
          . . . . .
          .&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          . . . . .
          .&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          . . . . . . <br>
<b>sem_post</b>(&amp;ab);&nbsp;&nbsp;&nbsp;&nbsp;<b>sem_post</b>(&amp;bc);&nbsp;&nbsp;&nbsp;<b>sem_post</b>(&amp;ce);<br>
          }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          <b>sem_post</b>(&amp;bd);&nbsp;&nbsp;&nbsp; }<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          }<br>
          <br>
          THREAD pd()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; THREAD pe()<br>
          {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          {<br>
          <b>sem_wait</b>(&amp;bd);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>sem_wait</b>(&amp;ce);<br>
          . . . . .
          .&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          <b>sem_wait</b>(&amp;de);<br>
          <b>sem_post</b>(&amp;de);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          . . . . . .<br>
          }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          }<br>
          <br>
          <b>sem_init</b>(&amp;ab, 0, 0); <b>sem_init</b>(&amp;bc, 0, 0);
          <b>sem_init</b>(&amp;bd, 0, 0);<br>
          <b>sem_init</b>(&amp;ce, 0, 0); <b>sem_init</b>(&amp;de, 0, 0);<br><hr style="width: 100%; height: 2px;">
          <p></p>
          <div style="text-align: center;"><span style="font-weight:
              bold;">Resource Counting Semaphores</span><br>
          </div>
          #include &lt;semaphore.h&gt;<br>
          const int N=25; <br>
          <br>
          int Allocate();&nbsp; /* Returns index of free tape drive */<br>
          void Free(int driveNo); /* Frees a tape drive */ <br>
          <br>
          sem_t&nbsp; sem, tCounter;<br>
          <b> int Allocate() {</b><br>
          <b>sem_wait</b>(&amp;tCounter); /* wait for free tape drive */<br>
          <b>sem_wait</b>(&amp;sem);&nbsp; /* get critical section */&nbsp;<br>
          /***ALLOCATE A TAPE DRIVE***/&nbsp;<br>
          <b>sem_post</b>(&amp;sem); /* release critical section */&nbsp;<br>
          return /***SELECTED DRIVE NUMBER***/<br>
          }<br>
          <br>
          <b> void Free(int driveNo) {</b><br>
          <b>sem_wait</b>(&amp;sem);&nbsp; /* get critical section */<br>
          /***FREE THE TAPE DRIVE***/<br>
          <b>sem_post</b>(&amp;sem); /* release critical section */<br>
          <b>sem_post</b>(&amp;tCounter); /* wake up waiting */<br>
          }<br>
          <br>
          <b> void TapeAllocatorInitialize()</b><br>
          {<br>
          &nbsp;/***INITIALIZE DRIVE ALLOCATION<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          DATA STRUCTURES***/<br>
          &nbsp;<b>sem_init</b>(&amp;tCounter, 0, N);<br>
          &nbsp;<b>sem_init</b>(&amp;sem, 0, 1);<br>
          }<br><hr width="100%" size="2">
          <p></p><hr>
          <div align="center"><b>Circular Queue Monitor Implementation</b><br>
          </div>
          <pre>#define QSIZE 10<br><br>pthread_cond_t full,/* count == QSIZE */<br>              empty;/* count == 0 */<br>pthread_mutex_t m;  /* critical section */<br>unsigned int iBuf,  /* tail of circular Q*/<br>             oBuf;  /* head of circular Q*/<br>int count;          /* count characters */<br>char buf [QSIZE];   /* the circular Q */<br><br> /* add "ch"; wait if full */<br>void Put(char ch) {<br><b>pthread_mutex_lock</b>(&amp;m);<br>while (count &gt;= QSIZE) /* empty slot? */<br>  <b>pthread_cond_wait</b>(&amp;full, &amp;m);<br>buf[iBuf] = ch;     /* store ch in Q */<br>iBuf = (iBuf+1) % QSIZE;<br>count++;<br>if (count == 1) /* new ch available */<br>  <b>pthread_cond_signal</b>(&amp;empty);<br><b>pthread_mutex_unlock</b>(&amp;m);<br>}<br><br>/* remove "ch" from Q; wait if empty */<br>char Get() { <br>char ch;<br><b>pthread_mutex_lock</b>(&amp;m);<br>while (count &lt;= 0) /* is a ch present? */<br>  <b>pthread_cond_wait</b>(&amp;empty, &amp;m);<br>ch = buf[oBuf]; /* get ch at head of Q */<br>oBuf = (oBuf+1) % QSIZE;<br>count--;<br>if (count == QSIZE-1) /* signal free */<br>  <b>pthread_cond_signal</b>(&amp;full);<br><b>pthread_mutex_unlock</b>(&amp;m);<br>return ch;<br>}<br><br>int main() {<br>oBuf = 0; iBuf = 0; count=0; /* set empty */<br><b>pthread_cond_init</b>(&amp;full, NULL);<br><b>pthread_cond_init</b>(&amp;empty, NULL);<br><b>pthread_mutex_init</b>(&amp;m, NULL);<br>/** Insert test code with several threads **/<br>return 0;<br>}<br></pre>
          <hr><p></p><hr style="width: 100%; height: 2px;">
          <p align="center"><b>OpenMP Conditional Testing Within Monitors</b> </p>
          <p style="text-align: left;"><meta charset="utf-8"><br>#include &lt;omp.h&gt;<br>void something_useful ( void );<br>void something_critical ( void );<br>void foo ( omp_lock_t * lock, int n )<br>{<br>&nbsp;int i;<br>&nbsp;for ( i = 0; i &lt; n; i++ )<br>&nbsp;<b>#pragma omp task</b><br>&nbsp;{<br>&nbsp;&nbsp; something_useful();<br>&nbsp;&nbsp; while ( !<b>omp_test_lock</b>(lock) ) {<br>&nbsp;&nbsp;&nbsp;&nbsp; <b>#pragma omp taskyield</b><br>&nbsp;&nbsp; }<br>&nbsp;something_critical();<br><b>&nbsp;omp_unset_lock</b>(lock);<br>&nbsp;}<br>}<br></p><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; width: 524px; height: 2px;"><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: center;"><span style="font-weight: bold;">BARRIER EXAMPLE</span><br></div><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#include "omp.h"</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#include &lt;stdio.h&gt;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#include &lt;stdlib.h&gt;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#include &lt;time.h&gt;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">int main(int argc, char *argv[]) {</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">int result1=0;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">int result2=0;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#pragma omp parallel num_threads(5)</span></b><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">{</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">if (<b>omp_get_thread_num</b>() != 0) {</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; sleep(rand()%5);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; result2 = 3;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">}</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">printf("thread %d at barrier at %ld\n",</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp; <b>omp_get_thread_num</b>(), clock());</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#pragma omp barrier</span></b><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#pragma master</span></b><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; result1 = result2;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">} //omp parallel</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">printf("Barrier %s\n",</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; (result1 == 3)?"passed":"failed");</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">return 0;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">}</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold;">OUTPUT</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">thread 0 at barrier at 2693</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">thread 2 at barrier at 2855</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">thread 4 at barrier at 2974</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">thread 3 at barrier at 2974</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">thread 1 at barrier at 3156</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: -webkit-left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">Barrier passed</span><div style="text-align: center;"><div style="text-align: left;"><hr style="width: 100%; height: 2px;"></div>
            <b>One Implementation of Message Passing</b></div>
          <h4> </h4>
          // MODULE SharedResource <br>
          typedef struct Port { <br>
          MessageType message; /* from the argument list */ <br>
          ResultType
          result;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /*
          result of the operation */ <br>
          pthread_mutex_t critical; /* serializes port access */ <br>
          sem_t
          sender,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          /* private sem for sender */ <br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          receiver;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          /* private sem for receiver */ <br>
          }; /* Port */<br>
          <br>
          TheSharedResource hereIam;<br>
          Port serverPort;<br>
          <br>
          /* a stub exists for every port */<br>
          ResultType InterfaceStubToTheOutsideWorld(MessageType m) {<br>
          ResultType r;<br>
          /* enter critical section */<br>
          <b>pthread_mutex_lock</b>(&amp;port.critical); <br>
          /* copy argument list to the port */<br>
          port.message = m;<br>
          /* wake server; delay proxy */<br>
          <b>sem_post</b>(&amp;port.receiver);<br>
          <b>sem_wait</b>(&amp;port.sender);<br>
          /* copy result */<br>
          r = port.result; <br>
          <b>pthread_mutex_unlock</b>(&amp;port.critical);&nbsp; /* exit
          critical section */<br>
          return r;<br>
          }<br>
          <br>
          /* only Admin can touch the shared resource */<br>
          void *Administrator(void *arg) {<br>
          for (;;) {<br>
          /* delay until message arrives */<br>
          <b>sem_wait</b>(&amp;port.receiver); <br>
          /***ACCESS RESOURCE PER port.message***/;<br>
          /***STORE RESULT IN port.result***/<br>
          <b>sem_post</b>(&amp;port.sender); /* wake sender */<br>
          <br>
          } /* for */<br>
          }<br>
          <br>
          int main() {<br>
          <b>pthread_mutex_init</b>(&amp;port.critical, NULL);<br>
          <b>sem_init</b>(&amp;port.sender, 0,0);<br>
          <b>sem_init</b>(&amp;port.receiver, 0,0);<br>
          <b>pthread_create</b>(.... Administrator, NULL);<br>
          }<br>
          <hr style="width: 100%; height: 2px;"><div align="left"> </div><hr><mbp:section></mbp:section>
          <center>
            <h1><a name="r61"></a>CHAPTER SIX<br>PARALLEL ALGORITHMS</h1><p align="left"><meta charset="utf-8"></p><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><div align="left"><div align="center"><div align="left"><div align="center"><div align="left"><div align="center"><b>Spatial Locality Matrix Multiply Solution</b><span class="Apple-converted-space">&nbsp;</span>(N=1024)<br><div align="left">void mul2() {<br><b>#pragma omp parallel</b><br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; int i, j, k;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; int yy[N];<br><b>#pragma omp for</b><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (i = 0; i &lt; N; i++) {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (k = 0; k &lt; N; k++)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; yy[k] = y[k][i]; //copy row k column i of y<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (j = 0; j &lt; N; j++) { //row j of x<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; int sum = 0;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (k = 0; k &lt; N; k++)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sum += x[j][k] * yy[k];<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; z[j][i] = sum;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } //for j<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } //for i<br>&nbsp;&nbsp;&nbsp; }<br>}<br><br><div align="center"><b>Sparse Matrix</b><br></div><h3>Gaussian Elimination</h3><p>void gauss() {<br>for (int i = 0; i &lt; N-1; i++) {<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int j = i+1; j &lt; N; j++) {<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float ratio = A[j][i]/A[i][i];&nbsp;&nbsp; //ratio to multiply pivot row<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int k = i; k &lt; N; k++) {<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A[j][k] -= (ratio*A[i][k]);&nbsp; //and subtract<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for k<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b[j] -= (ratio*b[i]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for j<br>} //for i<br>}</p><p align="center"><br></p><h4>Example</h4>.729x&nbsp;&nbsp; +&nbsp;&nbsp; .81y +&nbsp;&nbsp; .9z = .6867<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x&nbsp;&nbsp; +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; z = .8338<br>1.331x + 1.21y + 1.1z = 1.0<br><br>.7290&nbsp; .8100&nbsp; .9000 | .6867<br>1.000&nbsp; 1.000&nbsp; 1.000 | .8338<br>1.331&nbsp; 1.210&nbsp; 1.100 | 1.000<br><blockquote>multiply row 0 by A[i,0]/A[0,0]&nbsp; Transform 2<br>subtract row 0 from row i &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Transform 3<br></blockquote>.7290&nbsp; .8100&nbsp; .9000&nbsp; |&nbsp;&nbsp; .6867<br>0.000&nbsp;&nbsp; -.111&nbsp;&nbsp; -.235&nbsp; | -.1084<br>0.000&nbsp;&nbsp; -.269&nbsp;&nbsp; -.543&nbsp; | -.2540<br><blockquote>multiply row 1 by A[i,1]/A[1,1]&nbsp; Transform 2<br>subtract row 1 from row i &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Transform 3<br></blockquote>.7290&nbsp; .8100&nbsp; .9000&nbsp; |&nbsp;&nbsp; .6867<br>0.000&nbsp;&nbsp; -.111&nbsp;&nbsp; -.235&nbsp; | -.1084<br>0.000&nbsp;&nbsp; 0.00 &nbsp; .0264&nbsp; |&nbsp;&nbsp; .0087<br><br>.0264z = .0087&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Back substitution<br>z&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = .3295<br><br>-.111y + -.235*.3295 = -.1084<br>y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = .2790<br><br>.7290x + .81*.279 +.9*.3295 = .6867<br>x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = .2252<br><br><div align="center"><b>Linear Solver with Partial Pivoting of Rows</b><br><div align="left">#define N 3<br>float A[N][N] = {{.7290, .8100, .9000},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {1.000, 1.000, 1.000},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {1.331, 1.210, 1.100}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };<br><br>float b[N] = {.6867, .8338, 1.000};<br>float sol[N] = {.2245, .2814, .3279};<br>int rows=0;<br><br>void gauss2() {<br>int i;<br>for (i = 0; i &lt; N-1; i++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float max;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int maxi = i, m;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (m = i+1; m &lt; N; m++) { //maximum in column i<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float v = fabsf(A[m][i]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (v &gt; max) {max = v;&nbsp; maxi = m;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (maxi != i) {rows++;&nbsp;&nbsp; //swap rows i and maxi, and b elements<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float temp[N];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memcpy(temp, &amp;A[i][i], sizeof(float)*(N-i));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memcpy(&amp;A[i][i], &amp;A[maxi][i], sizeof(float)*(N-i));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memcpy(&amp;A[maxi][i], temp, sizeof(float)*(N-i));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; max = b[i];&nbsp; b[i] = b[maxi];&nbsp; b[maxi] = max;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float f = 1.0/A[i][i];&nbsp; //multiply is faster than divide<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int j;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (j = i+1; j &lt; N; j++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float ratio = A[j][i]*f;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int k;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (k = i; k &lt; N; k++) {<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A[j][k] -= ratio*A[i][k];<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for k<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b[j] -= ratio*b[i];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for j<br>} //for i<br>}<br><br>void gen() {<br>&nbsp; for (int i = 0; i &lt; N; i++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float sum = 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int j = 0; j &lt; N; j++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A[i][j] = rand()*10./RAND_MAX-5.0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sum += .01*A[i][j];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b[i] = sum;<br>&nbsp; }<br>}<br><br>float check() {<br>&nbsp; float max = -1;<br>&nbsp; for (int i = 0; i &lt; N; i++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float sum = 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int j = 0; j &lt; N; j++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sum += .01*A[i][j];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float v = fabsf(b[i]-sum);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (v &gt; max) max = v;<br>&nbsp; }<br>&nbsp; return max;<br>}<br><br>void printA() {<br>&nbsp; for (int i = 0; i &lt; N; i++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int j = 0; j &lt; N; j++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%8.4g ", A[i][j]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%8.4g\n", b[i]);<br>&nbsp; }<br>&nbsp; printf("\n");<br>}<br></div></div><h5>OpenMP</h5></div></div></div></div></div></div></div></div><p style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">void gauss4() {<br>int i, perm[N];&nbsp;&nbsp; //row permutation vector<br>for (i = 0; i &lt; N; i++) perm[i] = i;<br>for (i = 0; i &lt; N-1; i++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float max = -1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int maxi = i, m;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (m = i; m &lt; N; m++) {&nbsp; //maximum column element<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float v = fabsf(A[perm[m]][i]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (v &gt; max) {max = v;&nbsp; maxi = m;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (maxi != i) {rows++;&nbsp; //swap row indices<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m = perm[maxi];&nbsp; perm[maxi] = perm[i];&nbsp; perm[i] = m;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int permi = perm[i], j;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float bpermi = b[permi], f = 1.0/A[permi][i];<br><b>#pragma omp parallel for firstprivate(i, permi, f, bpermi)</b><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (j = i+1; j &lt; N; j++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int permj = perm[j], k;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float ratio = A[permj][i]*f;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b[permj] -= ratio*bpermi;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (k = i; k &lt; N; k++) {<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A[permj][k] -= ratio*A[permi][k];<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for k<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for j<br>} //for i<br>}<br></p><p style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">//even elements hold maximum value found in thread t<br>//odd elements hold row index of maximum value<br>float values[200];<br><br>void gauss5() {<br>int i, oldmaxi=0, maxi=0, m;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float max = -1;<br>//the first column's max is not found<br>//because the algorithm finds the max for column i+1<br>//therefore code here swap rows for column 0, if needed<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (m = 1; m &lt; N; m++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float v = fabsf(A[m][0]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (v &gt; max) {max = v;&nbsp; maxi = m;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (maxi != 0) {rows++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float temp[N];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memcpy(temp, &amp;A[0][0], sizeof(float)*(N));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memcpy(&amp;A[0][0], &amp;A[maxi][0], sizeof(float)*(N));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memcpy(&amp;A[maxi][0], temp, sizeof(float)*(N));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; max = b[0];&nbsp; b[0] = b[maxi];&nbsp; b[maxi] = max;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>for (i = 0; i &lt; N-1; i++) { //oldmaxi indexes row that was swapped<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; max = -1;&nbsp;&nbsp;&nbsp; maxi = i+1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float f = 1.0f/A[i][i];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int j, num;<br>//pragmas are separated either to initialize each thread<br>//or to insert code to be executed after the for-loop<br><b>#pragma omp parallel firstprivate(f, i, max, maxi, oldmaxi) shared(num)</b><br>{<br><b>#pragma omp for</b><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (j = i+1; j &lt; N; j++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (j != oldmaxi) {&nbsp; //swapped row was already processed<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int k;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float ratio = A[j][i]*f;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b[j] -= (ratio*b[i]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (k = i; k &lt; N; k++) {<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A[j][k] -= (ratio*A[i][k]);<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for k<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float v = fabsf(A[j][i+1]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (v &gt; max) {max = v;&nbsp; maxi = j;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for j<br>//ifdef is used so that code works even if OpenMP is not enabled<br>#ifdef _OPENMP //<b>Reduction Pattern</b>, save local max<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int n = omp_get_thread_num()*2;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; values[n] = max;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; values[n+1] = maxi;<br><b>#pragma omp master</b> //save number of threads (maximums)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; num = <b>omp_get_num_threads</b>()*2;<br>} //omp master<br>#endif<br>} //omp parallel<br>//reduce num maximums to 1<br>#ifdef _OPENMP&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (j=0; j&lt;num; j+=2)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (values[j] &gt; max) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; max = values[j];&nbsp; maxi = values[j+1];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>#endif<br>//interchange rows maxi and i+1<br>//copy maxi to i+1<br>//copy transformed i+1 to maxi<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldmaxi = maxi;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (maxi != i+1) {rows++;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int k;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float ratio = A[i+1][i+1]/A[maxi][i+1], t;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (k = i+1; k &lt; N; k++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; t = A[maxi][k];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A[maxi][k] = A[i+1][k]-(ratio*A[maxi][k]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A[i+1][k] = t;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for k<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; t = b[maxi];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b[maxi] = b[i+1]-(ratio*b[maxi]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b[i+1] = t;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //if maxi<br>} //for i<br>}<br></p><h3 style="color: rgb(0, 0, 0); font-family: Times; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">User-defined Reductions<br></h3><pre style="color: rgb(0, 0, 0); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: start;">#define abs(x)   (x&lt;0 ? -x : x)
#define N        1000000
int data[N];

// return the smallest magnitude among all the integers in data[N]
int find_min_abs()
{
  int i;
  int result = LARGENUM;

  <b>#pragma omp declare reduction(minabs : int :              \
    omp_out = abs(omp_in) &gt; omp_out ? omp_out : abs(omp_in)) \
    initializer (omp_priv=MAX_INT)</b>

  <b>#pragma omp parallel for reduction(minabs:result)</b>
  for (i=0; i&lt;N; i++) {
    if (abs(data[i]) &lt; result) {
      result = abs(data[i]);
    }
  }
  return result;
}<br></pre><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>Order 8 Stencil Calculation</b><span class="Apple-converted-space">&nbsp;</span>for next[offset]<br></div><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div align="left"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#define HALF_LENGTH (8/2)</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">float value += previous[offset] * c[0];</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">int ir;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">for (ir = 1; ir &lt;= HALF_LENGTH; ir++) {</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; value += c[ir] * (previous[offset + ir] + previous[offset - ir]);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; value += c[ir] * (previous[offset + ir*n1] + previous[offset - ir*n1]);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; value += c[ir] * (previous[offset + ir*n1*n2] + previous[offset - ir*n1*n2]);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">}</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">next[offset] = 2.0f * previous[offset] - next[offset] + value*velocity[offset];</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"></div><h4 style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Ghost Cell Pattern</h4><p style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">// naive and slow implementation<br>void base_case(float next[], float prev[], const float c[], const float velocity[],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const int n1, const int n2, const int n3, const int half_length) {<br>&nbsp; int n1n2 = n1*n2;<br>&nbsp; int ix, iy, iz, ir;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; for (iz = 0; iz &lt; n3; iz++) {<br>&nbsp;&nbsp;&nbsp; for (iy = 0; iy &lt; n2; iy++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (ix = 0; ix &lt; n1; ix++) {<br>&nbsp;&nbsp;&nbsp; &nbsp; if ( ix &gt;= half_length &amp;&amp; ix &lt; (n1-half_length) &amp;&amp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iy &gt;= half_length &amp;&amp; iy &lt; (n2-half_length) &amp;&amp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iz &gt;= half_length &amp;&amp; iz &lt; (n3-half_length) ) {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; float res = prev[iz*n1n2 + iy*n1 + ix] * c[0];<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (ir = 1; ir &lt;= half_length; ir++) {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; res += c[ir] * (prev[iz*n1n2 + iy*n1 + ix + ir] +<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prev[iz*n1n2 + iy*n1 + ix - ir]); // horizontal<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; res += c[ir] * (prev[iz*n1n2 + iy*n1 + ix + ir*n1] +<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prev[iz*n1n2 + iy*n1 + ix - ir*n1]); // vertical<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; res += c[ir] * (prev[iz*n1n2 + iy*n1 + ix+ir * n1*n2] +<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prev[iz*n1n2 + iy*n1 + ix - ir*n1*n2]); // in front / behind<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } //for ir<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; next[iz*n1n2 + iy*n1 + ix] = 2.0f* prev[iz*n1n2 + iy*n1 + ix] -<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; next[iz*n1n2 + iy*n1 + ix] +<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; res * velocity[iz*n1n2 + iy*n1 + ix];<br>&nbsp;&nbsp;&nbsp;&nbsp; } //if ix<br>&nbsp;&nbsp;&nbsp;&nbsp; } //for ix<br>&nbsp;&nbsp; } //for iy<br>&nbsp;} //for iz<br>}<br></p><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>Acoustic Wave Finite Difference Final Version</b><br></div><p style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">void fd3d(float next[], float prev[], const float c[], const float velocity[],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const int n1, const int n2, const int n3) {<br><b>#pragma omp parallel shared(next, prev, coeff, vel) firstprivate(n1,n2,n3)</b><br>{<br>&nbsp; int n1n2 = n1*n2;<br>&nbsp; int n1mhalf = n1-HALF_LENGTH;<br>&nbsp; int n2mhalf = n2-HALF_LENGTH;<br>&nbsp; int n3mhalf = n3-HALF_LENGTH;<br>&nbsp; int ix, iy, iz;<br><b>#pragma omp for</b><br>&nbsp; for (iz = HALF_LENGTH; iz &lt; n3mhalf; iz++) {<br>&nbsp;&nbsp;&nbsp; for (iy = HALF_LENGTH; iy &lt; n2mhalf; iy++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int index = iz*n1n2 + iy*n1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float r[512];&nbsp;&nbsp;&nbsp; //must be &gt;= n1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (ix = HALF_LENGTH; ix &lt; n1mhalf; ix++) {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; r[ix] = prev[ix + index] * c[0];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int ir;<br>&nbsp;&nbsp;&nbsp; &nbsp; for(ir = 1; ir &lt;= HALF_LENGTH; ir++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index = iz*n1n2 + iy*n1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int b = ir*n1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int d = ir*n1*n2;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(ix = HALF_LENGTH; ix &lt; n1mhalf; ix++) {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; r[ix] += c[ir] * (prev[ix + index + ir] +<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prev[ix + index - ir]+ // horizontal<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prev[ix + index + b] +<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prev[ix + index - b] + // vertical<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prev[ix + index + d] +<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prev[ix + index - d]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for ix<br>&nbsp;&nbsp;&nbsp; &nbsp;} //for ir<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index = iz*n1n2 + iy*n1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(ix = HALF_LENGTH; ix &lt; n1mhalf; ix++) {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; next[ix + index] = 2.0f * prev[ix + index] -<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; next[ix + index] +<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; r[ix] * velocity[ix + index];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for ix<br>&nbsp;&nbsp; } //for iy<br>&nbsp;} //for iz<br>} //pragma<br>}<br></p><div class="ulist" style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div align="center"><b>Simple Task Queue</b><br><div align="left">typedef struct _tq {<br>&nbsp; void **q;<br>&nbsp; int head, tail, N;<br>} TQ;<br>typedef TQ *pTQ;<br><br>pTQ<span class="Apple-converted-space">&nbsp;</span><b>tq_init</b>(int n) {<br>&nbsp; pTQ p = malloc(sizeof(TQ));<br>&nbsp; if (p == NULL) return NULL;<br>&nbsp; p-&gt;q = malloc(sizeof(void*)*n);<br>&nbsp; if (p-&gt;q == NULL) {<br>&nbsp;&nbsp;&nbsp; free(p);<br>&nbsp;&nbsp;&nbsp; return NULL;<br>&nbsp; }<br>&nbsp; p-&gt;N = n;<br>&nbsp; p-&gt;head = 0;<br>&nbsp; p-&gt;tail = 0;<br>&nbsp; return p;<br>}<br><br>void *<b>tq_get</b>(pTQ p) {<br>&nbsp; int i;<br><b>#pragma omp critical tq</b><br>{<br>&nbsp; if (p-&gt;head == p-&gt;tail) v = NULL; //Q empty<br>&nbsp; else {<br>&nbsp;&nbsp;&nbsp; i = p-&gt;head;<br>&nbsp;&nbsp;&nbsp; p-&gt;head = (p-&gt;head+1)%p-&gt;N;<br>&nbsp; }<br>} //pragma<br>&nbsp; return p-&gt;q[i];<br>}<br><br>void<span class="Apple-converted-space">&nbsp;</span><b>tq_put</b>(pTQ p, void *work) {<br>&nbsp; int i;<br><b>#pragma omp critical tq</b><br>{<br>&nbsp; i = p-&gt;tail;<br>&nbsp; p-&gt;tail = (p-&gt;tail+1)%p-&gt;N;<br>}<br>&nbsp; p-&gt;q[i] = work;<br>}<br><div align="center"><b>Parallel Sum</b><br><div align="left">typedef struct _work {<br>&nbsp; int i;<br>} Work;<br><br>int main(void) {<br>&nbsp; pTQ q = tq_init(101);<br>&nbsp; int i, sum=0;<br>&nbsp; Work *w;<br>&nbsp; for (i=1; i&lt;=99; i+=2) {<br>&nbsp;&nbsp;&nbsp; w = malloc(sizeof(Work));<br>&nbsp;&nbsp;&nbsp; w-&gt;i = i;<br>&nbsp;&nbsp;&nbsp; tq_put(q, w);<br>&nbsp; }<br><b>#pragma omp parallel reduction(+:sum)</b><br>{<br>&nbsp; Work *w;<br>&nbsp; for (;;) {<br>&nbsp;&nbsp;&nbsp; w = tq_get(q);<br>&nbsp;&nbsp;&nbsp; if (w == NULL) break;<br>&nbsp;&nbsp;&nbsp; printf("%d %d\n", <b>omp_get_thread_num</b>(), w-&gt;i);<br>&nbsp;&nbsp;&nbsp; sum += w-&gt;i;<br>&nbsp;&nbsp;&nbsp; if (w-&gt;i &amp; 1) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w-&gt;i++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tq_put(q, w); //work items can be reused<br>&nbsp;&nbsp;&nbsp; } else free(w);<br>&nbsp; }<br>}<br>&nbsp; printf("sum=%d\n", sum);<br>&nbsp; return 0;<br>}<br></div></div><br><div align="center"><b>Adaptive Quadrature<br></b><br></div><div align="center"><br></div>#include &lt;stdio.h&gt;<br>#include &lt;math.h&gt;<br>#include &lt;time.h&gt;<br>#ifndef PI<br>#define PI 3.1415926535897<br>#endif<br><br>/* function to integrate */<br>double func(double x) { return x*sin(x); }<br><br>double&nbsp; integral(double (*f)(double),// function to integrate<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; double a,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // left interval boundary<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; double b,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // right interval boundary<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; double tolerance) {&nbsp;&nbsp; // error tolerance<br>&nbsp; double integral_result;&nbsp;&nbsp;&nbsp;&nbsp; // value to return<br>&nbsp; double h;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // interval size<br>&nbsp; double mid;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // center of interval<br>&nbsp; double one_trapezoid_area;&nbsp; // area of one trapezoid<br>&nbsp; double two_trapezoid_area;&nbsp; // area of two trapezoids<br>&nbsp; double left_area;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // integral of left half<br>&nbsp; double right_area;<br>&nbsp; h = b - a;<br>&nbsp; mid = (a+b)/2;<br>&nbsp; one_trapezoid_area = h * (f(a) + f(b)) / 2.0;<br>&nbsp; two_trapezoid_area = h/2 * (f(a) + f(mid)) / 2.0 +<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; h/2 * (f(mid) + f(b)) / 2.0;<br>&nbsp; if (fabs(one_trapezoid_area - two_trapezoid_area)<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt; 3.0 * tolerance)<br>&nbsp;&nbsp;&nbsp; return two_trapezoid_area; // error bound met<br>&nbsp; // error still too large<br><b>#pragma omp task shared(left_area)</b><br>{<br>&nbsp; left_area = integral(f, a, mid, tolerance / 2);<br>}<br><b>#pragma omp task shared(right_area)</b><br>{<br>&nbsp; right_area = integral(f, mid, b, tolerance / 2);<br>}<br><b>#pragma omp taskwait</b><br>&nbsp; return left_area + right_area;<br>}<br><br>int main(int argc,char** argv) {<br>&nbsp; double x_min, x_max;<br>&nbsp; double answer = 0.0;<br>&nbsp; double tm;<br>&nbsp; int i;<br>&nbsp; x_min = 0;<br>&nbsp; x_max = PI;<br>&nbsp; long start = clock();<br>&nbsp; answer = integral(func, x_min, x_max, 0.00000000001);<br>&nbsp; long stop = clock();<br>&nbsp; printf("%gs\n", (float)(stop-start)/CLOCKS_PER_SEC);<br>&nbsp; printf("The integral is approximately %.12f\n", answer);<br>&nbsp; printf("The exact answer is&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; %.12f\n", PI);<br>&nbsp; return 0;<br>}<br><b>OUTPUT<br></b>0.213s<br>The integral is approximately 3.141592653588<br>The exact answer is&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.141592653590<br><p>In the "sum" Task Queue example, the premature termination problem was not addressed.&nbsp; In this example, a global count variable is allocated to keep track of the number of work items.&nbsp; When the count is zero, the solution is completed and all threads can exit.<br></p>typedef struct _work {<br>&nbsp;&nbsp;&nbsp; double a, b, tolerance, *answer;<br>} Work;<br><br>pTQ tq;<br>void&nbsp; integral(double(*f)(double), int *cnt) {<br>&nbsp;&nbsp;&nbsp; double h;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // interval size<br>&nbsp;&nbsp;&nbsp; double mid;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // center of interval<br>&nbsp;&nbsp;&nbsp; double one_trapezoid_area;&nbsp; // area of one trapezoid<br>&nbsp;&nbsp;&nbsp; double two_trapezoid_area;&nbsp; // area of two trapezoids<br>&nbsp;&nbsp;&nbsp; double a, b, tolerance;<br>&nbsp;&nbsp;&nbsp; Work *w;<br>&nbsp;&nbsp;&nbsp; double *answer;<br>&nbsp;&nbsp;&nbsp; for (; *cnt != 0;) {&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>//while Work remains</b><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; w = (Work *)tq_get(tq);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (w == NULL) continue;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; a = w-&gt;a;&nbsp; b = w-&gt;b;&nbsp; tolerance = w-&gt;tolerance;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; printf("%d %d %g %g\n", omp_get_thread_num(), *cnt, a, b);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; h = b - a;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mid = (a + b) / 2;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; one_trapezoid_area = h * (f(a) + f(b)) / 2.0;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; two_trapezoid_area = h / 2 * (f(a) + f(mid)) / 2.0 +<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; h / 2 * (f(mid) + f(b)) / 2.0;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (fabs(one_trapezoid_area - two_trapezoid_area) &lt; 3.0 * tolerance) {<br><b>#pragma omp atomic</b><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *(w-&gt;answer) += two_trapezoid_area; // error bound met<br><b>#pragma omp atomic</b><span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *cnt -= 1;&nbsp; //<b>decrement Work count</b><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; free(w);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; continue;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // error still too large<br><b>#pragma omp atomic</b><span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *cnt += 1;&nbsp;&nbsp; //<b>increment Work count</b><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; w-&gt;a = a;&nbsp; w-&gt;b = mid;&nbsp; w-&gt;tolerance /= 2;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; answer = w-&gt;answer;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; tq_put(tq, w);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Work *w1 = (Work *)malloc(sizeof(Work));<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; w1-&gt;a = mid;&nbsp; w1-&gt;b = b;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; w1-&gt;tolerance = tolerance / 2;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; w1-&gt;answer = answer;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; tq_put(tq, w1);<br>&nbsp;&nbsp;&nbsp; } //for<br>}<br><br>int main(int argc, char** argv) {<br>&nbsp;&nbsp;&nbsp; double x_min, x_max;<br>&nbsp;&nbsp;&nbsp; double answer = 0.0;<br>&nbsp;&nbsp;&nbsp; int cnt = 1; //<b>start Work count at one</b><br>&nbsp;&nbsp;&nbsp; x_min = 0;<br>&nbsp;&nbsp;&nbsp; x_max = PI;<br>&nbsp;&nbsp;&nbsp; tq = tq_init(500);<br>&nbsp;&nbsp;&nbsp; long start = clock();<br>&nbsp;&nbsp;&nbsp; Work *w = (Work *)malloc(sizeof(Work));<br>&nbsp;&nbsp;&nbsp; w-&gt;a = x_min;&nbsp; w-&gt;b = x_max;<br>&nbsp;&nbsp;&nbsp; w-&gt;tolerance = 0.01; //0000000001;<br>&nbsp;&nbsp;&nbsp; w-&gt;answer = &amp;answer;<br>&nbsp;&nbsp;&nbsp; tq_put(tq, (void *)w);<span class="Apple-converted-space">&nbsp;</span><br><b>#pragma omp parallel shared(answer)</b><br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; integral(func, &amp;cnt);<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; long stop = clock();<br>&nbsp;&nbsp;&nbsp; printf("%gs\n", (float)(stop - start) / CLOCKS_PER_SEC);<br>&nbsp;&nbsp;&nbsp; printf("The integral is approximately %.12f\n", answer);<br>&nbsp;&nbsp;&nbsp; printf("The exact answer is&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; %.12f\n", PI);<br>&nbsp;&nbsp;&nbsp; return 0;<br>}<br><b>OUTPUT</b><br>0 1 0 3.14159<br>1 2 0 1.5708<br>3 2 1.5708 3.14159<br>2 3 0.785398 1.5708<br>2 5 0.785398 1.1781<br>0 3 0 0.785398<br>2 4 1.1781 1.5708<br>0 5 0 0.392699<br>2 4 0.392699 0.785398<br>3 4 2.35619 3.14159<br>2 6 0.19635 0.392699<br>1 4 1.5708 2.35619<br>2 6 0.589049 0.785398<br>3 7 0.392699 0.589049<br>2 6 2.74889 3.14159<br>0 5 0 0.19635<br>2 6 1.9635 2.35619<br>1 7 2.35619 2.74889<br>2 6 2.94524 3.14159<br>0 5 2.74889 2.94524<br>2 6 2.15984 2.35619<br>1 7 1.9635 2.15984<br>2 4 2.55254 2.74889<br>3 5 1.5708 1.9635<br>0 5 2.35619 2.55254<br>1 3 1.5708 1.76715<br>2 3 1.76715 1.9635<br>0.009s<br>The integral is approximately 3.138437145005<br>The exact answer is&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.141592653590<br><h2>Sparse Linear Algebra</h2><h3>Compressed Row Storage (CRS)</h3>typedef struct _crs {<br>&nbsp;&nbsp;&nbsp; int nr, nc, nnz;<br>&nbsp;&nbsp;&nbsp; int *ja, *ia;<br>&nbsp;&nbsp;&nbsp; float *data;<br>&nbsp;&nbsp;&nbsp; int nz;<br>} CRS;<br>typedef CRS *pCRS;<br><div align="center"><b>Four Steps to Build a new Matrix</b><br></div><p><br></p>void<span class="Apple-converted-space">&nbsp;</span><b>crs_init</b>(pCRS matrix, int m, int n, int nzEst);<br>#define<span class="Apple-converted-space">&nbsp;</span><b>crs_newrow</b>(m, i) (m)-&gt;ia[i] = (m)-&gt;nnz; //step to the next row<br>void<span class="Apple-converted-space">&nbsp;</span><b>crs_i</b>(pCRS m, int i, int j, float v);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //insert a new element<br>#define<span class="Apple-converted-space">&nbsp;</span><b>crs_idone</b>(m) (m)-&gt;ia[(m)-&gt;nr] = (m)-&gt;nnz;<br><div align="center"><b>Utility Routines</b><br><div align="left">void<span class="Apple-converted-space">&nbsp;</span><b>crs_print</b>(pCRS m);&nbsp; //print 3 arrays of CRS<br>void<span class="Apple-converted-space">&nbsp;</span><b>crs_printf</b>(pCRS m); //print as mxn matrix<br>void<span class="Apple-converted-space">&nbsp;</span><b>crs_copytodense</b>(pCRS m, float *target);<br>void<span class="Apple-converted-space">&nbsp;</span><b>crs_rand</b>(pCRS m, int low, int high, float percentNonzero);<br>void<span class="Apple-converted-space">&nbsp;</span><b>check</b>();&nbsp; //compare a dense to a sparse, print errors<br></div></div><p>When designing a new abstraction (data structure and algorithm), it is important to accommodate testing.&nbsp; The crs_rand routine uses the four building-block methods to fill a sparse matrix to an approximate percentage level with random integers.&nbsp; The crs_copytodense then copies those values to a dense matrix, then the "dumb" dense routine is used to compute a dense result, which is used to validate the sparse result by invoking the "check" code.<br></p><p>Before jumping to large matrix sizes, the results were visually checked by printing both the CRS formats and matrix values for several N=4 and N=10 tests.<b><br></b></p><div align="center"><b>Row-Order Access Routines</b><br></div>#define<span class="Apple-converted-space">&nbsp;</span><b>crs_nrow</b>(m, i) ((m)-&gt;ia[(i)+1]-(m)-&gt;ia[i]) //# data items/row i<br>#define<span class="Apple-converted-space">&nbsp;</span><b>crs_colindex</b>(m, i) ((m)-&gt;ia[i]) //first column index for row i<br>#define<span class="Apple-converted-space">&nbsp;</span><b>crs_col</b>(m, j) ((m)-&gt;ja[j])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //get column index<br>#define<span class="Apple-converted-space">&nbsp;</span><b>crs_data</b>(m, j) ((m)-&gt;data[j])&nbsp;&nbsp; //get data value<br><p>The final CRS routine crs_g accesses a matrix element at an arbitrary i,j position.&nbsp; Since the column indices are stored in ascending order and since we know the number of entries per row, a binary search can be utilized to find a match.&nbsp; The code performs a check on each iteration to make sure that the column index is represented in the remaining list items.<br></p><div align="center"><b>Arbitrary Element Access</b><br></div>float<span class="Apple-converted-space">&nbsp;</span><b>crs_g</b>(pCRS m, int i, int j) {<br>&nbsp;&nbsp;&nbsp; int x = m-&gt;ia[i];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //starting column index<br>&nbsp;&nbsp;&nbsp; int y = m-&gt;ia[i + 1] - x, n; //number of indices<br>&nbsp;&nbsp;&nbsp; while (y &gt; 0) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //binary search<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (j &lt; m-&gt;ja[x] || j &gt; m-&gt;ja[x + y - 1]) return 0.0f;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; n = y &gt;&gt; 1;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (j == m-&gt;ja[x + n]) return m-&gt;data[x + n];<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (j &gt; m-&gt;ja[x + n]) {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; x += n + 1; y -= n + 1; //handles y odd<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else y = n;<br>&nbsp;&nbsp;&nbsp; } //while<br>&nbsp;&nbsp;&nbsp; return 0.f;<br>}<br><div align="center"><b>Sparse Matrix Multiplication</b><br></div>CRS zz;<br>CRS xx;<br>CRS yy;<br>void mul2() {<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>crs_init</b>(&amp;zz, N, N, max(xx.nnz, yy.nnz)); //guess on result non-zeros<br>&nbsp;&nbsp;&nbsp; int i, j, k, m, xc, n, xcol;<br>&nbsp;&nbsp;&nbsp; for (i = 0; i &lt; N; i++) { //move down rows<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>crs_newrow</b>(&amp;zz, i); //start new output row<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m =<span class="Apple-converted-space">&nbsp;</span><b>crs_nrow</b>(&amp;xx, i);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (m == 0) continue; //is row i empty?<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (j = 0; j &lt; N; j++) {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; float sum = 0;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; xc =<span class="Apple-converted-space">&nbsp;</span><b>crs_colindex</b>(&amp;xx, i);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; n = m;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (k = xc; --n &gt;= 0; k++) { //step column indices of row i<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; xcol =<span class="Apple-converted-space">&nbsp;</span><b>crs_col</b>(&amp;xx, k);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sum +=<span class="Apple-converted-space">&nbsp;</span><b>crs_data</b>(&amp;xx, k) *<span class="Apple-converted-space">&nbsp;</span><b>crs_g</b>(&amp;yy, xcol, j);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (sum != 0.0f)<span class="Apple-converted-space">&nbsp;</span><b>crs_i</b>(&amp;zz, i, j, sum);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>crs_idone</b>(&amp;zz);<br>}<br><div align="center"><b>Transpose Multiply</b><br></div>void mul3() { //x*transpose(y)<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>crs_init</b>(&amp;zz, N, N, max(xx.nnz, yy.nnz));<br>&nbsp;&nbsp;&nbsp; int i, j, k, xm, xc, n, yc, ym;<br>&nbsp;&nbsp;&nbsp; for (i = 0; i&lt;N; i++) { //move down rows<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>crs_newrow</b>(&amp;zz, i);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; xm =<span class="Apple-converted-space">&nbsp;</span><b>crs_nrow</b>(&amp;xx, i);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (xm == 0) continue;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; xc =<span class="Apple-converted-space">&nbsp;</span><b>crs_colindex</b>(&amp;xx, i);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for (j = 0; j &lt; N; j++) {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; float sum = 0;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; n = xm;&nbsp; k = xc;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ym =<span class="Apple-converted-space">&nbsp;</span><b>crs_nrow</b>(&amp;yy, j);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; yc =<span class="Apple-converted-space">&nbsp;</span><b>crs_colindex</b>(&amp;yy, j);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; while (ym &gt; 0 &amp;&amp; n &gt; 0) { //works like a merge sort<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (<b>crs_col</b>(&amp;xx, k) ==<span class="Apple-converted-space">&nbsp;</span><b>crs_col</b>(&amp;yy, yc)) {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; sum +=<span class="Apple-converted-space">&nbsp;</span><b>crs_data</b>(&amp;xx, k) *<span class="Apple-converted-space">&nbsp;</span><b>crs_data</b>(&amp;yy, yc);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; k++;&nbsp; n--; yc++; ym--;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else if (<b>crs_col</b>(&amp;xx, k) &lt;<span class="Apple-converted-space">&nbsp;</span><b>crs_col</b>(&amp;yy, yc)) {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; k++; n--;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } else { yc++;&nbsp; ym--; }<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } //while<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (sum != 0.0f)<span class="Apple-converted-space">&nbsp;</span><b>crs_i</b>(&amp;zz, i, j, sum);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>crs_idone</b>(&amp;zz);<br>}<br><br><div align="center"><b>OpenMP Sparse Multiply</b><br></div>float *ar[BLOCK];<br>void mul4() {<br>&nbsp;&nbsp;&nbsp; int i, j, k, m, xc, n, xcol;<br><b>#pragma omp parallel private(i,j,k,m,xc,n,xcol)</b><br>{<br>&nbsp; float *p = (float *)malloc(sizeof(float)* 3 * BLOCK);<br>&nbsp; if (p == NULL) exit(-1);<br>&nbsp; int x = 3, cnt = <b>omp_get_thread_num</b>(), nt = <b>omp_get_num_threads</b>();<br><b>#pragma omp for schedule(dynamic)</b><br>&nbsp; for (i = 0; i &lt; N; i++) { //move down rows<br>&nbsp;&nbsp;&nbsp; m =<span class="Apple-converted-space">&nbsp;</span><b>crs_nrow</b>(&amp;xx, i);<br>&nbsp;&nbsp;&nbsp; if (m == 0) continue;<br>&nbsp;&nbsp;&nbsp; for (j = 0; j &lt; N; j++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float sum = 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xc =<span class="Apple-converted-space">&nbsp;</span><b>crs_colindex</b>(&amp;xx, i);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; n = m;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (k = xc; --n &gt;= 0; k++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xcol =<span class="Apple-converted-space">&nbsp;</span><b>crs_col</b>(&amp;xx, k);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sum +=<span class="Apple-converted-space">&nbsp;</span><b>crs_data</b>(&amp;xx, k) *<span class="Apple-converted-space">&nbsp;</span><b>crs_g</b>(&amp;yy, xcol, j);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (sum != 0.0f) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (x &gt;= (BLOCK * 3)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *p = x;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ar[cnt] = p;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p = (float *)malloc(sizeof(float)* 3 * BLOCK);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (p == NULL) exit(-1);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x = 3;&nbsp; cnt += nt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (cnt&gt;=BLOCK) exit(-1);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p[x] = i;&nbsp; p[x + 1] = j; p[x + 2] = sum;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x += 3;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; } //for j<br>&nbsp; } //for i<br>&nbsp; p[0] = x;<br>&nbsp; ar[cnt] = p;<br>} //pragma<br>}<br><div align="center"><b>Modifications for Amortized Algorithm</b><br><div align="left">int temp[TEMPN]; //row,data index pairs<br>int ti;<br><b>#pragma omp for schedule(static)</b><br>for (j = 0; j &lt; N; j++) { //pick a column<br>&nbsp; ti = 0;<br>&nbsp; for (k = 0; k &lt; N; k++) { //step down by row<br>&nbsp;&nbsp;&nbsp; m =<span class="Apple-converted-space">&nbsp;</span><b>crs_gi</b>(&amp;yy, k, j);&nbsp;&nbsp; //build column/index cache<br>&nbsp;&nbsp;&nbsp; if (m &gt;= 0) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ti &gt;= TEMPN) exit(-1);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; temp[ti] = k;&nbsp; temp[ti+1] = m;&nbsp; ti += 2;<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp; } //for k<br>&nbsp; for (i = 0; i &lt; N; i++) { //step by row<br>&nbsp;&nbsp;&nbsp; float sum = 0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //use cache N times<br>&nbsp;&nbsp;&nbsp; m =<span class="Apple-converted-space">&nbsp;</span><b>crs_nrow</b>(&amp;xx, i);<br>&nbsp;&nbsp;&nbsp; xc =<span class="Apple-converted-space">&nbsp;</span><b>crs_colindex</b>(&amp;xx, i);<br>&nbsp;&nbsp;&nbsp; n = 0;<br>&nbsp;&nbsp;&nbsp; while (m &gt; 0 &amp;&amp; n &lt; ti) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (<b>crs_col</b>(&amp;xx, xc) == temp[n]) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sum +=<span class="Apple-converted-space">&nbsp;</span><b>crs_data</b>(&amp;xx, xc++) *<span class="Apple-converted-space">&nbsp;</span><b>crs_data</b>(&amp;yy, temp[n+1]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m--;&nbsp; n += 2;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else if (<b>crs_col</b>(&amp;xx, xc) &lt; temp[n]) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xc++;&nbsp; m--;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else n += 2;<br>&nbsp;&nbsp;&nbsp; } //while<br></div></div><br><div align="center"><b>Intel MKL Matrix Multiplication</b><br><div align="left">#include "mkl_types.h"<br>#include "mkl_spblas.h"<br><br>#define N 6<br>#define MAXNZ 10<br>#define PCT 0.1f<br></div></div>#define TOCSR 0<br>#define BASE1 1<br>#define WHOLE 2<br>#define GENijdata 1<br>float x[N][N];<br>float y[N][N];<br>CRS csrx, csry, csrz;<br><br>int main() {<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>crs_init</b>(&amp;csrx, N, N, MAXNZ);<br>&nbsp; init_rand(x, 1, 9, PCT);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>crs_init</b>(&amp;csry, N, N, MAXNZ);<br>&nbsp; init_rand(y, 1, 9, PCT);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>crs_init</b>(&amp;csrz, N, N, MAXNZ);<br>&nbsp; int job[] = {TOCSR, BASE1, BASE1, WHOLE, MAXNZ, GENijdata};<br>&nbsp; int m = N, n = N, info;<br>&nbsp; int request = 0;<br>&nbsp; int sortC = 8;<br>&nbsp; int maxnz = MAXNZ;<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>mkl_sdnscsr</b>(&amp;job[0], &amp;m, &amp;n, &amp;x[0][0],&amp;m,&amp;csrx.data[0],&amp;csrx.ja[0],&amp;csrx.ia[0], &amp;info);<br>&nbsp; printf("info=%d\n", info);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>crs_print</b>(&amp;csrx);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>mkl_sdnscsr</b>(&amp;job[0], &amp;m, &amp;n, &amp;y[0][0],&amp;m,&amp;csry.data[0],&amp;csry.ja[0],&amp;csry.ia[0], &amp;info);<br>&nbsp; printf("info=%d\n", info);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>crs_print</b>(&amp;csry);<br>&nbsp; long start = clock();<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>mkl_scsrmultcsr</b><span class="Apple-converted-space">&nbsp;</span>("N" , &amp;request , &amp;sortC , &amp;m , &amp;n , &amp;n ,<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;csrx.data[0] , &amp;csrx.ja[0] , &amp;csrx.ia[0] ,<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;csry.data[0] , &amp;csry.ja[0] , &amp;csry.ia[0] ,<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;csrz.data[0] , &amp;csrz.ja[0] , &amp;csrz.ia[0], &amp;maxnz , &amp;info );<br>&nbsp; long stop = clock();<br>&nbsp; printf("info=%d %gs %d\n", info, (float)(stop-start)/CLOCKS_PER_SEC, csrz.ia[N]);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>crs_print</b>(&amp;csrz);<br>&nbsp; return 0;<br>}<br><b>OUTPUT</b><br>&nbsp; 8.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 9.00<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 1.00<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 8.00&nbsp;&nbsp; 7.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 1.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 9.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00<span class="Apple-converted-space">&nbsp;</span><br><br>&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 3.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 8.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 7.00&nbsp;&nbsp; 5.00<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; 6.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 0.00&nbsp;&nbsp; 5.00&nbsp;&nbsp; 0.00<span class="Apple-converted-space">&nbsp;</span><br>info=0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 &nbsp;&nbsp;&nbsp;&nbsp; 2<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp; 8.0&nbsp;&nbsp; 8.0&nbsp;&nbsp; 7.0&nbsp;&nbsp; 1.0&nbsp;&nbsp; 9.0&nbsp;&nbsp; 9.0&nbsp;&nbsp; 1.0<span class="Apple-converted-space">&nbsp;</span><br>info=0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; &nbsp; 2&nbsp;&nbsp;&nbsp; &nbsp; 2&nbsp;&nbsp; &nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp; &nbsp; 4&nbsp;&nbsp; &nbsp;&nbsp; 6&nbsp;&nbsp; &nbsp;&nbsp; 7<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; &nbsp; 1&nbsp;&nbsp; &nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp; &nbsp; 4&nbsp;&nbsp; &nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; &nbsp; 4&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp; 6.0&nbsp;&nbsp; 3.0&nbsp;&nbsp; 8.0&nbsp;&nbsp; 7.0&nbsp;&nbsp; 5.0&nbsp;&nbsp; 5.0&nbsp;<span class="Apple-converted-space">&nbsp;</span><br>info=0 0.007298s 8<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6<span class="Apple-converted-space">&nbsp;</span><br>&nbsp; 48.0&nbsp; 24.0&nbsp; 21.0&nbsp;&nbsp; 8.0&nbsp; 63.0&nbsp; 45.0&nbsp; 54.0<br><h3>GraphBLAS Example</h3><p>The following example computes a single-source breadth-first traversal that calculates the distance from the source vertex to every vertex in a directed or undirected graph.&nbsp; The two versions of the algorithm have been copied from Appendix A of the Standard.&nbsp; One version uses assignop/reduce; the second version uses apply/nnz.&nbsp; For convenience, a printf has been added after each operation to illustrate the algorithm's steps.<br></p><div align="center"><b>GraphBLAS Breadth-First Search</b><br></div><p>//GraphBLAS C99 implementation of the first two examples in Appendix A<br>#include &lt;stdint.h&gt;<br>#include &lt;stdbool.h&gt;<br>#include "GraphBLAS.h"<br></p><p>/*<br>* Given a Boolean n x n adjacency matrix A and a source vertex s,<br>*&nbsp; perform a BFS traversal of the graph and set v[i] to the level<br>*&nbsp; in which vertex i is visited (v[s] == 1).<br>* If i is not reachable from s, then v[i] = 0.<br>* (Vector v is overwritten.)<br>*/<br>//#define APPLY<br>#define REDUCE<br>GrB_info returnLevel(GrB_Variable result, const GrB_Variable arg1, void *context) {<br>&nbsp; <b>GrB_set_int32</b>(result, <b>GrB_bool</b>(arg1) ? (int)context : 0);<br>&nbsp; return GrB_SUCCESS;<br>}<br>GrB_info BFS(GrB_Vector *v, GrB_Matrix A, GrB_index s)&nbsp; {<br>&nbsp; GrB_index n;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // n = # of rows of A<br>&nbsp; GrB_Vector q;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // vertices visited in each level<br>&nbsp; GrB_Monoid Lor;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Logical or monoid<br>&nbsp; GrB_Semiring Boolean;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Boolean semiring &lt;bool , bool , bool ,|| ,&amp;&amp; , false &gt;<br>&nbsp; GrB_Descriptor desc;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Descriptor for vxm<br>&nbsp; int32_t d = 1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // d = level in BFS traversal<br>&nbsp; GrB_Variable succ;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // succ == true when some successor found<br>&nbsp; <b>GrB_Matrix_ncols</b>(&amp;n, A);<br>&nbsp; <b>GrB_Vector_new</b>(v, GrB_INT32, n);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Vector&lt;int32_t&gt; v(n)<br>&nbsp; <b>GrB_Vector_assign</b>(*v, 0);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // v = 0<br>&nbsp; <b>GrB_Vector_new</b>(&amp;q, GrB_BOOL, n);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Vector&lt;bool&gt; q(n)<br>&nbsp; <b>GrB_Vector_assign</b>(q, false);<br>&nbsp; <b>GrB_Vector_assigni</b>(q, true, s);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // q[s] = true , false everywhere else<br>&nbsp; <b>GrB_Monoid_new</b>(&amp;Lor, GrB_BOOL, GrB_LOR, false);<br>&nbsp; <b>GrB_Semiring_new</b>(&amp;Boolean, Lor, GrB_LAND);<br>&nbsp; <b>GrB_Descriptor_new</b>(&amp;desc);<br>&nbsp; <b>GrB_Descriptor_set</b>(desc, GrB_MASK, GrB_SCMP);&nbsp; // invert the mask<br><br>&nbsp; // BFS traversal and label the vertices.<br>#ifdef APPLY<br>&nbsp; {<br>&nbsp; GrB_UnaryOp applyLevel;<br>&nbsp; GrB_index nnz;<br>&nbsp; int level = 0;<br>&nbsp; <b>GrB_UnaryOp_new</b>(&amp;applyLevel, GrB_INT32, GrB_BOOL, returnLevel);<br>&nbsp; do {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ++level; // next level(starts with 1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>GrB_Vector_apply</b>(*v, GrB_NULL, GrB_PLUS, applyLevel, q, GrB_NULL, (void *)level); // v[q] = level<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>GrB_printf</b>(*v);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>GrB_vxm</b>(q, *v, GrB_NULL, Boolean, q, A, desc);&nbsp; // q[!v] = q ||.&amp;&amp; A ; finds all the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // successors from current q<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>GrB_printf</b>(q); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>GrB_Vector_nnz</b>(&amp;nnz, q);<br>&nbsp; } while (nnz); // if there is no successor in q, we are done.<br>&nbsp; <b>GrB_free</b>(applyLevel);<br>&nbsp; }<br>#endif<br>#ifdef REDUCE<br>&nbsp; <b>GrB_Variable_new</b>(&amp;succ, GrB_BOOL, false);<br>&nbsp; do {<br>&nbsp;&nbsp;&nbsp; <b>GrB_Vector_assignop</b>(*v, q, GrB_NULL, d, GrB_ALL, n, GrB_NULL);&nbsp; // v[q] = d<br>&nbsp;&nbsp;&nbsp; <b>GrB_printf</b>(*v);<br>&nbsp;&nbsp;&nbsp; <b>GrB_vxm</b>(q, *v, GrB_NULL, Boolean, q, A, desc);&nbsp; // q[!v] = q ||.&amp;&amp; A ; finds all the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // successors from current q<br>&nbsp;&nbsp;&nbsp; <b>GrB_printf</b>(q);<br>&nbsp;&nbsp;&nbsp; <b>GrB_Vector_reduce</b>(succ, GrB_NULL, Lor, q, GrB_NULL); // succ = ||(q)<br>&nbsp;&nbsp;&nbsp; <b>GrB_printf</b>(succ);<br>&nbsp;&nbsp;&nbsp; d++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // next level<br>&nbsp; } while (<b>GrB_bool</b>(succ));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // if there is no successor in q, we are done.<br>&nbsp; <b>GrB_free</b>(succ);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // constant no longer needed<br>#endif<br>&nbsp; <b>GrB_free</b>(q);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // q vector no longer needed<br>&nbsp; <b>GrB_free</b>(Lor);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Logical or monoid no longer needed<br>&nbsp; <b>GrB_free</b>(Boolean);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Boolean semiring no longer needed<br>&nbsp; <b>GrB_free</b>(desc);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // descriptor no longer needed<br>&nbsp; return GrB_SUCCESS;<br>}<br><br>int main(void) {<br>&nbsp; GrB_Matrix m;<br>&nbsp; GrB_Vector v;<br>&nbsp; <b>GrB_Matrix_new</b>(&amp;m, GrB_BOOL, 14, 14);<br>&nbsp; <b>GrB_Matrix_assign</b>(m, false);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 1, 0); //directed graph<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 2, 0);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 3, 2);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 4, 1);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 5, 2);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 5, 4);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 6, 3);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 7, 5);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 9, 6);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 9, 8);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 10, 7);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 10, 8);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 11, 9);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 12, 10);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 13, 11);<br>&nbsp; <b>GrB_Matrix_assignij</b>(m, true, 13, 12);<br>&nbsp; <b>GrB_printf</b>(m);<br>&nbsp; BFS(&amp;v, m, 13);<br>&nbsp; <b>GrB_printf</b>(v);<br>&nbsp; <b>GrB_free</b>(m);<br>&nbsp; <b>GrB_free</b>(v);<br>&nbsp; return 0;<br>}<br></p><b>OUTPUT<br></b>&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0<br>&nbsp;<br>v=0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 <br>q=0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;<br>v=0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 <br>q=0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br><br>v=0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 <br>q=0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br><br>v=0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 <br>q=0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br><br>v=0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 <br>q=0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br><br>v=0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 <br>q=1&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>1 <br>v=7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 <br>q=0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 0 <br>&nbsp;<br>BFS=7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1<b><br></b><br><div align="center"><b>New CRS API</b><br><div align="left">typedef struct _crs {<br>&nbsp; int nr, nc, nnz;<br>&nbsp; int *ja, *ia;<br>&nbsp; float *data;<br>&nbsp; int nz;<br>&nbsp; int undirected;<br>&nbsp; int *icol, *irow;<br>} CRS;<br></div><div align="left"><br></div>#define N 4000<br></div>void bfs(pCRS mx, int startV) {<br>&nbsp; int NV = mx-&gt;nr;<br>&nbsp; int dist[4000];<br>&nbsp; int i, j, k, m, n, steps = 0, v, w, x;<br>&nbsp; int Q[N], Qnext = 0;<br>&nbsp; int Qstart = -1, qn = 1;<br>&nbsp; for (j = 0; j&lt; NV; j++) {<br>&nbsp;&nbsp;&nbsp; dist[j] = -1;<br>&nbsp; }<br>&nbsp; Q[0] = startV;<br>&nbsp; dist[startV] = 0;<br>&nbsp; for (; qn;) {<br>&nbsp;&nbsp;&nbsp; steps++;<br>&nbsp;&nbsp;&nbsp; j = Qstart;&nbsp; Qstart = Qnext;<br>&nbsp;&nbsp;&nbsp; n = qn;&nbsp; qn = 0;<br><b>#pragma omp parallel for private(i,k,m,v,w)</b><br>&nbsp;&nbsp;&nbsp; for (x=0; x&lt;n; x++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v = Q[(j+x+1)%N];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m = <b>crs_nrow</b>(mx, v);&nbsp;&nbsp; //# columns<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; k = <b>crs_colindex</b>(mx, v); //index to column list for row v<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i = 0; i &lt; m; i++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w = <b>crs_col</b>(mx, k + i);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (dist[w] &lt; 0) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //has vertex w been visited?<br><b>#pragma omp critical</b><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Qnext = (Qnext + 1) % N; //add to circular Q<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; qn++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Q[Qnext] = w;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dist[w] = steps;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //if<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for i<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!mx-&gt;undirected) continue;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; k = <b>crs_rowindex</b>(mx, v);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //list of rows in a column<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (k &gt;= 0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (mx-&gt;icol[k] == v) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w = mx-&gt;irow[k++];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (dist[w] &lt; 0) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //has vertex w been visited?<br><b>#pragma omp critical</b><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Qnext = (Qnext + 1) % N;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; qn++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Q[Qnext] = w;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dist[w] = steps;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //if<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //while <br>&nbsp;&nbsp;&nbsp; } //for x<br>&nbsp; } //for ;;<br>&nbsp; for (i = 0; i &lt; NV; i++) printf("%d ", dist[i]);<br>&nbsp; printf("\n");<br>}<br></div></div></div><hr width="100%" size="2"><h1><a name="r71"></a>CHAPTER SEVEN<br>MULTI-COMPUTER MPI PROGRAMMING<br>
            </h1>
          </center><h2><b><b><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; width: 1119px; height: 2px;"><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: center;"><span style="font-weight: bold;"><br>MPI Task Information</span><br></div><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#include &lt;mpi.h&gt;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#include &lt;stdio.h&gt;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">int main(int argc, char *argv[]) {</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; int number;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; char name[<b>MPI_MAX_PROCESSOR_NAME</b>];</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Init</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(&amp;argc, &amp;argv);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Get_processor_name</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(name, &amp;number);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; printf("computer=%s\n",&nbsp; name);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Comm_rank</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(<b>MPI_COMM_WORLD</b>, &amp;number);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; printf("rank=%d\n",&nbsp; number);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; if (number == 0) {</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; printf("time=%g\n",<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Wtime</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">());</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; printf("tick=%g\n",<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Wtick</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">());</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Comm_size</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(<b>MPI_COMM_WORLD</b>, &amp;number);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; printf("world size=%d\n", number);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; }</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Finalize</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">();</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; return 0;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">}</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">mpirun -np 4 a.out</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold;">OUTPUT</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">computer=Roberts-Mini</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank=0</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">time=0.375213</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">tick=1e-06</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">computer=Roberts-Mini</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank=1</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">computer=Roberts-Mini</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank=2</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">computer=Roberts-Mini</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank=3</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">world size=4</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; width: 1119px; height: 2px;"><h3 style="color: rgb(0, 0, 0); font-family: Times; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI Messages</h3></b></b><b><b><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: center;"><div align="left"><hr width="100%" size="2"><span style="font-weight: bold;"></span></div><span style="font-weight: bold;">Send and Receive Example</span><br></div><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#include &lt;mpi.h&gt;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#include &lt;stdio.h&gt;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#include &lt;string.h&gt;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">int main(int argc, char *argv[] )&nbsp; {</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; char message[20];</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; int rank, size;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Status</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;"><span class="Apple-converted-space">&nbsp;</span>status;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Init</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">( &amp;argc, &amp;argv );</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Comm_rank</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">( MPI_COMM_WORLD, &amp;rank );</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Comm_size</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">( MPI_COMM_WORLD, &amp;size );</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; if (rank == 0) {&nbsp;&nbsp;&nbsp; /* code for process zero */</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strcpy(message,"567");</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Send</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(message, strlen(message), MPI_CHAR, 1, 99, MPI_COMM_WORLD);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; } else {</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Recv</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(message, 20, MPI_CHAR, (rank-1)%size, 99, MPI_COMM_WORLD, &amp;status);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%d received :%s:\n", rank, message);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (rank &lt; size-1) {</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strcat(message, "X");</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Send</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(message, strlen(message), MPI_CHAR, (rank+1)%size, 99, MPI_COMM_WORLD);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; }</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Finalize</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">();</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">}</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">mpirun -np 4 a.out</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold;">OUTPUT</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">*****************RANK 0 ***************</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">*****************RANK 1 ***************</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">1 received :567:</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">*****************RANK 2 ***************</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">2 received :567X:</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">*****************RANK 3 ***************</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">3 received :567XX:</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">***************** COMPLETED *********</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"></b></b><b><b><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" width="100%" size="2"><p style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>Buffering Example</b><br></p><table style="font-family: Times; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" width="100%" cellspacing="2" cellpadding="2" border="2"><tbody><tr><td valign="top">#include &lt;mpi.h&gt;<br>#include &lt;stdio.h&gt;<br>#include &lt;string.h&gt;<br><br>char message[300000];<br>char temp[150000];<br>int main(int argc, char *argv[] )&nbsp; {<br>&nbsp;&nbsp;&nbsp; int rank, size, i;<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Status</b><span class="Apple-converted-space">&nbsp;</span>status;<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Init</b>( &amp;argc, &amp;argv );<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_rank</b>( MPI_COMM_WORLD, &amp;rank );<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_size</b>( MPI_COMM_WORLD, &amp;size );<br>&nbsp;&nbsp;&nbsp; if (rank == 0) {&nbsp;&nbsp;&nbsp; /* code for process zero */<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i = 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strcpy(message,"56");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (strlen(message)*2 &lt; sizeof(message)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strcpy(temp, message);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strcat(message, temp); //double msg size<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("send %d\n", strlen(message));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Send</b>(message, strlen(message), MPI_CHAR, 1, 99, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("send \n");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Send</b>(message, 1, MPI_CHAR, 1, 99, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp; } else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (;;) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Recv</b>(message, sizeof(message), MPI_CHAR, (rank-1)%size, 99, MPI_COMM_WORLD, &amp;status);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Get_count</b>(&amp;status, MPI_CHAR, &amp;i);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%d received :%d:\n", rank, i);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (i &lt; 4) break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for<br>&nbsp;&nbsp;&nbsp; } //if rank<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Finalize</b>();<br>}<br><b>OUTPUT</b><br>send 4<br>send 8<br>send 16<br>send 32<br>send 64<br>send 128<br>send 256<br>send 512<br>send 1024<br>send 2048<br>send 4096<br>1 received :4:<br>1 received :8:<br>1 received :16:<br>1 received :32:<br>1 received :64:<br>1 received :128:<br>1 received :256:<br>1 received :512:<br>1 received :1024:<br>1 received :2048:<br>send 8192<br>1 received :4096:<br>1 received :8192:<br>send 16384<br>1 received :16384:<br>send 32768<br>1 received :32768:<br>send 65536<br>1 received :65536:<br>send 131072<br>1 received :131072:<span class="Apple-converted-space">&nbsp;</span><br>1 received :1:<br></td></tr></tbody></table><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" width="100%" size="2"><p style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>Bsend Example</b><br></p></b></b><b><b><table style="font-family: Times; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" width="100%" cellspacing="2" cellpadding="2" border="2"><tbody><tr><td valign="top">#include &lt;mpi.h&gt;<br>#include &lt;stdio.h&gt;<br>#include &lt;string.h&gt;<br><br>char message[2000000];<br>char temp[1000000];<br>char temp2[16000];<br>int main(int argc, char *argv[] )&nbsp; {<br>&nbsp;&nbsp;&nbsp; int rank, size, i;<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Status</b><span class="Apple-converted-space">&nbsp;</span>status;<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Init</b>( &amp;argc, &amp;argv );<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_rank</b>( MPI_COMM_WORLD, &amp;rank );<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_size</b>( MPI_COMM_WORLD, &amp;size );<br>&nbsp;&nbsp;&nbsp; if (rank == 0) {&nbsp;&nbsp;&nbsp; /* code for process zero */<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i = 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strcpy(message,"56");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Buffer_attach</b>(&amp;temp2, sizeof(temp2));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (i++ &lt; 30) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strcpy(temp, message);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (i%12 == 0) message[4]=0; else strcat(message, temp);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("send %d\n", strlen(message));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Bsend</b>(message, strlen(message), MPI_CHAR, 1, 99, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("send \n");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Bsend</b>(message, 1, MPI_CHAR, 1, 99, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp; } else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (;;) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Recv</b>(message, sizeof(message), MPI_CHAR, (rank-1)%size, 99, MPI_COMM_WORLD, &amp;status);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Get_count</b>(&amp;status, MPI_CHAR, &amp;i);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%d received :%d:\n", rank, i);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (i &lt; 4) break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Finalize</b>();<br>}<br><b>OUTPUT </b>(user must manage buffers)<br><small>send 4<br>send 8<br>send 16<br>send 32<br>send 64<br>send 128<br>send 256<br>send 512<br>send 1024<br>send 2048<br>send 4096<br>1 received :4:<br>send 4<br>send 8<br>send 16<br>1 received :8:<br>1 received :16:<br>1 received :32:<br>1 received :64:<br>1 received :128:<br>1 received :256:<br>1 received :512:<br>1 received :1024:<br>1 received :2048:<br>send 32<br>send 64<br>send 128<br>send 256<br>send 512<br>send 1024<br>send 2048<br>send 4096<br>send 8192<br>1 received :4096:<br>1 received :4:<br>1 received :8:<br>1 received :16:<br>1 received :32:<br>1 received :64:<br>1 received :128:<br>1 received :256:<br>1 received :512:<br>1 received :1024:<br>1 received :2048:<br>[Roberts-Mini:70106] *** An error occurred in MPI_Bsend<br>[Roberts-Mini:70106] *** on communicator MPI_COMM_WORLD<br>[Roberts-Mini:70106] *** MPI_ERR_BUFFER: invalid buffer pointer</small><br></td></tr></tbody></table><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" width="100%" size="2"><p style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>Asynchronous Example</b><br></p></b></b><b><b><table style="font-family: Times; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" width="100%" cellspacing="2" cellpadding="2" border="2"><tbody><tr><td valign="top">#include &lt;mpi.h&gt;<br>#include &lt;stdio.h&gt;<br>#include &lt;string.h&gt;<br><br>char message[2000000];<br>char temp[1000000];<br><b>MPI_Request</b><span class="Apple-converted-space">&nbsp;</span>requests[30];<br>int main(int argc, char *argv[] )&nbsp; {<br>&nbsp;&nbsp;&nbsp; int rank, size, i;<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Status</b><span class="Apple-converted-space">&nbsp;</span>status;<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Init</b>( &amp;argc, &amp;argv );<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_rank</b>( MPI_COMM_WORLD, &amp;rank );<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_size</b>( MPI_COMM_WORLD, &amp;size );<br>&nbsp;&nbsp;&nbsp; if (rank == 0) {&nbsp;&nbsp;&nbsp; /* code for process zero */<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i = 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strcpy(message,"56");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (i++ &lt; 30) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strcpy(temp, message);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (i%12 == 0) message[4]=0; else strcat(message, temp);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("send %d\n", strlen(message));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Isend</b>(message, strlen(message), MPI_CHAR, 1, 99, MPI_COMM_WORLD, &amp;requests[i]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("send \n");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Rsend</b>(message, 1, MPI_CHAR, 1, 99, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp; } else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (;;) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Recv</b>(message, sizeof(message), MPI_CHAR, (rank-1)%size, 99, MPI_COMM_WORLD, &amp;status);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Get_count</b>(&amp;status, MPI_CHAR, &amp;i);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%d received :%d:\n", rank, i);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (i &lt; 4) break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Finalize</b>();<br>}<br><b>OUTPUT</b><br><small>send 4<br>send 8<br>send 16<br>send 32<br>send 64<br>send 128<br>send 256<br>send 512<br>send 1024<br>send 2048<br>send 4096<br>send 4<br>send 8<br>send 16<br>send 32<br>send 64<br>1 received :4:<br>send 128<br>send 256<br>send 512<br>1 received :8:<br>1 received :16:<br>1 received :32:<br>1 received :64:<br>1 received :128:<br>1 received :256:<br>1 received :512:<br>1 received :1024:<br>1 received :2048:<br>send 1024<br>send 2048<br>send 4096<br>send 8192<br>send 4<br>send 8<br>send 16<br>send 32<br>send 64<br>send 128<br>send 256<br>send<span class="Apple-converted-space">&nbsp;</span><br>1 received :4096:<br>1 received :4:<br>1 received :8:<br>1 received :16:<br>1 received :32:<br>1 received :64:<br>1 received :128:<br>1 received :256:<br>1 received :512:<br>1 received :1024:<br>1 received :2048:<br>1 received :4096:<br>1 received :8192:<br>1 received :4:<br>1 received :8:<br>1 received :16:<br>1 received :32:<br>1 received :64:<br>1 received :128:<br>1 received :256:<br>1 received :1:</small></td></tr></tbody></table></b></b><b><b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;"></span><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" width="100%" size="2"><p style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>Completion Example<br></b></p></b></b><b><b><table style="font-family: Times; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" width="100%" cellspacing="2" cellpadding="2" border="2"><tbody><tr><td valign="top">#include &lt;mpi.h&gt;<br>#include &lt;stdio.h&gt;<br>#include &lt;string.h&gt;<br><br>char message[2000000];<br>char temp[1000000];<br><b>MPI_Request</b><span class="Apple-converted-space">&nbsp;</span>requests[30];<br>int main(int argc, char *argv[] )&nbsp; {<br>&nbsp;&nbsp;&nbsp; int rank, size, i, j;<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Status</b><span class="Apple-converted-space">&nbsp;</span>status;<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Init</b>( &amp;argc, &amp;argv );<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_rank</b>( MPI_COMM_WORLD, &amp;rank );<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_size</b>( MPI_COMM_WORLD, &amp;size );<br>&nbsp;&nbsp;&nbsp; if (rank == 0) {&nbsp;&nbsp;&nbsp; /* code for process zero */<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i = 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strcpy(message,"56");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (i++ &lt; 30) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strcpy(temp, message);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (i%12 == 0) message[4]=0; else strcat(message, temp);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("send %d\n", strlen(message));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Send</b>(message, strlen(message), MPI_CHAR, 1, 99, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; } else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i=0; i&lt;30; i++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Irec</b>v(message, sizeof(message), MPI_CHAR, (rank-1)%size, 99, MPI_COMM_WORLD, &amp;requests[i]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i=0; i&lt;30; i++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Waitany</b>(30, requests, &amp;size, &amp;status);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Get_count</b>(&amp;status, MPI_CHAR, &amp;j);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%d received msg %d :%d:\n", rank, size, j);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; <b>MPI_Finalize</b>();<br>}<br><b>OUTPUT</b><br><small>send 4<br>send 8<br>send 16<br>send 32<br>send 64<br>send 128<br>send 256<br>send 512<br>send 1024<br>send 2048<br>send 4096<br>1 received msg 0 :4:<br>1 received msg 1 :8:<br>1 received msg 2 :16:<br>1 received msg 3 :32:<br>1 received msg 4 :64:<br>1 received msg 5 :128:<br>1 received msg 6 :256:<br>1 received msg 7 :512:<br>1 received msg 8 :1024:<br>1 received msg 9 :2048:<br>send 4<br>send 8<br>send 16<br>send 32<br>1 received msg 10 :4096:<br>1 received msg 11 :4:<br>1 received msg 12 :8:<br>1 received msg 13 :16:<br>send 64<br>send 128<br>send 256<br>send 512<br>1 received msg 14 :32:<br>1 received msg 15 :64:<br>1 received msg 16 :128:<br>send 1024<br>send 2048<br>send 4096<br>1 received msg 17 :256:<br>1 received msg 18 :512:<br>1 received msg 19 :1024:<br>1 received msg 20 :2048:<br>send 8192<br>1 received msg 21 :4096:<br>1 received msg 22 :8192:<br>1 received msg 23 :4:<br>send 4<br>send 8<br>send 16<br>send 32<br>send 64<br>send 128<br>send 256<br>1 received msg 24 :8:<br>1 received msg 25 :16:<br>1 received msg 26 :32:<br>1 received msg 27 :64:<br>1 received msg 28 :128:<br>1 received msg 29 :256:</small></td></tr></tbody></table></b></b><b><b><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; width: 1119px; height: 2px;"><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; width: 1119px; height: 2px;"><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: center;"><span style="font-weight: bold;">MPI Group Message Example</span><br></div><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"></b></b><b><b><table style="font-family: Times; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" width="100%" cellspacing="2" cellpadding="2" border="2"><tbody><tr><td valign="top">#include &lt;mpi.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //mpirun -np 5 a.out<br>#include &lt;stdio.h&gt;<br>#include &lt;string.h&gt;<br><br>int main(int argc, char *argv[] )&nbsp; {<br>&nbsp;&nbsp;&nbsp; int rank, size, i, j;<br>&nbsp;&nbsp;&nbsp; float g[10];<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Init</b>( &amp;argc, &amp;argv );<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_rank</b>( MPI_COMM_WORLD, &amp;rank );<br>if (rank == 0) {<br>&nbsp;&nbsp; float f[] = {1,2,3,4,5,6,7,8,9,10};<br>&nbsp;&nbsp; printf("rank 0 broadcasting 1 to 10\n");<br>&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Bcast</b>(f, 10, MPI_FLOAT, 0, MPI_COMM_WORLD);<br>&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Scatter</b>(f, 2, MPI_FLOAT, f, 2, MPI_FLOAT, 0, MPI_COMM_WORLD);<br>&nbsp;&nbsp; printf("rank 0 scattering 1 to 10; we get 1st two\n");<br>&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Gather</b>(f, 2, MPI_FLOAT, f, 2, MPI_FLOAT, 0, MPI_COMM_WORLD);<br>&nbsp;&nbsp; printf("rank %d gathering recv=", rank);<br>&nbsp;&nbsp; for (i=0; i&lt;10; i++)<br>&nbsp;&nbsp;&nbsp;&nbsp; printf("%g ", f[i]);<br>&nbsp;&nbsp; printf("\n");<br>&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Reduce</b>(f, g, 2, MPI_FLOAT, MPI_SUM, 0, MPI_COMM_WORLD);<br>&nbsp;&nbsp; printf("rank %d reduce sum=%g %g\n", rank, g[0], g[1]);<br>} else {<br>&nbsp;&nbsp; float f[10];<br>&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Bcast</b>(f, 10, MPI_FLOAT, 0, MPI_COMM_WORLD);<br>&nbsp;&nbsp; printf("rank %d bcast recv=", rank);<br>&nbsp;&nbsp; for (i=0; i&lt;10; i++)<br>&nbsp;&nbsp;&nbsp;&nbsp; printf("%g ", f[i]);<br>&nbsp;&nbsp; printf("\n");<br>&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Scatter</b>(f, 2, MPI_FLOAT, f, 2, MPI_FLOAT, 0, MPI_COMM_WORLD);<br>&nbsp;&nbsp; printf("rank %d scatter recv=%g %g\n", rank, f[0], f[1]);<br>&nbsp;&nbsp; f[0]=rank;&nbsp; f[1]=rank*2;<br>&nbsp;&nbsp; printf("rank %d sending reduce results=%g %g\n", rank, f[0], f[1]);<br>&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Gather</b>(f, 2, MPI_FLOAT, f, 2, MPI_FLOAT, 0, MPI_COMM_WORLD);<br>&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Reduce</b>(f, g, 2, MPI_FLOAT, MPI_SUM, 0, MPI_COMM_WORLD);<br>} //if<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Finalize</b>();<br>}<br><b>OUTPUT</b><br>rank 0 broadcasting 1 to 10<br>rank 0 scattering 1 to 10; we get 1st two<br>rank 4 bcast recv=1 2 3 4 5 6 7 8 9 10<span class="Apple-converted-space">&nbsp;</span><br>rank 2 bcast recv=1 2 3 4 5 6 7 8 9 10<span class="Apple-converted-space">&nbsp;</span><br>rank 1 bcast recv=1 2 3 4 5 6 7 8 9 10<span class="Apple-converted-space">&nbsp;</span><br>rank 3 bcast recv=1 2 3 4 5 6 7 8 9 10<span class="Apple-converted-space">&nbsp;</span><br>rank 2 scatter recv=5 6<br>rank 2 sending reduce results=2 4<br>rank 4 scatter recv=9 10<br>rank 4 sending reduce results=4 8<br>rank 1 scatter recv=3 4<br>rank 1 sending reduce results=1 2<br>rank 3 scatter recv=7 8<br>rank 3 sending reduce results=3 6<br>rank 0 gathering recv=1 2 1 2 2 4 3 6 4 8<span class="Apple-converted-space">&nbsp;</span><br>rank 0 reduce sum=11 22</td></tr></tbody></table></b></b><b><b><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; width: 1119px; height: 2px;"><h3 style="color: rgb(0, 0, 0); font-family: Times; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Monte Carlo Estimate of PI</h3></b></b><b><b><table style="font-family: Times; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" width="100%" cellspacing="2" cellpadding="2" border="2"><tbody><tr><td valign="top">#include &lt;mpi.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //mpirun -np 8 a.out<br>#include &lt;stdlib.h&gt;<br>#include &lt;stdio.h&gt;<br>#include &lt;math.h&gt;<br>#include &lt;limits.h&gt;<br><br>#define POINTS 15000<br>#define TOLERANCE 0.00001<br>#define STOP 1<br>#define GO&nbsp;&nbsp; 2<br>int main(int argc, char *argv[]) {<br>&nbsp;&nbsp;&nbsp; int rank, size;<br>&nbsp;&nbsp;&nbsp; double x, y, error, calculatedPI, pies[10], average;<br>&nbsp;&nbsp;&nbsp; int in=0, out=0, action=0, i, j=0;<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Init</b>( &amp;argc, &amp;argv );<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_rank</b>( MPI_COMM_WORLD, &amp;rank );<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_size</b>( MPI_COMM_WORLD, &amp;size );<br>&nbsp;&nbsp;&nbsp; action = GO;<br>&nbsp;&nbsp;&nbsp; for (;;) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Bcast</b>(&amp;action, 1, MPI_INT, 0, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (action == STOP) break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i = 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; srandom((rank+1) * ++j); //different seed for each process<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do {&nbsp;&nbsp; //drop balls at point xy<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x = ((double)random())/INT_MAX;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y = ((double)random())/INT_MAX;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( x * x + y * y &lt; 1.0 ) in++; //inside circle?<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else out++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } while (i++ &lt;= POINTS);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; calculatedPI = ( 4.0 * in ) / ( in + out );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("iter=%d PI=%24.20f\n", j, calculatedPI);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Gather</b>(&amp;calculatedPI, 1, MPI_DOUBLE,<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pies, 1, MPI_DOUBLE, 0, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (rank == 0) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i=0; i&lt;size; i++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; error = fabs ( pies[i] - 3.141592653589793238462643 );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (error &lt; TOLERANCE) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; action = STOP;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("PI=%24.20f error=%g\n", pies[i], error);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for i<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //if rank<br>&nbsp;&nbsp; } //for<br>&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Finalize</b>();<br>}<br><b>OUTPUT</b><br>iter=1 PI=&nbsp; 3.15797893614184754796<br>iter=1 PI=&nbsp; 3.14278096253832828211<br>iter=1 PI=&nbsp; 3.13478202906279168616<br>iter=1 PI=&nbsp; 3.16917744300759895992<br>iter=1 PI=&nbsp; 3.14171443807492334344<br>iter=1 PI=&nbsp; 3.12571657112385015154<br>iter=1 PI=&nbsp; 3.14304759365417929473<br>iter=1 PI=&nbsp; 3.13291561125183326553<br>iter=2 PI=&nbsp; 3.15037994934008791503<br>iter=2 PI=&nbsp; 3.14224770030662581277<br>iter=2 PI=&nbsp; 3.15077989601386487806<br>iter=2 PI=&nbsp; 3.13024930009332091885<br>iter=2 PI=&nbsp; 3.13731502466337808244<br>iter=2 PI=&nbsp; 3.12358352219704027419<br>iter=2 PI=&nbsp; 3.14704706039194759271<br>iter=2 PI=&nbsp; 3.14878016264498050703<br>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .<br>iter=31 PI=&nbsp; 3.14043288851808988227<br>iter=31 PI=&nbsp; 3.13819662754643458058<br>iter=31 PI=&nbsp; 3.13590876055235634468<br>iter=31 PI=&nbsp; 3.14159402402260345966<br>iter=31 PI=&nbsp; 3.13982221725275323365<br>iter=31 PI=&nbsp; 3.14042428751435309664<br>iter=31 PI=&nbsp; 3.14061350959656992998<br>iter=31 PI=&nbsp; 3.13949537911074205709<br>PI=&nbsp; 3.14159402402260345966 error=1.37043e-06</td></tr></tbody></table></b></b><b><b><p style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none; display: inline !important;"></span></p><p style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="left"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none; display: inline !important;"></span></p><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" width="100%" size="2"><h3 style="color: rgb(0, 0, 0); font-family: Times; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI Cluster Access</h3><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; width: 1119px; height: 2px;"><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: center;"><span style="font-weight: bold;">Example OpenMPI hostfile<br></span><div align="left"><span style="font-weight: bold;"># This is an example hostfile.&nbsp; Comments begin with #<br>#<br># The following node is a single processor machine:<br>foo.example.com<br>&nbsp;<br># The following node is a dual-processor machine:<br>bar.example.com slots=2<br>&nbsp;<br># The following node is a quad-processor machine, and we<br># want to disallow over-subscribing it:<br>yow.example.com slots=4 max-slots=4</span></div></div></b></b><br><b><b><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; width: 1119px; height: 2px;"></b></b><b><b><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>Sample Typed Message Send/Receives<br></b><br><table width="100%" cellspacing="2" cellpadding="2" border="2"><tbody><tr><td valign="top">#include &lt;mpi.h&gt;<br>#include &lt;stdio.h&gt;<br>#include &lt;stddef.h&gt;<br><br>typedef struct _test {<br>&nbsp; double x;<br>&nbsp; char y;<br>&nbsp; int z[5];<br>} Test;<br><br>int main(int argc, char *argv[]) {<br>&nbsp; int rank, number, i;<br>&nbsp; int vec10[10];<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Status</b><span class="Apple-converted-space">&nbsp;</span>status;<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Datatype</b><span class="Apple-converted-space">&nbsp;</span>tVec10;<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Datatype</b><span class="Apple-converted-space">&nbsp;</span>tVec10_2;<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Datatype</b><span class="Apple-converted-space">&nbsp;</span>tStruct;<br>&nbsp; int blengths[] = {1,1,5};<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Aint</b><span class="Apple-converted-space">&nbsp;</span>disps[] = {0, offsetof(Test, y), offsetof(Test, z)};<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Datatype</b><span class="Apple-converted-space">&nbsp;</span>types[] = {MPI_DOUBLE, MPI_CHAR, MPI_INT};<br>&nbsp; Test test;<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Init</b>(&amp;argc, &amp;argv);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_rank</b>(MPI_COMM_WORLD, &amp;rank);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Type_contiguous</b>(10, MPI_INT, &amp;tVec10);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Type_commit</b>(&amp;tVec10);<br>// 3 groups of 2 each separated by 4 elements<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Type_vector</b>(3, 2, 4, MPI_INT, &amp;tVec10_2);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Type_commit</b>(&amp;tVec10_2);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Type_create_struct</b>(3, blengths, disps, types,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;tStruct);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Type_commit</b>(&amp;tStruct);<br>&nbsp; if (rank == 0) {<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Type_size</b>(tVec10, &amp;number);<br>&nbsp;&nbsp;&nbsp; printf("size of int[10]=%d\n", number);<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Type_size</b>(tVec10_2, &amp;number);<br>&nbsp;&nbsp;&nbsp; printf("size of 3 blocks of 2 from int[10]=%d\n", number);<br>&nbsp;&nbsp;&nbsp; for (i=0; i&lt;10; i++) vec10[i] = i+1;<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Send</b>(vec10, 1, tVec10, 1, 99, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Send</b>(vec10, 1, tVec10_2, 1, 99, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Send</b>(vec10, 1, tVec10_2, 1, 99, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp; test.x = 5.999;&nbsp; test.y = 'U';<br>&nbsp;&nbsp;&nbsp; for (i=0; i&lt;5; i++) test.z[i] = i+1;<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Send</b>(&amp;test, 1, tStruct, 1, 99, MPI_COMM_WORLD);<br>&nbsp; } else {<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Recv</b>(vec10, 1, tVec10, 0, 99, MPI_COMM_WORLD, &amp;status);<br>&nbsp;&nbsp;&nbsp; printf("vec10=");<br>&nbsp;&nbsp;&nbsp; for (i=0; i&lt;10; i++) printf("%d ", vec10[i]);<br>&nbsp;&nbsp;&nbsp; printf("\n");<br>&nbsp;&nbsp;&nbsp; for (i=0; i&lt;10; i++) vec10[i] = 99;<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Recv</b>(vec10, 1, tVec10_2, 0, 99, MPI_COMM_WORLD, &amp;status);<br>&nbsp;&nbsp;&nbsp; printf("vec10_2 gather-scatter=");<br>&nbsp;&nbsp;&nbsp; for (i=0; i&lt;10; i++) printf("%d ", vec10[i]);<br>&nbsp;&nbsp;&nbsp; printf("\n");<br>&nbsp;&nbsp;&nbsp; for (i=0; i&lt;10; i++) vec10[i] = 99;<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Recv</b>(vec10, 6, MPI_INT, 0, 99, MPI_COMM_WORLD, &amp;status);<br>&nbsp;&nbsp;&nbsp; printf("vec10_2 gather-gather=");<br>&nbsp;&nbsp;&nbsp; for (i=0; i&lt;10; i++) printf("%d ", vec10[i]);<br>&nbsp;&nbsp;&nbsp; printf("\n");<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Recv</b>(&amp;test, 1, tStruct, 0, 99, MPI_COMM_WORLD, &amp;status);<br>&nbsp;&nbsp;&nbsp; printf("struct = %lg %c %d %d %d %d %d\n",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; test.x, test.y, test.z[0], test.z[1], test.z[2], test.z[3], test.z[4]);<br>&nbsp; }<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Type_free</b>(&amp;tVec10);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Type_free</b>(&amp;tVec10_2);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Type_free</b>(&amp;tStruct);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Finalize</b>();<br>&nbsp; return 0;<br>}<br><b>OUTPUT<br></b>$ mpirun -np 2 a.out<br>size of int[10]=40<br>size of 3 blocks of 2 from int[10]=24<br>vec10=1 2 3 4 5 6 7 8 9 10 <br>vec10_2 gather-scatter=1 2 99 99 5 6 99 99 9 10 <br>vec10_2 gather-gather=1 2 5 6 9 10 99 99 99 99 <br>struct = 5.999 U 1 2 3 4 5<b><br></b></td></tr></tbody></table></div><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>3x3 Sub-Arrays<br></b><br><table width="100%" cellspacing="2" cellpadding="2" border="2"><tbody><tr><td valign="top">#include &lt;stdio.h&gt;<br>#include &lt;stdlib.h&gt;<br>#include &lt;string.h&gt;<br>#include &lt;mpi.h&gt;<br><br>#define N 3*4<br>void print(int *data, int n, char str[]);<br><br>int main(int argc, char **argv) {<br>&nbsp;&nbsp;&nbsp; int rank, size, i, j;<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Init</b>(&amp;argc, &amp;argv);<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_rank</b>(MPI_COMM_WORLD, &amp;rank);<br>&nbsp;&nbsp;&nbsp; if (rank == 0) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int array[N][N];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i=0; i&lt;N; i++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (j=0; j&lt;N; j++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; array[i][j] = i*N+j;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print(&amp;array[0][0], N, " Sender: array[N][N] ");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Datatype</b><span class="Apple-converted-space">&nbsp;</span>subarray;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int starts[2] = {0,0};<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int subsizes[2]&nbsp; = {N/4,N/4};<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int sizes[2]&nbsp; = {N, N};<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Type_create_subarray</b>(2, sizes, subsizes, starts,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MPI_ORDER_C, MPI_INT, &amp;subarray);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Type_commit</b>(&amp;subarray);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Send</b>(&amp;array[0][0], 1, subarray, 1, 99, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Send</b>(&amp;array[4][4], 1, subarray, 1, 99, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Type_free</b>(&amp;subarray);<br>&nbsp;&nbsp;&nbsp; } else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int subarray[N/4][N/4];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memset(&amp;subarray[0][0], 0, sizeof(subarray));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Recv</b>(&amp;subarray[0][0], N/4*N/4, MPI_INT, 0, 99,<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MPI_COMM_WORLD, MPI_STATUS_IGNORE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print(&amp;subarray[0][0], N/4, " Receiver: Subarray -- after receive");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memset(&amp;subarray[0][0], 0, sizeof(subarray));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Recv</b>(&amp;subarray[0][0], N/4*N/4, MPI_INT, 0, 99,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MPI_COMM_WORLD, MPI_STATUS_IGNORE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print(&amp;subarray[0][0], N/4, " Receiver: Subarray -- after receive");<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Finalize</b>();<br>&nbsp;&nbsp;&nbsp; return 0;<br>}<br><br>void print(int *data, int n, char str[]) {<br>&nbsp;&nbsp;&nbsp; int i, j;<br>&nbsp;&nbsp;&nbsp; printf("-- %s --\n", str);<br>&nbsp;&nbsp;&nbsp; for (i=0; i&lt;n; i++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (j=0; j&lt;n; j++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%3d ", data[i*n+j]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("\n");<br>&nbsp;&nbsp;&nbsp; }<br>}<br><b>OUTPUT</b><br>$ mpirun -np 2 a.out<br>--&nbsp; Sender: array[N][N]&nbsp; --<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><u>0&nbsp;&nbsp; 1&nbsp;&nbsp; 2</u>&nbsp;&nbsp; 3&nbsp;&nbsp; 4&nbsp;&nbsp; 5&nbsp;&nbsp; 6&nbsp;&nbsp; 7&nbsp;&nbsp; 8&nbsp;&nbsp; 9&nbsp; 10&nbsp; 11<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;<u>12&nbsp; 13&nbsp; 14</u>&nbsp; 15&nbsp; 16&nbsp; 17&nbsp; 18&nbsp; 19&nbsp; 20&nbsp; 21&nbsp; 22&nbsp; 23<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;<u>24&nbsp; 25&nbsp; 26</u>&nbsp; 27&nbsp; 28&nbsp; 29&nbsp; 30&nbsp; 31&nbsp; 32&nbsp; 33&nbsp; 34&nbsp; 35<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;36&nbsp; 37&nbsp; 38&nbsp; 39&nbsp; 40&nbsp; 41&nbsp; 42&nbsp; 43&nbsp; 44&nbsp; 45&nbsp; 46&nbsp; 47<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;48&nbsp; 49&nbsp; 50&nbsp; 51&nbsp;<span class="Apple-converted-space">&nbsp;</span><u>52&nbsp; 53&nbsp; 54</u>&nbsp; 55&nbsp; 56&nbsp; 57&nbsp; 58&nbsp; 59<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;60&nbsp; 61&nbsp; 62&nbsp; 63&nbsp;<span class="Apple-converted-space">&nbsp;</span><u>64&nbsp; 65&nbsp; 66</u>&nbsp; 67&nbsp; 68&nbsp; 69&nbsp; 70&nbsp; 71<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;72&nbsp; 73&nbsp; 74&nbsp; 75&nbsp;<span class="Apple-converted-space">&nbsp;</span><u>76&nbsp; 77&nbsp; 78</u>&nbsp; 79&nbsp; 80&nbsp; 81&nbsp; 82&nbsp; 83<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;84&nbsp; 85&nbsp; 86&nbsp; 87&nbsp; 88&nbsp; 89&nbsp; 90&nbsp; 91&nbsp; 92&nbsp; 93&nbsp; 94&nbsp; 95<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;96&nbsp; 97&nbsp; 98&nbsp; 99 100 101 102 103 104 105 106 107<span class="Apple-converted-space">&nbsp;</span><br>108 109 110 111 112 113 114 115 116 117 118 119<span class="Apple-converted-space">&nbsp;</span><br>120 121 122 123 124 125 126 127 128 129 130 131<span class="Apple-converted-space">&nbsp;</span><br>132 133 134 135 136 137 138 139 140 141 142 143<span class="Apple-converted-space">&nbsp;</span><br>--&nbsp; Receiver: Subarray -- after receive --<br>&nbsp; 0&nbsp;&nbsp; 1&nbsp;&nbsp; 2<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;12&nbsp; 13&nbsp; 14<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;24&nbsp; 25&nbsp; 26<span class="Apple-converted-space">&nbsp;</span><br>--&nbsp; Receiver: Subarray -- after receive --<br>&nbsp;52&nbsp; 53&nbsp; 54<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;64&nbsp; 65&nbsp; 66<span class="Apple-converted-space">&nbsp;</span><br>&nbsp;76&nbsp; 77&nbsp; 78</td></tr></tbody></table></div></b></b><br><b><b><hr style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; width: 1119px; height: 2px;"><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-align: center;"><span style="font-weight: bold;">MPI 4x4 Cartesian Square Communicator Grid<br></span>UDLR = (Up Down Left Right)<br><table style="text-align: left; width: 555px; margin-left: auto; margin-right: auto;" cellspacing="2" cellpadding="2" border="2"><tbody><tr><td style="vertical-align: top; text-align: center;">0<br><small>UDLR=12 4 3 1</small><br></td><td style="vertical-align: top; text-align: center;">1<br></td><td style="vertical-align: top; text-align: center;">2<br></td><td style="vertical-align: top; text-align: center;">3<br></td></tr><tr><td style="vertical-align: top; text-align: center;">4<br></td><td style="vertical-align: top; text-align: center;">5<br><small>UDLR=1 9 4 6</small><br></td><td style="vertical-align: top; text-align: center;">6<br></td><td style="vertical-align: top; text-align: center;">7<br></td></tr><tr><td style="vertical-align: top; text-align: center;">8<br></td><td style="vertical-align: top; text-align: center;">9<br></td><td style="vertical-align: top; text-align: center;">10<br><small>UDLR=6 14 9 11</small><br></td><td style="vertical-align: top; text-align: center;">11<br></td></tr><tr><td style="vertical-align: top; text-align: center;">12<br></td><td style="vertical-align: top; text-align: center;">13<br></td><td style="vertical-align: top; text-align: center;">14<br></td><td style="vertical-align: top; text-align: center;">15<br><small>UDLR=11 3 14 12</small><br></td></tr></tbody></table><br></div><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#include &lt;mpi.h&gt;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#include &lt;stdio.h&gt;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#define SIZE 4</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#define UP 0</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#define DOWN 1</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#define LEFT 2</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">#define RIGHT 3</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">int main(int argc, char *argv[]) {</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Init</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(&amp;argc, &amp;argv);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; int numtasks;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; int rank, source, dest, outbuf=0, i, tag=99,</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; inbuf[SIZE],</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; nbrs[SIZE],</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; dims[]={SIZE,SIZE}, //square</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; coords[]={0,0};</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; int periods[]={0,0};</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Request</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;"><span class="Apple-converted-space">&nbsp;</span>reqs[8];</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Comm</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;"><span class="Apple-converted-space">&nbsp;</span>cartcomm;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Comm_size</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(MPI_COMM_WORLD, &amp;numtasks);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; if (numtasks == SIZE*SIZE) {</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Cart_create</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(MPI_COMM_WORLD, 2,</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dims, periods, 0, &amp;cartcomm);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Comm_rank</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(MPI_COMM_WORLD, &amp;rank);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Cart_coords</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(cartcomm, rank, 2, coords);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; printf("rank=%d coord=[%d][%d]\n", rank, coords[0], coords[1]);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Cart_shift</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(cartcomm, 0, 1, &amp;source, &amp;dest);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; nbrs[UP]=source&lt;0 ?rank+(SIZE-1)*SIZE :source;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; nbrs[DOWN]=dest&lt;0 ?rank-(SIZE-1)*SIZE :dest;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Cart_shift</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(cartcomm, 1, 1, &amp;source, &amp;dest);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; nbrs[LEFT]=source&lt;0?rank+(SIZE-1):source;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; nbrs[RIGHT]=dest&lt;0?rank-(SIZE-1):dest;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; outbuf = rank;</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; for (i=UP; i&lt;=RIGHT; i++) {</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dest = nbrs[i];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; source = nbrs[i];</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("rank %d sending to %d reading from %d\n", rank, dest, source);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Isend</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(&amp;outbuf, 1, MPI_INT, dest, tag, cartcomm, &amp;reqs[i]);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Irecv</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(&amp;inbuf[i], 1, MPI_INT, source, tag, cartcomm, &amp;reqs[i+4]);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; }<span class="Apple-converted-space">&nbsp;</span></span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Waitall</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">(8, reqs, MPI_STATUSES_IGNORE);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp; } else</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;&nbsp;&nbsp; printf("Must specify %d processors. Terminating.\n", SIZE*SIZE);</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">&nbsp;<span class="Apple-converted-space">&nbsp;</span></span><b style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI_Finalize</b><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">();</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">}</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold;">OUTPUT</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">$ mpirun -np 16 a.out</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank=1 coord=[0][1]</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 1 sending to 13 reading from 13</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 1 sending to 5 reading from 5</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank=3 coord=[0][3]</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 3 sending to 15 reading from 15</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 3 sending to 7 reading from 7</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 3 sending to 2 reading from 2</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 3 sending to 0 reading from 0</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank=4 coord=[1][0]</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 4 sending to 0 reading from 0</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 4 sending to 8 reading from 8</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 4 sending to 7 reading from 7</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 4 sending to 5 reading from 5</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank=5 coord=[1][1]</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 5 sending to 1 reading from 1</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 5 sending to 9 reading from 9</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 5 sending to 4 reading from 4</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 5 sending to 6 reading from 6</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank=6 coord=[1][2]</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 6 sending to 2 reading from 2</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 6 sending to 10 reading from 10</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 6 sending to 5 reading from 5</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 6 sending to 7 reading from 7</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">. . . . . . . . . . . . . . . . . . . .. . . . .. . .<span class="Apple-converted-space">&nbsp;</span></span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank=0 coord=[0][0]</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 0 sending to 12 reading from 12</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 0 sending to 4 reading from 4</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 0 sending to 3 reading from 3</span><br style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none;">rank 0 sending to 1 reading from 1</span><br><h4 style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Matrix-Vector Multiply</h4><p style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Consider the following program for sequential matrix-vector multiply.&nbsp; An m-n matrix is multiplied by an n-element vector to produce an m-element sum-of-products.<br></p><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>Sequential Matrix-Vector Multiply</b><br><div align="left"># include &lt;stdio.h&gt;<br># include &lt;stdlib.h&gt;<br># include &lt;time.h&gt;<br><br>//Compute a matrix-vector product b = A * x.<br><br>int main ( int argc, char *argv[] ) {<br>&nbsp; double *a, *b, *x, ans;<br>&nbsp; int i, j, k, m, n;<br>&nbsp; long start, stop;<br>&nbsp; m = 4000;&nbsp;&nbsp;&nbsp; n = 400;<br>&nbsp; printf ( "&nbsp; b[%d] = A[%d][%d] * x[%d]\n", m, m,n, n );<br>&nbsp; a = ( double * ) malloc ( m * n * sizeof ( double ) );<br>&nbsp; x = ( double * ) malloc ( n * sizeof ( double ) );<br>&nbsp; b = ( double * ) malloc ( m * sizeof ( double ) );<br>&nbsp; k = 0;<br>&nbsp; for ( i = 0; i &lt; m; i++ ) //set rows to i + 0..n-1<br>&nbsp;&nbsp;&nbsp; for ( j = 0; j &lt; n; j++ ) a[k++] = i+j;<br>&nbsp; for ( j = 0; j &lt; n; j++ ) x[j] = 1;<br>&nbsp; start = clock();<br>&nbsp; for (i = 0; i &lt; m; i++) { //rows<br>&nbsp;&nbsp;&nbsp; ans = 0;<br>&nbsp;&nbsp;&nbsp; for (j = 0; j &lt; n; j++) //columns<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ans += a[i*n+j] * x[j];<br>&nbsp;&nbsp;&nbsp; b[i] = ans;<br>&nbsp; }<br>&nbsp; stop = clock();<br>&nbsp; printf("&nbsp; time=%g secs\n", (float)(stop-start)/CLOCKS_PER_SEC);<br>&nbsp; for ( i = 0; i &lt; 10; i++ ) //result should be m + sum(0, n-1)<br>&nbsp;&nbsp;&nbsp; printf ( "%d %g\n", i, b[i] );<br>&nbsp; for ( i = m-10; i &lt; m; i++ )<br>&nbsp;&nbsp;&nbsp; printf ( "%d %g\n", i, b[i] );<br>&nbsp; free ( b );&nbsp;&nbsp; free ( a );&nbsp;&nbsp; free ( x );<br>&nbsp; return 0;<br>}<br></div></div><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><table width="100%" cellspacing="2" cellpadding="2" border="2"><tbody><tr><td valign="top"># include &lt;math.h&gt;<br># include &lt;mpi.h&gt;<br># include &lt;stdio.h&gt;<br># include &lt;stdlib.h&gt;<br># include &lt;time.h&gt;<br><br>#define MAX_WORK 1<br>#define SYNC<br>#ifdef SYNC<br>#define BCAST(a,b,c,d,e)<span class="Apple-converted-space">&nbsp;</span><b>MPI_Bcas</b>t (a,b,c,d,e)<br>#define SEND(a,b,c,d,e,f)<span class="Apple-converted-space">&nbsp;</span><b>MPI_Send</b>(a,b,c,d,e,f)<br>#else<br>#define BCAST(a,b,c,d,e)<span class="Apple-converted-space">&nbsp;</span><b>MPI_Ibcast</b><span class="Apple-converted-space">&nbsp;</span>(a,b,c,d,e,&amp;request)<br>#define SEND(a,b,c,d,e,f)<span class="Apple-converted-space">&nbsp;</span><b>MPI_Isend</b>(a,b,c,d,e,f,&amp;request)<br>#endif<br><br>int main ( int argc, char *argv[] ) {<br>&nbsp; double *a, *a_row, ans[MAX_WORK], *b, *x, *p, dummy=0;<br>&nbsp; int i, j, k, m, n, r, end;<br>&nbsp; int dest, tag, tag_done;<br>&nbsp; int master = 0, my_id;<br>&nbsp; long start, stop, idlestart, idlesum, idlen;<br>&nbsp; int num_procs, num_rows, num_answers;<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Status</b><span class="Apple-converted-space">&nbsp;</span>status;<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Request</b><span class="Apple-converted-space">&nbsp;</span>request;<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Init</b><span class="Apple-converted-space">&nbsp;</span>( &amp;argc, &amp;argv );<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_rank</b><span class="Apple-converted-space">&nbsp;</span>( MPI_COMM_WORLD, &amp;my_id );<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_size</b><span class="Apple-converted-space">&nbsp;</span>( MPI_COMM_WORLD, &amp;num_procs );<br>&nbsp; if ( my_id == 0 ) {<br>&nbsp;&nbsp;&nbsp; printf ( "&nbsp; Compute matrix-vector product b = A * x.\n" );<br>&nbsp;&nbsp;&nbsp; printf ( "&nbsp; The number of processes is %d.\n", num_procs );<br>&nbsp; }<br>&nbsp; m = 4000;&nbsp;&nbsp; n = 400;&nbsp;&nbsp; tag_done = m + 1;<br>&nbsp; x = ( double * ) malloc ( n * sizeof ( double ) );<br>&nbsp; if ( my_id == master ) {//&nbsp; master process initializes A and X.<br>&nbsp;&nbsp;&nbsp; printf ( "&nbsp; b[%d] = A[%d][%d] * x[%d]\n", m, m,n, n );<br>&nbsp;&nbsp;&nbsp; a = ( double * ) malloc ( m * n * sizeof ( double ) );<br>&nbsp;&nbsp;&nbsp; b = ( double * ) malloc ( m * sizeof ( double ) );<br>&nbsp;&nbsp;&nbsp; k = 0;<br>&nbsp;&nbsp;&nbsp; for ( i = 0; i &lt; m; i++ )<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ( j = 0; j &lt; n; j++ ) a[k++] = i+j;<br>&nbsp;&nbsp;&nbsp; for ( j = 0; j &lt; n; j++ ) x[j] = 1;<br>&nbsp;&nbsp;&nbsp; start = clock();<br>&nbsp; } else { //&nbsp; Workers allocate vector X and MAX_WORK rows of A<br>&nbsp;&nbsp;&nbsp; a_row = ( double * ) malloc ( MAX_WORK*n * sizeof ( double ) );<br>&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp; master broadcasts the vector X<br>&nbsp; BCAST ( x, n, MPI_DOUBLE, master, MPI_COMM_WORLD);<br>&nbsp; if ( my_id == master ) { //&nbsp; master sends row of A to each process<br>&nbsp;&nbsp;&nbsp; num_rows = 0;<br>&nbsp;&nbsp;&nbsp; for ( i = 1; i &lt; num_procs; i++, num_rows+=MAX_WORK ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dest = i;&nbsp;&nbsp;&nbsp; tag = num_rows;&nbsp;&nbsp;&nbsp; k = num_rows * n;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SEND ( a+k, n*MAX_WORK, MPI_DOUBLE, dest, tag, MPI_COMM_WORLD );<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; num_answers = 0;&nbsp;&nbsp; end = 0;<br>&nbsp;&nbsp;&nbsp; for ( ; ;num_rows+=MAX_WORK ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Recv</b><span class="Apple-converted-space">&nbsp;</span>( &amp;ans[0], MAX_WORK, MPI_DOUBLE, MPI_ANY_SOURCE,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MPI_ANY_TAG, MPI_COMM_WORLD, &amp;status );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j = status.MPI_TAG;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Get_count</b>(&amp;status, MPI_DOUBLE, &amp;r);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; num_answers += r;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i = 0; i&lt;r; i++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b[j++] = ans[i];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (num_answers &gt;= m) break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dest = status.MPI_SOURCE;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( num_rows &lt; m ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tag = num_rows;&nbsp;&nbsp;&nbsp; k = num_rows * n;&nbsp;&nbsp;&nbsp; j = m-num_rows;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( j &gt; MAX_WORK) j = MAX_WORK;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SEND ( a+k, n*j, MPI_DOUBLE, dest, tag, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else if (!end) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tag = tag_done;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i = 1; i &lt; num_procs; i++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SEND ( &amp;dummy, 1, MPI_DOUBLE, i, tag, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end = 1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; } //for ;;<br>&nbsp;&nbsp;&nbsp; free ( a );&nbsp;&nbsp;&nbsp; free ( x );<br>&nbsp; } else {<br>//Each worker process repeatedly receives rows of A (with TAG indicating<br>//a matrix row), computes a dot product A(I,0:N-1) * X(0:N-1) and returns<br>//the result (and TAG), until receiving the "DONE" message.<br>&nbsp;&nbsp;&nbsp; idlesum = 0;&nbsp;&nbsp; idlen = 0;&nbsp;&nbsp; idlestart = 0;<br>&nbsp;&nbsp;&nbsp; for ( ; ; ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Recv</b><span class="Apple-converted-space">&nbsp;</span>( a_row, n*MAX_WORK, MPI_DOUBLE, master, MPI_ANY_TAG,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MPI_COMM_WORLD, &amp;status );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (idlestart != 0) {idlesum += clock()-idlestart;&nbsp; idlen++;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tag = status.MPI_TAG;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( tag == tag_done ) break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Get_count</b>(&amp;status, MPI_DOUBLE, &amp;j);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j /= n;&nbsp;&nbsp;&nbsp; r = j;&nbsp;&nbsp;&nbsp; p = a_row;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (j=0; j&lt;r; j++) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ans[j] = 0.0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ( i = 0; i &lt; n; i++ )<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ans[j] += p[i] * x[i];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p += n;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; idlestart = clock();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SEND ( &amp;ans[0], r, MPI_DOUBLE, master, tag, MPI_COMM_WORLD);<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; free ( a_row );&nbsp;&nbsp;&nbsp; free ( x );<br>&nbsp;&nbsp;&nbsp; printf("&nbsp; id=%d idle avg=%g secs\n", my_id, (float)idlesum/idlen/CLOCKS_PER_SEC);<br>&nbsp; }<br>&nbsp; if ( my_id == master ) { //Print out the answer.<br>&nbsp;&nbsp;&nbsp; stop = clock();<br>&nbsp;&nbsp;&nbsp; printf("&nbsp; time=%g secs\n", (float)(stop-start)/CLOCKS_PER_SEC);<br>&nbsp;&nbsp;&nbsp; for ( i = 0; i &lt; 10; i++ )<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf ( "%d %g\n", i, b[i] );<br>&nbsp;&nbsp;&nbsp; for ( i = m-10; i &lt; m; i++ )<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf ( "%d %g\n", i, b[i] );<br>&nbsp;&nbsp;&nbsp; free ( b );<br>&nbsp; }<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Finalize</b><span class="Apple-converted-space">&nbsp;</span>( );<br>&nbsp; return 0;<br>}<br><b>OUTPUT<br></b>$ mpirun -np 4 a.out<br>&nbsp; Compute matrix-vector product b = A * x.<br>&nbsp; The number of processes is 4.<br>&nbsp; b[4000] = A[4000][400] * x[400]<br>&nbsp; id=1 idle avg=2.85725e-06 secs<br>&nbsp; id=2 idle avg=2.86277e-06 secs<br>&nbsp; id=3 idle avg=2.90134e-06 secs<br>&nbsp; time=0.00987 secs<br>0 79800<br>1 80200<br>2 80600<br>3 81000<br>4 81400<br>5 81800<br>6 82200<br>7 82600<br>8 83000<br>9 83400<br>3990 1.6758e+06<br>3991 1.6762e+06<br>3992 1.6766e+06<br>3993 1.677e+06<br>3994 1.6774e+06<br>3995 1.6778e+06<br>3996 1.6782e+06<br>3997 1.6786e+06<br>3998 1.679e+06<br>3999 1.6794e+06<b><br></b></td></tr></tbody></table></div></b></b><b><b><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><br></div><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>OpenMP Parallel Write and Read<br></b><br><div align="center"><table width="100%" cellspacing="2" cellpadding="2" border="2"><tbody><tr><td valign="top">#include &lt;stdio.h&gt;<br>#include &lt;omp.h&gt;<br>#define N 50<br><br>int main(void) { //create a file with 2400 x 50 integers<br>&nbsp; int i, j;<br>&nbsp; FILE *f;<br>&nbsp; f = fopen("test1.txt", "w");<br><b>#pragma omp parallel for private(i, j)</b><br>&nbsp; for (i=0; i&lt;2400; i++) {<br>&nbsp;&nbsp;&nbsp; for (j = 1; j&lt;= N; j++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fprintf(f, " %d ", j);<br>&nbsp;&nbsp;&nbsp; fprintf(f, "\n");<br>&nbsp; }<br>&nbsp; fclose(f);<br>&nbsp; return 0;<br>}<br><b>////////////////////////////////////////////////////////////////////////////////<br></b>#include &lt;stdio.h&gt;<br>#include &lt;omp.h&gt;<br><br>int main(void) { //read a file of integers, print partial sums<br>&nbsp; int i;<br>&nbsp; FILE *f;<br>&nbsp; f = fopen("test1.txt", "r");<br>#pragma omp parallel private(i)<br>{<br>&nbsp; int sum = 0, j;<br>&nbsp; while (1) {<br>&nbsp;&nbsp;&nbsp; j = fscanf(f, "%d", &amp;i);<br>&nbsp;&nbsp;&nbsp; if (j &lt;= 0) break;<br>&nbsp;&nbsp;&nbsp; sum += i;<br>&nbsp; }<br>&nbsp; printf("id=%d sum=%d\n", omp_get_thread_num(), sum);<br>}<br>&nbsp; fclose(f);<br>&nbsp; return 0;<br>}<br><b>OUTPUT</b><br>id=3 sum=858258<br>id=2 sum=30523<br>id=1 sum=1141456<br>id=0 sum=1029763<br></td></tr></tbody></table></div></div><h4 style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">MPI Parallel File I/O</h4><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>Shared File Output</b><br><div align="left">#include &lt;stdio.h&gt;<br>#include &lt;mpi.h&gt;<br>#define N 50<br><br>int main(int argc, char *argv[]) {<br>&nbsp; int i, j, k;<br>&nbsp; FILE *f;<br>&nbsp; int rank, size;<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Init</b>(&amp;argc, &amp;argv);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_rank</b>(MPI_COMM_WORLD, &amp;rank);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_size</b>(MPI_COMM_WORLD, &amp;size);<br>&nbsp; f = fopen("test1.txt", "a");<br>&nbsp; if (f == NULL) printf("id %d can't open file\n", rank);<br>&nbsp; k = 2400 / size;<br>&nbsp; for (i=0; i&lt;k; i++) {<br>&nbsp;&nbsp;&nbsp; for (j = 1; j&lt;= N; j++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fprintf(f, " %d ", j);<br>&nbsp;&nbsp;&nbsp; fprintf(f, "\n");<br>&nbsp; }<br>&nbsp; fclose(f);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Finalize</b>();<br>&nbsp; return 0;<br>}</div></div><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>Collective File I/O</b><br></div><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><table width="100%" cellspacing="2" cellpadding="2" border="2"><tbody><tr><td valign="top">#include &lt;stdio.h&gt;<br>#include &lt;mpi.h&gt;<br>#include &lt;string.h&gt;<br><br>int main(int argc, char *argv[]) {<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File</b><span class="Apple-converted-space">&nbsp;</span>fh;<br>&nbsp; int rank;<br>&nbsp; char buf[] = "0-How now brown cow in a green field?\n";<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Init</b>(&amp;argc,&amp;argv);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_rank</b>(MPI_COMM_WORLD, &amp;rank);<br>&nbsp; buf[0] = '0' + rank + 1;<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File_open</b>(MPI_COMM_WORLD, "test2.txt",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MPI_MODE_CREATE | MPI_MODE_WRONLY, MPI_INFO_NULL, &amp;fh);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File_write_shared</b>(fh, buf, strlen(buf), MPI_CHAR, MPI_STATUS_IGNORE);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File_close</b>(&amp;fh);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Finalize</b>();<br>&nbsp; return 0;<br>}<br><b>OUTPUT<br></b>$ mpirun -np 4 a.out<br>$ cat test2.txt<br>2-How now brown cow in a green field?<br>1-How now brown cow in a green field?<br>3-How now brown cow in a green field?<br>4-How now brown cow in a green field?<br></td></tr></tbody></table></div></b></b></h2><h2><b><b><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;" align="center"><b>MPI Merge Sort Example<br></b><br><div align="center"><table width="100%" cellspacing="2" cellpadding="2" border="2"><tbody><tr><td valign="top">#include &lt;stdio.h&gt;<br>#include &lt;stdlib.h&gt;<br>#include &lt;mpi.h&gt;<br>#include &lt;string.h&gt;<br><br>#define N 32<br>#define BSIZE 4<br><br>int intcmp(const void *left, const void *right) {<br>&nbsp; const int *l = left, *r = right;<br>&nbsp; if (*l == *r) return 0;<br>&nbsp; return *l &lt; *r ? -1 : +1;<br>}<br><br>int main(int argc, char *argv[]) {<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File</b><span class="Apple-converted-space">&nbsp;</span>fin, ft1, f_in, f_out, ft;<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Status</b><span class="Apple-converted-space">&nbsp;</span>status;<br>&nbsp; int rank, size;<br>&nbsp; int i, j, k, n, r, s, t;<br>&nbsp; int buf[N];<br>&nbsp; int buf2[N];<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Init</b>(&amp;argc,&amp;argv);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_rank</b>(MPI_COMM_WORLD, &amp;rank);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Comm_size</b>(MPI_COMM_WORLD, &amp;size);<br>&nbsp; n = N / BSIZE;<br>&nbsp; if (rank &gt;= n) {<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Finalize</b>(); return 0;<br>&nbsp; }<br>&nbsp; if (size &gt; n) size = n;<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File_open</b>(MPI_COMM_WORLD, "input.bin",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MPI_MODE_CREATE|MPI_MODE_RDWR, MPI_INFO_NULL, &amp;fin);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File_open</b>(MPI_COMM_WORLD, "temp1.bin",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MPI_MODE_CREATE|MPI_MODE_RDWR, MPI_INFO_NULL, &amp;ft1);<br><b>// CREATE INPUT FILE OF SORTED BUFFERS IN PARALLEL</b><br>&nbsp; for (i=rank; i &lt; n; i+=size) {<br>&nbsp;&nbsp;&nbsp; for (k=0; k &lt; BSIZE; k++) buf[k] = rand()%N;<br>&nbsp;&nbsp;&nbsp; qsort(buf, BSIZE, sizeof(int), intcmp);<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File_write_at</b>(fin, i*BSIZE*4, buf, BSIZE, MPI_INT, MPI_STATUS_IGNORE);<br>&nbsp; }<br>//<b>EACH RANK READS 2 SORTED SEQUENCES<br>//MERGES THEM, THEN WRITES<br></b>j = 1; f_in = fin;&nbsp; f_out = ft1;<br>for ( ; n &gt; 1; ) {<br>&nbsp;&nbsp;&nbsp; j += j;&nbsp;&nbsp; n /= 2;<br>&nbsp;&nbsp;&nbsp; for (i=rank; i&lt;n; i+=size) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File_read_at</b>(f_in, i*BSIZE*4*j, buf, BSIZE*j, MPI_INT, &amp;status);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Get_count</b>(&amp;status, MPI_INT, &amp;k);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%d %d ", rank, k);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (r=0; r&lt;k; r++) printf("%d ", buf[r]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("\n");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; r = 0;&nbsp;&nbsp; s = BSIZE*(j/2);&nbsp; t = 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ( ;; ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (buf[r] &lt;= buf[s]) buf2[t++] = buf[r++];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else buf2[t++] = buf[s++];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (r &gt;= (j/2)*BSIZE) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File_write_at</b>(f_out, i*BSIZE*4*j, buf2, BSIZE*(j/2)+s-(BSIZE*(j/2)), MPI_INT, MPI_STATUS_IGNORE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File_write_at</b>(f_out, i*BSIZE*4*j+s*4, buf+s, BSIZE*j-s, MPI_INT, MPI_STATUS_IGNORE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else if (s &gt;= j*BSIZE) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File_write_at</b>(f_out, i*BSIZE*4*j, buf2, BSIZE*(j/2)+r, MPI_INT, MPI_STATUS_IGNORE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File_write_at</b>(f_out, i*BSIZE*4*j+(BSIZE*(j/2)+r)*4, buf+r, BSIZE*(j/2)-r, MPI_INT, MPI_STATUS_IGNORE);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //for ;;<br>&nbsp;&nbsp;&nbsp; } //for i<br>&nbsp;&nbsp;&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Barrier</b>(MPI_COMM_WORLD);<br><b>//SWAP INPUT AND OUTPUT FILES</b><br>&nbsp;&nbsp;&nbsp; ft = f_in;&nbsp; f_in = f_out;&nbsp; f_out = ft;<br>}<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File_close</b>(&amp;fin);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_File_close</b>(&amp;ft1);<br>&nbsp;<span class="Apple-converted-space">&nbsp;</span><b>MPI_Finalize</b>();<br>&nbsp; return 0;<br>}<br><b>OUTPUT</b><br>$mpirun -np 3 a.out<br>rank N<br>0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8 <br>7 10 17 25 &nbsp; &nbsp; 7 10 17 25<span class="Apple-converted-space">&nbsp;</span><br>1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8 <br>7 10 17 25&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp; 8 24 30<span class="Apple-converted-space">&nbsp;</span><br>2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8 <br>2&nbsp;&nbsp; 8 24 30&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp; 8 24 30<span class="Apple-converted-space">&nbsp;</span><br>0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8 <br>3 13 21 24&nbsp;&nbsp;&nbsp;&nbsp; 3 13 21 24<span class="Apple-converted-space"><br>&nbsp;</span><br>1&nbsp;&nbsp;&nbsp; 16 <br>2 2 8 8 24 24 30 30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3 3 13 13 21 21 24 24<span class="Apple-converted-space">&nbsp;</span><br>0&nbsp;&nbsp;&nbsp; 16 <br>7 7 10 10 17 17 25 25&nbsp;&nbsp; 2 7 8 10 17 24 25 30<span class="Apple-converted-space"><br>&nbsp;</span><br>0&nbsp;&nbsp;&nbsp; 32 <br>2 7 7 7 8 10 10 10 17 17 17 24 25 25 25 30<span class="Apple-converted-space">&nbsp;</span><br>2 2 3 3 8&nbsp;&nbsp; 8 13 13 21 21 24 24 24 24 30 30<br><br></td></tr></tbody></table></div></div></b></b></h2><hr width="100%" size="2"><h1 align="center"><b><b><a name="r81"></a>CHAPTER EIGHT<br>DISTRIBUTED PROGRAMMING<br></b></b></h1><br><hr width="100%" size="2">
          <div align="center"><b>LDAP Example Entry</b><br>
          </div>
          dn: uid=person5,ou=People,dc=siro,dc=com<br>
          cn: Bob<br>
          sn: person5<br>
          givenname: Cook<br>
          objectclass: top<br>
          objectclass: person<br>
          objectclass: organizationalPerson<br>
          objectclass: inetOrgPerson<br>
          ou: Product Development<br>
          ou: People<br>
          l: Savannah<br>
          uid: person5<br>
          mail: person5@siro.com<br>
          telephonenumber: 123-838-9384<br>
          facsimiletelephonenumber: 598-054-3814<br>
          roomnumber: 76<br>
          userpassword: secret<br>
          <div align="center"><b>LDAP Example SubClass</b><br>
          </div>
          objectclass ( 1.1.2.2.2 NAME 'myPerson'<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          DESC 'my person'<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          SUP inetOrgPerson<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          MUST ( myUniqueName $ givenName )<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          MAY myPhoto<br>
          &nbsp;)<br><hr width="100%" size="2"> <b>dig</b> google.com<br>
          OUTPUT<br>
          ; &lt;&lt;&gt;&gt; DiG 9.4.1-P1 &lt;&lt;&gt;&gt; google.com<br>
          ;; global options:&nbsp; printcmd<br>
          ;; Got answer:<br>
          ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR,
          id: 35910<br>
          ;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 4,
          ADDITIONAL: 4<br>
          <br>
          ;; QUESTION SECTION:<br>
          ;google.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A<br>
          <br>
          ;; ANSWER SECTION:<br>
          google.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          76&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 72.14.207.99<br>
          google.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          76&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 64.233.167.99<br>
          google.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          76&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 64.233.187.99<br>
          <br>
          ;; AUTHORITY SECTION:<br>
          google.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          57421&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ns2.google.com.<br>
          google.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          57421&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ns3.google.com.<br>
          google.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          57421&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ns4.google.com.<br>
          google.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          57421&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ns1.google.com.<br>
          <br>
          ;; ADDITIONAL SECTION:<br>
          ns1.google.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
63718&nbsp;&nbsp;

          IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 216.239.32.10<br>
          ns2.google.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
67964&nbsp;&nbsp;

          IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 216.239.34.10<br>
          ns3.google.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
67964&nbsp;&nbsp;

          IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 216.239.36.10<br>
          ns4.google.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
67964&nbsp;&nbsp;

          IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 216.239.38.10<br>
          <br>
          ;; Query time: 48 msec<br>
          ;; SERVER: 192.168.2.1#53(192.168.2.1)<br>
          ;; WHEN: Mon Jul&nbsp; 7 19:10:47 2008<br>
          ;; MSG SIZE&nbsp; rcvd: 212<br>
          <br>
          <b>ping</b> beijing.gov.cn<br>
          OUTPUT<br>
          PING beijing.gov.cn 210.73.64.10): 56 data bytes<br>
          64 bytes from 210.73.64.10: icmp_seq=0 ttl=28 time=295.921 ms<br>
          64 bytes from 210.73.64.10: icmp_seq=1 ttl=28 time=362.758 ms<br>
          64 bytes from 210.73.64.10: icmp_seq=2 ttl=28 time=363.773 ms<br>
          64 bytes from 210.73.64.10: icmp_seq=3 ttl=28 time=302.391 ms<br>
          --- beijing.gov.cn ping statistics ---<br>
          6 packets transmitted, 6 packets received, 0% packet loss<br>
          round-trip min/avg/max/stddev = 295.406/330.393/363.773/32.568
          ms <br>
          <br>
          <b>traceroute</b> beijing.gov.cn<br>
          OUTPUT<br>
          traceroute to beijing.gov.cn (210.73.64.10), 64 hops max, 40
          byte packets<br>
          &nbsp;1&nbsp; 192.168.2.1 (192.168.2.1)&nbsp; 3.304 ms&nbsp;
          3.245 ms&nbsp; 2.730 ms<br>
          &nbsp;2&nbsp; 10.18.248.1 (10.18.248.1)&nbsp; 13.721 ms&nbsp;
          15.219 ms&nbsp; 13.098 ms<br>
          &nbsp;3&nbsp; 10.1.1.1 (10.1.1.1)&nbsp; 13.316 ms&nbsp; 13.556
          ms&nbsp; 14.081 ms<br>
          &nbsp;4&nbsp; 10.0.0.1 (10.0.0.1)&nbsp; 25.626 ms&nbsp; 13.926
          ms&nbsp; 26.849 ms<br>
          &nbsp;5&nbsp; 12.126.150.125 (12.126.150.125)&nbsp; 31.170
          ms&nbsp; 33.706 ms&nbsp; 37.083 ms<br>
          &nbsp;6&nbsp; tbr1.attga.ip.att.net (12.122.96.22)&nbsp;
          83.687 ms&nbsp; 83.429 ms&nbsp; 84.290 ms<br>
          &nbsp;7&nbsp; cr1.attga.ip.att.net (12.122.17.33)&nbsp; 85.734
          ms&nbsp; 87.206 ms&nbsp; 81.355 ms<br>
          &nbsp;8&nbsp; cr2.dlstx.ip.att.net (12.122.28.174)&nbsp;
          85.103 ms&nbsp; 86.173 ms&nbsp; 83.331 ms<br>
          &nbsp;9&nbsp; cr2.la2ca.ip.att.net (12.122.28.178)&nbsp;
          83.215 ms&nbsp; 84.655 ms&nbsp; 84.102 ms<br>
          10&nbsp; tbr2.la2ca.ip.att.net (12.122.19.222)&nbsp; 82.991
          ms&nbsp; 101.769 ms&nbsp; 85.363 ms<br>
          11&nbsp; ggr2.la2ca.ip.att.net (12.123.222.37)&nbsp; 83.869
          ms&nbsp; 90.631 ms&nbsp; 83.642 ms<br>
          12&nbsp; 192.205.35.82 (192.205.35.82)&nbsp; 86.315 ms&nbsp;
          80.933 ms&nbsp; 87.029 ms<br>
          13&nbsp; 202.97.51.61 (202.97.51.61)&nbsp; 300.170 ms&nbsp;
          306.871 ms&nbsp; 293.511 ms<br>
          14&nbsp; 202.97.53.29 (202.97.53.29)&nbsp; 291.485 ms&nbsp;
          293.141 ms&nbsp; 292.512 ms<br>
          15&nbsp; 202.97.57.218 (202.97.57.218)&nbsp; 311.458 ms&nbsp;
          298.345 ms&nbsp; 302.458 ms<br>
          . . . . . . . . . . . .
          <hr style="width: 100%; height: 2px;"><hr width="100%" size="2">
          <div align="center"><b>Berkeley Socket API</b><br>
          </div>
          #include &lt;unistd.h&gt;<br>
          #include &lt;netdb.h&gt;<br>
          int <b>gethostname</b>(char name[], size_t namelen);<br>
          int <b>sethostname</b>(const char name[], int namelen);<br>
          struct hostent *<b>gethostbyname</b>(const char name[]);<br>
          char *<b>inet_ntoa</b>(struct in_addr in);<br>
          in_addr_t <b>inet_addr</b>(const char *cp);<br>
          <div align="center"><b>Host Name Example</b><br>
          </div>
          #include &lt;stdio.h&gt;<br>
          #include &lt;string.h&gt;<br>
          #include &lt;unistd.h&gt;<br>
          #include &lt;netdb.h&gt;<br>
          <br>
          int main(int argc, char *argv[])&nbsp; {<br>
          char s[100];<br>
          struct hostent *h;<br>
          struct in_addr a;<br>
          <span style="font-weight: bold;">gethostname</span>(s,sizeof(s));<br>
          printf("%s\n",s);<br>
          h=<span style="font-weight: bold;">gethostbyname</span>("ibm.com");<br>
          memcpy(&amp;a, h-&gt;h_addr_list[0], sizeof(struct in_addr));<br>
          printf("%s\n", <span style="font-weight: bold;">inet_ntoa</span>(a));<br>
          printf("0x%0lx\n",&nbsp; <span style="font-weight: bold;">inet_addr</span>("129.42.19.99"));<br>
          }<br>
          <b>OUTPUT</b><br>
          Macintosh.local<br>
          129.42.16.103<br>
          0x63132a81<br><div align="center"><hr width="100%" size="2"><b>WWW Server<br>
            </b></div>
          <br>
          #include &lt;stdio.h&gt;<br>
          #include &lt;string.h&gt;<br>
          #include &lt;netdb.h&gt;<br>
          #include &lt;sys/types.h&gt;<br>
          #include &lt;sys/socket.h&gt; <br>
          /* Run the code until it stops at the <b>accept</b>. Then
          start a web browser and enter http://localhost/index.html The
          program should print the content of the HTTP (hypertext
          transfer protocol) GET packet. If port 80 is already in use or
          protected, use public port 1080 in the program and try telnet
          localhost 1080.&nbsp; The program should output the first line
          entered. */<br>
          int main(int argc, char *argv[])&nbsp; {<br>
          int i; char str[1024]; int s, news;<br>
          unsigned int j;<br>
          struct sockaddr_in si;<br>
          struct hostent *h;<br>
          s = <b>socket</b>(AF_INET, SOCK_STREAM, IPPROTO_TCP);<br>
          memset(&amp;si, 0, sizeof(si));<br>
          h = <b>gethostbyname</b>("localhost");<br>
          memcpy(&amp;si.sin_addr, h-&gt;h_addr_list[0], sizeof(struct
          in_addr));<br>
          si.sin_port = htons(80);<br>
          si.sin_family = AF_INET;<br>
          i = <b>bind</b>(s,(const struct sockaddr *)&amp;si,
          sizeof(si));<br>
          <b>listen</b>(s,5);<br>
          j = sizeof(si);<br>
          news = <b>accept</b>(s, (struct sockaddr *)&amp;si, &amp;j);<br>
          if (news &gt; 0) {<br>
          &nbsp;&nbsp; i = <b>recv</b>(news, str, sizeof(str), 0);<br>
          &nbsp;&nbsp; str[i] = 0;&nbsp; /* C/C++ strings end with '\0'
          */<br>
          &nbsp;&nbsp; printf("%s\n", str);<br>
          &nbsp;&nbsp; <span style="font-weight: bold;"></span><b>close</b>(news);<br>
          }<br>
          <b>close</b>(s);<br>
          }<br>
          <div align="center"><b>WWW Client</b><br>
          </div>
          <br>
          #include &lt;stdio.h&gt;<br>
          #include &lt;string.h&gt;<br>
          #include &lt;netdb.h&gt;<br>
          #include &lt;sys/types.h&gt;<br>
          #include &lt;sys/socket.h&gt;<br>
          /* Implements a very simple web page grabber. The program
          should print the HTML for the index page at any web site. */<br>
          int main(int argc, char *argv[])&nbsp; {<br>
          int i, s; char str[1024];<br>
          char msg[] = "GET&nbsp; /&nbsp;&nbsp; HTTP/1.0\r\nHost:
          www.paris.fr\r\nConnection: close\r\n\r\n";<br>
          struct sockaddr_in si;<br>
          struct hostent *h = <span style="font-weight: bold;">gethostbyname</span>("paris.fr");<br>
          s = <span style="font-weight: bold;">socket</span>(AF_INET,
          SOCK_STREAM, IPPROTO_TCP);<br>
          memset(&amp;si, 0, sizeof(si));<br>
          memcpy(&amp;si.sin_addr, h-&gt;h_addr_list[0], sizeof(struct
          in_addr));<br>
          si.sin_port = <span style="font-weight: bold;">htons</span>(80);<br>
          si.sin_family = AF_INET;<br>
          i = <span style="font-weight: bold;">connect</span>(s, (const
          struct sockaddr *) &amp;si, sizeof(si));<br>
          i = <span style="font-weight: bold;">send</span>(s,msg,
          sizeof(msg), 0);<br>
          i = <span style="font-weight: bold;">recv</span>(s, str,
          sizeof(str), 0);<br>
          if (i &gt; 0) {<br>
          &nbsp;&nbsp; str[i] = 0;&nbsp; /* ALL C/C++ strings must end
          with '\0' */<br>
          &nbsp;&nbsp; printf("%s\n", str);<br>
          }<br>
          close(s);<br>
          }<br><hr><mbp:section></mbp:section>
          <center>
            <h1><b><a name="r91"></a>CHAPTER NINE</b><b><br>CLOUD COMPUTING</b><br><b>
              </b>
          </h1></center><hr style="width: 100%; height: 2px;">
          <div style="text-align: center;"><span style="font-weight:
              bold;">Hadoop Word Count Example</span><br>
          </div>
          <div dir="ltr" id="content" lang="en">
            <div dir="ltr" class="codearea" lang="en">
              <pre dir="ltr" id="CA-accaa18325556917dbf32faa4ccdf53265458c8e" lang="en"><span class="line"><span class="ResWord">import</span> <span class="ID">java</span><span class="SPChar">.</span><span class="ID">io</span><span class="SPChar">.</span><span class="ID">IOException</span><span class="SPChar">;</span></span><br><span class="line"><span class="ResWord">import</span> <span class="ID">java</span><span class="SPChar">.</span><span class="ID">util</span><span class="SPChar">.</span><span class="SPChar">*</span><span class="SPChar">;</span></span><br><span class="line">        </span><br><span class="line"><span class="ResWord">import</span> <span class="ID">org</span><span class="SPChar">.</span><span class="ID">apache</span><span class="SPChar">.</span><span class="ID">hadoop</span><span class="SPChar">.</span><span class="ID">fs</span><span class="SPChar">.</span><span class="ID">Path</span><span class="SPChar">;</span></span><br><span class="line"><span class="ResWord">import</span> <span class="ID">org</span><span class="SPChar">.</span><span class="ID">apache</span><span class="SPChar">.</span><span class="ID">hadoop</span><span class="SPChar">.</span><span class="ID">conf</span><span class="SPChar">.</span><span class="SPChar">*</span><span class="SPChar">;</span></span><br><span class="line"><span class="ResWord">import</span> <span class="ID">org</span><span class="SPChar">.</span><span class="ID">apache</span><span class="SPChar">.</span><span class="ID">hadoop</span><span class="SPChar">.</span><span class="ID">io</span><span class="SPChar">.</span><span class="SPChar">*</span><span class="SPChar">;</span></span><br><span class="line"><span class="ResWord">import</span> <span class="ID">org</span><span class="SPChar">.</span><span class="ID">apache</span><span class="SPChar">.</span><span class="ID">hadoop</span><span class="SPChar">.</span><span class="ID">mapred</span><span class="SPChar">.</span><span class="SPChar">*</span><span class="SPChar">;</span></span><br><span class="line"><span class="ResWord">import</span> <span class="ID">org</span><span class="SPChar">.</span><span class="ID">apache</span><span class="SPChar">.</span><span class="ID">hadoop</span><span class="SPChar">.</span><span class="ID">util</span><span class="SPChar">.</span><span class="SPChar">*</span><span class="SPChar">;</span></span><br><span class="line">        </span><br><span class="line"><span class="ResWord">public</span> <span class="ResWord">class</span> <span class="ID">WordCount</span> <span class="SPChar">{</span></span><span class="line">        </span><br><span class="line"><span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">class</span> <span class="ID">Map</span><br>  <span class="ResWord">extends</span> <span class="ID">MapReduceBase</span><br>  <span class="ResWord">implements</span> <span class="ID">Mapper</span><span class="SPChar">&lt;</span><span class="ID">LongWritable</span><span class="SPChar">,</span> <span class="ID">Text</span><span class="SPChar">,</span> <span class="ID">Text</span><span class="SPChar">,</span> <span class="ID">IntWritable</span><span class="SPChar">&gt;</span> <span class="SPChar">{</span></span><br><span class="line"><span class="ResWord">private</span> <span class="ResWord">final</span> <span class="ResWord">static</span> <span class="ID">IntWritable</span> <span class="ID">one</span> <span class="SPChar">=</span> <span class="ResWord">new</span> <span class="ID">IntWritable</span><span class="SPChar">(</span><span class="Number">1</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line"><span class="ResWord">private</span> <span class="ID">Text</span> <span class="ID">word</span> <span class="SPChar">=</span> <span class="ResWord">new</span> <span class="ID">Text</span><span class="SPChar">(</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line">        </span><br><span class="line"><span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">map</span><span class="SPChar">(</span><span class="ID">LongWritable</span> <span class="ID">key</span><span class="SPChar">,</span> <span class="ID">Text</span> <span class="ID">value</span><span class="SPChar">,</span><br>  <span class="ID">OutputCollector</span><span class="SPChar">&lt;</span><span class="ID">Text</span><span class="SPChar">,</span> <span class="ID">IntWritable</span><span class="SPChar">&gt;</span> <span class="ID">output</span><span class="SPChar">,</span><br>  <span class="ID">Reporter</span> <span class="ID">reporter</span><span class="SPChar">)</span> <span class="ResWord">throws</span> <span class="ID">IOException</span> <span class="SPChar">{</span></span><br><span class="line"><span class="ID">String</span> <span class="ID">line</span> <span class="SPChar">=</span> <span class="ID">value</span><span class="SPChar">.</span><span class="ID">toString</span><span class="SPChar">(</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line"><span class="ID">StringTokenizer</span> <span class="ID">tokenizer</span> <span class="SPChar">=</span> <span class="ResWord">new</span> <span class="ID">StringTokenizer</span><span class="SPChar">(</span><span class="ID">line</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line"><span class="ResWord">while</span> <span class="SPChar">(</span><span class="ID">tokenizer</span><span class="SPChar">.</span><span class="ID">hasMoreTokens</span><span class="SPChar">(</span><span class="SPChar">)</span><span class="SPChar">)</span> <span class="SPChar">{</span></span><br><span class="line">  <span class="ID">word</span><span class="SPChar">.</span><span class="ID">set</span><span class="SPChar">(</span><span class="ID">tokenizer</span><span class="SPChar">.</span><span class="ID">nextToken</span><span class="SPChar">(</span><span class="SPChar">)</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line">  <span class="ID">output</span><span class="SPChar">.</span><span class="ID">collect</span><span class="SPChar">(</span><span class="ID">word</span><span class="SPChar">,</span> <span class="ID">one</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line"><span class="SPChar">}</span></span> //while<br><span class="line"><span class="SPChar">}</span></span><br><span class="line"><span class="SPChar">}</span> </span><br><span class="line">        </span><br><span class="line"><span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">class</span> <span class="ID">Reduce</span> <span class="ResWord"><br>  extends</span> <span class="ID">MapReduceBase</span> <span class="ResWord"><br>  implements</span> <span class="ID">Reducer</span><span class="SPChar">&lt;</span><span class="ID">Text</span><span class="SPChar">,</span> <span class="ID">IntWritable</span><span class="SPChar">,</span> <span class="ID">Text</span><span class="SPChar">,</span> <span class="ID">IntWritable</span><span class="SPChar">&gt;</span> <span class="SPChar">{</span></span><br><span class="line"></span><br><span class="line"><span class="ResWord">public</span> <span class="ResWord">void</span> <span class="ID">reduce</span><span class="SPChar">(</span><span class="ID">Text</span> <span class="ID">key</span><span class="SPChar">,</span> <span class="ID">Iterator</span><span class="SPChar">&lt;</span><span class="ID">IntWritable</span><span class="SPChar">&gt;</span> <span class="ID">values</span><span class="SPChar">,</span><br>                <span class="ID">OutputCollector</span><span class="SPChar">&lt;</span><span class="ID">Text</span><span class="SPChar">,</span> <span class="ID">IntWritable</span><span class="SPChar">&gt;</span> <span class="ID">output</span><span class="SPChar">,</span><br>                <span class="ID">Reporter</span> <span class="ID">reporter</span><span class="SPChar">)</span> <span class="ResWord">throws</span> <span class="ID">IOException</span> <span class="SPChar">{</span></span><br><span class="line"><span class="ResWord">int</span> <span class="ID">sum</span> <span class="SPChar">=</span> <span class="Number">0</span><span class="SPChar">;</span></span><br><span class="line"><span class="ResWord">while</span> <span class="SPChar">(</span><span class="ID">values</span><span class="SPChar">.</span><span class="ID">hasNext</span><span class="SPChar">(</span><span class="SPChar">)</span><span class="SPChar">)</span> <span class="SPChar">{</span></span><br><span class="line">  <span class="ID">sum</span> <span class="SPChar">+</span><span class="SPChar">=</span> <span class="ID">values</span><span class="SPChar">.</span><span class="ID">next</span><span class="SPChar">(</span><span class="SPChar">)</span><span class="SPChar">.</span><span class="ID">get</span><span class="SPChar">(</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line"><span class="SPChar">}</span></span><br><span class="line"><span class="ID">output</span><span class="SPChar">.</span><span class="ID">collect</span><span class="SPChar">(</span><span class="ID">key</span><span class="SPChar">,</span> <span class="ResWord">new</span> <span class="ID">IntWritable</span><span class="SPChar">(</span><span class="ID">sum</span><span class="SPChar">)</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line"><span class="SPChar">}</span></span><br><span class="line"><span class="SPChar">}</span></span><br><span class="line">        </span><br><span class="line"><span class="ResWord">public</span> <span class="ResWord">static</span> <span class="ResWord">void</span> <span class="ID">main</span><span class="SPChar">(</span><span class="ID">String</span><span class="SPChar">[</span><span class="SPChar">]</span> <span class="ID">args</span><span class="SPChar">)</span><br>               <span class="ResWord">throws</span> <span class="ID">Exception</span> <span class="SPChar">{</span></span><br><span class="line"><span class="ID">JobConf</span> <span class="ID">conf</span> <span class="SPChar">=</span> <span class="ResWord">new</span> <span class="ID">JobConf</span><span class="SPChar">(</span><span class="ID">WordCount</span><span class="SPChar">.</span><span class="ResWord">class</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line"><span class="ID">conf</span><span class="SPChar">.</span><span class="ID">setJobName</span><span class="SPChar">(</span><span class="String">"wordcount"</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line">        </span><br><span class="line"><span class="ID">conf</span><span class="SPChar">.</span><span class="ID">setOutputKeyClass</span><span class="SPChar">(</span><span class="ID">Text</span><span class="SPChar">.</span><span class="ResWord">class</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line"><span class="ID">conf</span><span class="SPChar">.</span><span class="ID">setOutputValueClass</span><span class="SPChar">(</span><span class="ID">IntWritable</span><span class="SPChar">.</span><span class="ResWord">class</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line">        </span><br><span class="line"><span class="ID">conf</span><span class="SPChar">.</span><span class="ID">setMapperClass</span><span class="SPChar">(</span><span class="ID">Map</span><span class="SPChar">.</span><span class="ResWord">class</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line"><span class="ID">conf</span><span class="SPChar">.</span><span class="ID">setCombinerClass</span><span class="SPChar">(</span><span class="ID">Reduce</span><span class="SPChar">.</span><span class="ResWord">class</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line"><span class="ID">conf</span><span class="SPChar">.</span><span class="ID">setReducerClass</span><span class="SPChar">(</span><span class="ID">Reduce</span><span class="SPChar">.</span><span class="ResWord">class</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line">        </span><br><span class="line"><span class="ID">conf</span><span class="SPChar">.</span><span class="ID">setInputFormat</span><span class="SPChar">(</span><span class="ID">TextInputFormat</span><span class="SPChar">.</span><span class="ResWord">class</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line"><span class="ID">conf</span><span class="SPChar">.</span><span class="ID">setOutputFormat</span><span class="SPChar">(</span><span class="ID">TextOutputFormat</span><span class="SPChar">.</span><span class="ResWord">class</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line">        </span><br><span class="line"><span class="ID">FileInputFormat</span><span class="SPChar">.</span><span class="ID">setInputPaths</span><span class="SPChar">(</span><span class="ID">conf</span><span class="SPChar">,</span> <span class="ResWord">new</span> <span class="ID">Path</span><span class="SPChar">(</span><span class="ID">args</span><span class="SPChar">[</span><span class="Number">0</span><span class="SPChar">]</span><span class="SPChar">)</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line"><span class="ID">FileOutputFormat</span><span class="SPChar">.</span><span class="ID">setOutputPath</span><span class="SPChar">(</span><span class="ID">conf</span><span class="SPChar">,</span> <span class="ResWord">new</span> <span class="ID">Path</span><span class="SPChar">(</span><span class="ID">args</span><span class="SPChar">[</span><span class="Number">1</span><span class="SPChar">]</span><span class="SPChar">)</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line">        </span><br><span class="line"><span class="ID">JobClient</span><span class="SPChar">.</span><span class="ID">runJob</span><span class="SPChar">(</span><span class="ID">conf</span><span class="SPChar">)</span><span class="SPChar">;</span></span><br><span class="line"><span class="SPChar">}</span></span><span class="line">        </span><br><span class="line"><span class="SPChar">}</span></span><br></pre>
              <span style="font-weight: bold;">OUTPUT</span><br>
              (tokenizer.hasMoreTokens()) 1<br>
              (values.hasNext()) 1<br>
              += 1<br>
              0; 1<br>
              = 6<br>
              Exception 1<br>
              FileInputFormat.setInputPaths(conf, 1<br>
              FileOutputFormat.setOutputPath(conf, 1<br>
              IOException 2<br>
              IntWritable 1<br>
              IntWritable(1); 1<br>
              IntWritable(sum)); 1<br>
              IntWritable, 1<br>
              IntWritable&gt; 4<br>
              Iterator&lt;IntWritable&gt; 1<br>
              JobClient.runJob(conf); 1<br>
              JobConf 1<br>
              JobConf(test.class); 1<br>
              . . . . . . . . . . . . .<br>
            </div>
            <span id="line-87" class="anchor"></span><span id="bottom" class="anchor"></span></div><hr style="width: 100%; height: 2px;"><hr style="width: 100%; height: 2px;">
          <div style="text-align: center;"><span style="font-weight:
              bold;">A Float Writable Class</span><br>
          </div>
          import java.io.*;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
          import org.apache.hadoop.io.*;<br>
          public class TempWritable<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; implements WritableComparable {<br>
          private float value;<br>
          public TempWritable() {}<br>
          public TempWritable(float value) { set(value); }<br>
          public void set(float value) { this.value = value; }<br>
          public float get() { return value; }<br>
          public void readFields(DataInput in) throws IOException {<br>
          &nbsp;&nbsp; value = in.readFloat();<br>
          }<br>
          public void write(DataOutput out) throws IOException {<br>
          &nbsp;&nbsp; out.writeFloat(value);<br>
          }<br>
          public boolean equals(Object o) {<br>
          if (!(o instanceof TempWritable)) return false;<br>
          TempWritable other = (TempWritable)o;<br>
          return this.value == other.value;<br>
          }<br>
          public int hashCode() { return Float.floatToIntBits(value); }<br>
          public int compareTo(Object o) {<br>
          &nbsp;&nbsp; float thisValue = this.value;<br>
          &nbsp;&nbsp; float thatValue = ((TempWritable)o).value;<br>
          &nbsp;&nbsp; return (thisValue&lt;thatValue ? -1 :
          (thisValue==thatValue ? 0 : 1));<br>
          }<br>
          public String toString() { return Float.toString(value); }<br>
          <br>
          public static class Comparator extends WritableComparator {<br>
          <br>
          public Comparator() { super(TempWritable.class); }<br>
          public int compare(byte[] b1, int s1, int l1, byte[] b2, int
          s2, int l2) {<br>
          &nbsp;&nbsp; float thisValue = readFloat(b1, s1);<br>
          &nbsp;&nbsp; float thatValue = readFloat(b2, s2);<br>
          &nbsp;&nbsp; return (thisValue&lt;thatValue ? -1 :
          (thisValue==thatValue ? 0 : 1));<br>
          }<br>
          } //Comparator<br>
          static {&nbsp;&nbsp; // register this comparator<br>
          &nbsp;&nbsp; WritableComparator.define(TempWritable.class, new
          Comparator());<br>
          }<br>
          }<br>
          <hr style="width: 100%; height: 2px;"><h3>BOINC Example</h3><hr style="width: 100%; height: 2px;">
          <div style="text-align: center;"><span style="font-weight:
              bold;">BOINC Uppercase Example Client Application</span><br>
          </div>
          -----------------------------uc2.h<br>
          #include "boinc_api.h"<br>
          // app specific structure to drive graphics part<br>
          struct UC_SHMEM {<br>
          &nbsp;&nbsp;&nbsp; double update_time;<br>
          &nbsp;&nbsp;&nbsp; double fraction_done;<br>
          &nbsp;&nbsp;&nbsp; double cpu_time;<br>
          &nbsp;&nbsp;&nbsp; BOINC_STATUS status;<br>
          &nbsp;&nbsp;&nbsp; int countdown;<br>
          /* graphics app sets this to 5 repeatedly, main program
          decrements it once/sec. If it's zero, don't bother updating
          shmem. */<br>
          };<br>
          ---------------------------uc2.cpp<br>
          /* This C++ file is adapted from BOINC at
          http://boinc.berkeley.edu Copyright (C) 2008 University of
          California. BOINC is free software; you can redistribute it
          and/or modify it under the terms of the GNU Lesser General
          Public License as published by the Free Software Foundation,
          either version 3 of the License or any later version. See
          &lt;http://www.gnu.org/licenses/&gt;. The program converts a
          mixed-case file to upper case: read "in", convert to upper
          case, write to "out" */<br>
          #include "config.h"<br>
          #include &lt;cstdio&gt;<br>
          #include &lt;cctype&gt;<br>
          #include &lt;ctime&gt;<br>
          #include &lt;cstring&gt;<br>
          #include &lt;cstdlib&gt;<br>
          #include &lt;csignal&gt;<br>
          #include &lt;unistd.h&gt;<br>
          <br>
          #include "str_util.h"<br>
          #include "util.h"<br>
          #include "filesys.h"<br>
          #include "boinc_api.h"<br>
          #include "mfile.h"<br>
          #include "graphics2.h"<br>
          <br>
          #include "uc2.h"<br>
          UC_SHMEM* shmem;<br>
          <br>
          using std::string;<br>
          #define CHECKPOINT_FILE "upper_case_state"<br>
          #define INPUT_FILENAME "in"<br>
          #define OUTPUT_FILENAME "out"<br>
          <br>
          double cpu_time = 20, comp_result;<br>
          <br>
          static double do_a_giga_flop(int foo) {<br>
          double x = 3.14159*foo;<br>
          for (int i=0; i&lt;500000000; i++) {<br>
          &nbsp;&nbsp;&nbsp; x += 5.12313123;<br>
          &nbsp;&nbsp;&nbsp; x *= 0.5398394834;<br>
          }<br>
          return x;<br>
          }<br>
          <br>
          int do_checkpoint(MFILE&amp; mf, int nchars) {<br>
          int retval;<br>
          string resolved_name;<br>
          FILE* f = fopen("temp", "w");<br>
          if (!f) return 1;<br>
          fprintf(f, "%d", nchars);<br>
          fclose(f);<br>
          retval = mf.flush();<br>
          if (retval) return retval;<br>
          boinc_resolve_filename_s(CHECKPOINT_FILE, resolved_name);<br>
          retval = boinc_rename("temp", resolved_name.c_str());<br>
          if (retval) return retval;<br>
          return 0;<br>
          }<br>
          <br>
          void update_shmem() {<br>
          if (!shmem) return;<br>
          // always do this; otherwise a graphics app will immediately
          assume we're not alive<br>
          shmem-&gt;update_time = dtime();<br>
          <br>
          // Check whether a graphics app is running, and don't bother
          updating shmem if so.<br>
          if (shmem-&gt;countdown &lt;= 0) return;<br>
          // graphics app sets to 5 every time it renders a frame<br>
          shmem-&gt;countdown--;<br>
          shmem-&gt;fraction_done = boinc_get_fraction_done();<br>
          shmem-&gt;cpu_time = boinc_worker_thread_cpu_time();<br>
          boinc_get_status(&amp;shmem-&gt;status);<br>
          }<br>
          <br>
          int main(int argc, char **argv) {<br>
          int i;<br>
          int c, nchars = 0, retval, n;<br>
          double fsize, fd;<br>
          char input_path[512], output_path[512], chkpt_path[512],
          buf[256];<br>
          MFILE out;<br>
          FILE* state, *infile;<br>
          retval = boinc_init();<br>
          if (retval) {<br>
          &nbsp;&nbsp;&nbsp; fprintf(stderr, "%s boinc_init returned
          %d\n",<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          boinc_msg_prefix(buf, sizeof(buf)), retval);<br>
          &nbsp;&nbsp;&nbsp; exit(retval);<br>
          }<br>
          // open the input file (resolve logical name first)<br>
          boinc_resolve_filename(INPUT_FILENAME, input_path,
          sizeof(input_path));<br>
          infile = boinc_fopen(input_path, "r");<br>
          if (!infile) {<br>
          &nbsp;&nbsp;&nbsp; fprintf(stderr,<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "%s Couldn't find
          input file, resolved name %s.\n",<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          boinc_msg_prefix(buf, sizeof(buf)), input_path);<br>
          &nbsp;&nbsp;&nbsp; exit(-1);<br>
          }<br>
          // get size of input file (used to compute fraction done)<br>
          file_size(input_path, fsize);<br>
          boinc_resolve_filename(OUTPUT_FILENAME, output_path,
          sizeof(output_path));<br>
          /* See if there's a valid checkpoint file. If so, seek input
          file and truncate output file. */<br>
          boinc_resolve_filename(CHECKPOINT_FILE, chkpt_path,
          sizeof(chkpt_path));<br>
          state = boinc_fopen(chkpt_path, "r");<br>
          if (state) {<br>
          &nbsp;&nbsp;&nbsp; n = fscanf(state, "%d", &amp;nchars);<br>
          &nbsp;&nbsp;&nbsp; fclose(state);<br>
          }<br>
          if (state &amp;&amp; n==1) {<br>
          &nbsp;&nbsp;&nbsp; fseek(infile, nchars, SEEK_SET);<br>
          &nbsp;&nbsp;&nbsp; boinc_truncate(output_path, nchars);<br>
          &nbsp;&nbsp;&nbsp; retval = out.open(output_path, "ab");<br>
          } else {<br>
          &nbsp;&nbsp;&nbsp; retval = out.open(output_path, "wb");<br>
          }<br>
          if (retval) {<br>
          &nbsp;&nbsp;&nbsp; fprintf(stderr, "%s APP: upper_case output
          open failed:\n",<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          boinc_msg_prefix(buf, sizeof(buf)));<br>
          &nbsp;&nbsp;&nbsp; fprintf(stderr, "%s resolved name %s,
          retval %d\n",<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          boinc_msg_prefix(buf, sizeof(buf)), output_path, retval);<br>
          &nbsp;&nbsp;&nbsp; perror("open");<br>
          &nbsp;&nbsp;&nbsp; exit(1);<br>
          }<br>
          // create shared mem segment for graphics, and arrange to
          update it<br>
          shmem = (UC_SHMEM*) boinc_graphics_make_shmem("uppercase",
          sizeof(UC_SHMEM));<br>
          if (!shmem) {<br>
          &nbsp;&nbsp;&nbsp; fprintf(stderr, "%s failed to create shared
          mem segment\n",<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          boinc_msg_prefix(buf, sizeof(buf)));<br>
          }<br>
          update_shmem();<br>
          boinc_register_timer_callback(update_shmem);<br>
          // main loop - read characters, convert to UC, write<br>
          for (int i=0; ; i++) {<br>
          &nbsp;&nbsp;&nbsp; c = fgetc(infile);<br>
          &nbsp;&nbsp;&nbsp; if (c == EOF) break;<br>
          &nbsp;&nbsp;&nbsp; c = toupper(c);<br>
          &nbsp;&nbsp;&nbsp; out._putchar(c);<br>
          &nbsp;&nbsp;&nbsp; nchars++;<br>
          &nbsp;&nbsp;&nbsp; if (boinc_time_to_checkpoint()) {<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retval =
          do_checkpoint(out, nchars);<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (retval) {<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
fprintf(stderr,

          "%s APP: upper_case checkpoint failed %d\n",<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          boinc_msg_prefix(buf, sizeof(buf)), retval);<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          exit(retval);<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          boinc_checkpoint_completed();<br>
          &nbsp;&nbsp;&nbsp; }<br>
          &nbsp;&nbsp;&nbsp; fd = nchars/fsize;<br>
          &nbsp;&nbsp;&nbsp; if (cpu_time) fd /= 2;<br>
          &nbsp;&nbsp;&nbsp; boinc_fraction_done(fd);<br>
          }<br>
          retval = out.flush();<br>
          if (retval) {<br>
          &nbsp;&nbsp;&nbsp; fprintf(stderr, "%s APP: upper_case flush
          failed %d\n",<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          boinc_msg_prefix(buf, sizeof(buf)), retval);<br>
          &nbsp;&nbsp;&nbsp; exit(1);<br>
          }<br>
          // burn up some CPU time if needed<br>
          if (cpu_time) {<br>
          &nbsp;&nbsp;&nbsp; double start = dtime();<br>
          &nbsp;&nbsp;&nbsp; for (int i=0; ; i++) {<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; double e =
          dtime()-start;<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (e &gt;
          cpu_time) break;<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fd = .5 +
          .5*(e/cpu_time);<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          boinc_fraction_done(fd);<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if
          (boinc_time_to_checkpoint()) {<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retval

          = do_checkpoint(out, nchars);<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          if (retval) {<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          fprintf(stderr, "%s APP: upper_case checkpoint failed %d\n",<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          boinc_msg_prefix(buf, sizeof(buf)), retval);<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          exit(1);<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          }<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          boinc_checkpoint_completed();<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; comp_result =
          do_a_giga_flop(i);<br>
          &nbsp;&nbsp;&nbsp; }<br>
          }<br>
          boinc_fraction_done(1);<br>
          update_shmem();<br>
          boinc_finish(0);<br>
          ---------------------------uc2_graphics.cpp (partial listing)<br>
          /* Example graphics application, paired with uc2.cpp. This
          demonstrates using shared memory to communicate with the
          worker app, reading XML preferences by which users can
          customize graphics (in this case, select colors), and draw
          text and 3D objects using OpenGL. */<br>
          #include &lt;math.h&gt;<br>
          #include "parse.h"<br>
          #include "util.h"<br>
          #include "gutil.h"<br>
          #include "boinc_gl.h"<br>
          #include "app_ipc.h"<br>
          #include "boinc_api.h"<br>
          #include "graphics2.h"<br>
          #include "txf_util.h"<br>
          #include "uc2.h"<br>
          #include "diagnostics.h"<br>
          <br>
          float white[4] = {1., 1., 1., 1.};<br>
          TEXTURE_DESC logo;<br>
          int width, height;&nbsp;&nbsp; // window dimensions<br>
          APP_INIT_DATA uc_aid;<br>
          float color[4] = {.7, .2, .5, 1};<br>
          /* The color of the 3D object can be changed using preferences
          */<br>
          UC_SHMEM* shmem = NULL;<br>
          <br>
          static void draw_text() {<br>
          static float x=0, y=0;<br>
          static float dx=0.0003, dy=0.0007;<br>
          char buf[256];<br>
          x += dx;<br>
          y += dy;<br>
          if (x &lt; 0 || x &gt; .5) dx *= -1;<br>
          if (y &lt; 0 || y &gt; .5) dy *= -1;<br>
          double fd = 0, cpu=0, dt;<br>
          if (shmem) {<br>
          &nbsp;&nbsp;&nbsp; fd = shmem-&gt;fraction_done;<br>
          &nbsp;&nbsp;&nbsp; cpu = shmem-&gt;cpu_time;<br>
          }<br>
          sprintf(buf, "User: %s", uc_aid.user_name);<br>
          txf_render_string(.1, x, y, 0, 500, white, 0, buf);<br>
          sprintf(buf, "Team: %s", uc_aid.team_name);<br>
          txf_render_string(.1, x, y+.1, 0, 500, white, 0, buf);<br>
          sprintf(buf, "%% Done: %f", 100*fd);<br>
          txf_render_string(.1, x, y+.2, 0, 500, white, 0, buf);<br>
          sprintf(buf, "CPU time: %f", cpu); <br>
          txf_render_string(.1, x, y+.3, 0, 500, white, 0, buf);<br>
          if (shmem) {<br>
          &nbsp;&nbsp;&nbsp; dt = dtime() - shmem-&gt;update_time;<br>
          &nbsp;&nbsp;&nbsp; if (dt &gt; 10) {<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          boinc_close_window_and_quit("shmem not updated");<br>
          &nbsp;&nbsp;&nbsp; } else if (dt &gt; 5) {<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          txf_render_string(.1, 0, 0, 0, 500, white, 0, "App not running
          - exiting in 5 seconds");<br>
          &nbsp;&nbsp;&nbsp; } else if (shmem-&gt;status.suspended) {<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          txf_render_string(.1, 0, 0, 0, 500, white, 0, "App
          suspended");<br>
          &nbsp;&nbsp;&nbsp; }<br>
          } else {<br>
          &nbsp;&nbsp;&nbsp; txf_render_string(.1, 0, 0, 0, 500, white,
          0, "No shared mem");<br>
          }<br>
          }<br>
          <br>
          void app_graphics_render(int xs, int ys, double time_of_day) {<br>
          /* boinc_graphics_get_shmem() must be called after
          boinc_parse_init_data_file(). Put this in the main loop to
          allow retries if the worker application has not yet created
          shared memory. */<br>
          if (shmem == NULL) {<br>
          &nbsp;&nbsp;&nbsp; shmem = (UC_SHMEM*)
          boinc_graphics_get_shmem("uppercase");<br>
          }<br>
          if (shmem) shmem-&gt;countdown = 5;<br>
          glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);<br>
          // CODE OMITTED<br>
          }<br>
          <br>
          void app_graphics_init() {<br>
          char path[256];<br>
          glClearColor(0.0f, 0.0f, 0.0f, 0.0f);<br>
          txf_load_fonts(".");<br>
          boinc_resolve_filename("logo.jpg", path, sizeof(path));<br>
          logo.load_image_file(path);<br>
          init_lights();<br>
          }<br>
          <br>
          static void parse_project_prefs(char* buf) {<br>
          char cs[256];<br>
          COLOR c;<br>
          double hue;<br>
          double max_frames_sec, max_gfx_cpu_pct;<br>
          if (!buf) return;<br>
          if (parse_str(buf, "&lt;color_scheme&gt;", cs, 256)) {<br>
          &nbsp;&nbsp;&nbsp; if (!strcmp(cs, "Tahiti Sunset"))&nbsp; hue
          = .9;<br>
          &nbsp;&nbsp;&nbsp; else if (!strcmp(cs, "Desert Sands")) hue =
          .1;<br>
          &nbsp;&nbsp;&nbsp; else&nbsp; hue = .5;<br>
          &nbsp;&nbsp;&nbsp; HLStoRGB(hue, .5, .5, c);<br>
          &nbsp;&nbsp;&nbsp; color[0] = c.r;<br>
          &nbsp;&nbsp;&nbsp; color[1] = c.g;<br>
          &nbsp;&nbsp;&nbsp; color[2] = c.b;<br>
          &nbsp;&nbsp;&nbsp; color[3] = 1;<br>
          }<br>
          if (parse_double(buf, "&lt;max_frames_sec&gt;",
          max_frames_sec)) {<br>
          &nbsp;&nbsp;&nbsp; boinc_max_fps = max_frames_sec;<br>
          }<br>
          if (parse_double(buf, "&lt;max_gfx_cpu_pct&gt;",
          max_gfx_cpu_pct)) {<br>
          &nbsp;&nbsp;&nbsp; boinc_max_gfx_cpu_frac =
          max_gfx_cpu_pct/100;<br>
          }<br>
          }<br>
          <br>
          int main(int argc, char** argv) {<br>
          boinc_init_graphics_diagnostics(BOINC_DIAG_DEFAULTS);<br>
          boinc_parse_init_data_file();<br>
          boinc_get_init_data(uc_aid);<br>
          if (uc_aid.project_preferences) {<br>
          &nbsp;&nbsp;&nbsp;
          parse_project_prefs(uc_aid.project_preferences);<br>
          }<br>
          boinc_graphics_loop(argc, argv);<br>
          boinc_finish_diag();<br>
          }<br>
          <hr> </div>
      </div>
    </div>
  



</body></html>